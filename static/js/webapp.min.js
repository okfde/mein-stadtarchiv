function init_front_page(){mapboxgl.accessToken=stadtarchiv_config.mapbox_token,storage.map=new mapboxgl.Map({container:"frontpage-map",style:"mapbox://styles/mapbox/bright-v9",center:[6.693504,50.869415],zoom:9}),storage.map.addControl(new mapboxgl.NavigationControl,"top-right"),storage.map.addControl(new mapboxgl.AttributionControl,"bottom-right"),storage.map.on("load",function(){storage.map.addSource("home-source",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[6.693504,50.869415]},properties:{}}]}}),storage.map.addLayer({id:"home-point",type:"circle",source:"home-source",paint:{"circle-radius":7,"circle-color":"#dc281e"}},200),storage.map.addLayer({id:"home-text",type:"symbol",source:"home-source",layout:{"text-field":"Stadtarchiv Kerpen","text-offset":[0,1.2],"text-size":16},paint:{"text-color":"#dc281e"}},200)})}function init_search_page(){storage.random_seed="";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<16;e++)storage.random_seed+=t.charAt(Math.floor(Math.random()*t.length));for($("#search-form").submit(function(t){t.preventDefault(),storage.current_page=1,$("#fulltext").val()&&$("#order-by").val("_score"),search()}),e=0;e<stadtarchiv_config.categories.length;e++)$("#category-children").append('<div class="category-child" data-id="'+stadtarchiv_config.categories[e].id+'">'+stadtarchiv_config.categories[e].title+" (<span>0</span>)</div>");$(".category-child, #category-parent").click(function(){$(this).hasClass("category-inactive")||(storage.current_page=1,select_category($(this).data("id")))}),$("#category-overview").on("show.bs.modal",function(){update_category_overview()}),$("#help-required, #with-files").change(function(){storage.current_page=1,search()}),$("#order-by").change(function(){search()}),$("#fulltext").live_search({url:"/api/live-search",form:"#search-form",input:"#fulltext",live_box:"#fulltext-live",submit:"#submit",modify_params:function(t,e){return e},process_result_line:function(t){return'<li data-q="'+t+'">'+t+"</li>"},after_submit:function(){},result_array:function(t){return t.data}}),get_url(),search()}function get_url(){cut=window.location.href.indexOf("?");var t={};if(-1!=cut)for(var e=window.location.href.substr(cut+1).split("&"),i=0;i<e.length;i++){var n=e[i].split("=");t[n[0]]=n[1]}t.text?$("#fulltext").val(decodeURI(t.text)):$("#fulltext").val(""),select_category(t.category?t.category:"root"),$("#with-files").prop("checked","1"==t.media),$("#help-required").prop("checked","1"==t.help),t.year&&(year=t.year.split("-"),year[0]&&$("#year-start").val(year[0]),year[1]&&$("#year-end").val(year[1])),t.page?storage.current_page=parseInt(t.page):storage.current_page=1,t.order?$("#order-by").val(t.order):$("#fulltext").val()?$("#order-by").val("_score"):$("#order-by").val("random"),storage.form_active=!0}function set_url(t,e){url=[],t.q&&url.push("text="+encodeURI(t.q)),"root"!=e&&url.push("category="+e),1!=storage.current_page&&url.push("page="+storage.current_page),t.fc&&url.push("media=1"),t.hc&&url.push("help=1"),(t.ys||t.ye)&&(year_string="",t.ys&&(year_string+=String(t.ys)),year_string+="-",t.ye&&(year_string+=String(t.ye)),url.push("year="+year_string)),(t.q&&"_score"!=t.o||!t.q&&"random"!=t.o)&&url.push("order="+t.o),url=url.join("&"),url&&(url="?"+url),history.pushState(null,"Recherche | Unser Stadtarchiv","/recherche"+url)}function update_category_overview(){category_list='<h5 data-id="root">Alle Archive</h5>',category_list+=get_category_list(stadtarchiv_config.categories),$("#category-overview .modal-body").html(category_list),$("#category-overview h5").click(function(){select_category($(this).data("id")),$("#category-overview").modal("toggle")})}function get_category_list(t){for(var e="<ul>",i=0;i<t.length;i++)e+='<li><h5 data-id="'+t[i].id+'">'+t[i].title+" (<span>0</span>)</h5>",t[i].children&&(e+=get_category_list(t[i].children)),e+="</li>";return e+="</ul>"}function select_category(t){if(category=get_category_data(stadtarchiv_config.categories,t,0),$("#category-current").text(category.title).data("id",category.id),0===category.level?($("#category-parent").addClass("category-inactive"),$("#category-parent").text("Eine Ebene hoch")):($("#category-parent").removeClass("category-inactive"),1==category.level?($("#category-parent").text("Alle Archive"),$("#category-parent").data("id","root")):category.parent&&($("#category-parent").data("id",category.parent.id),$("#category-parent").text(category.parent.title))),$("#category-children").html(""),category.children){for(i=0;i<category.children.length;i++)$("#category-children").append('<div class="category-child" data-id="'+category.children[i].id+'">'+category.children[i].title+" (<span>0</span>)"+(category.children[i].description?' <i class="fa fa-info-circle" aria-hidden="true"><div>'+category.children[i].description+"</div></i>":"")+"</div>");$(".category-child").click(function(){select_category($(this).data("id"))})}search()}function get_category_data(t,e,i){if("root"===e)return{title:"Alle Archive",id:"root",level:0,children:stadtarchiv_config.categories};for(var n=0;n<t.length;n++){if(t[n].id===e)return t[n].level=i+1,t[n];if(t[n].children&&(child=get_category_data(t[n].children,e,i+1),child))return child.parent||(child.parent={id:t[n].id,title:t[n].title,description:t[n].description,level:i+1}),child}return!1}function get_children(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].id),t[i].children&&(e=e.concat(get_children(t[i].children)));return e}function search(){if(storage.form_active){category=get_category_data(stadtarchiv_config.categories,$("#category-current").data("id"),0);var t=[];category.children&&(t=t.concat(get_children(category.children))),"root"!==category.id&&t.push(category.id),$("#fulltext").val()?$('#order-by option[value="_score"]').removeAttr("disabled"):("_score"!=$("#order-by").val()&&$("#order-by").val()||$("#order-by").val("random"),$('#order-by option[value="_score"]').attr("disabled","disabled")),params={skip:(storage.current_page-1)*storage.items_per_page,limit:storage.items_per_page,q:$("#fulltext").val(),fq:JSON.stringify({category:t}),fc:$("#with-files")[0].checked?1:0,hc:$("#help-required")[0].checked?1:0,o:$("#order-by").val(),ys:parseInt($("#year-start").val()),ye:parseInt($("#year-end").val()),rs:storage.random_seed},storage.browser_nav_action?storage.browser_nav_action=!1:set_url(params,category.id),$.post("/api/search",params,function(t){$("#search-summary .num-results").text(t.pagination.totalElements),$(".search-pagination").html(generate_pagination_html(t.pagination.totalElements,storage.current_page,storage.items_per_page)),html="",$.each(t.data,function(t,e){html+=get_search_list_item(t,e)}),$("#search-result").html(html),$(".pagination-page").click(function(){$(this).hasClass("active")&&(storage.current_page=parseInt($(this).attr("data-page")),search())}),update_category_list_count(t.terms.categories)})}}function update_category_list_count(t){$(".category-child").each(function(){var e=0;if(t[$(this).data("id")]&&(e+=t[$(this).data("id")].count),primary_category=get_category_data(stadtarchiv_config.categories,$(this).data("id"),0),primary_category.children){children=get_children(primary_category.children);for(var i=0;i<children.length;i++)t[children[i]]&&(e+=t[children[i]].count)}$(this).find("span").text(e)})}function get_search_list_item(t,e){return html='<li><div class="search-item-left">',e.title?html+='<h2><a href="/document/'+e.id+'">'+e.title.replace("<","&lt;").replace(">","&gt;")+"</a></h2>":html+='<h2><a href="/document/'+e.id+'">Unbekannte Darstellung</a></h2>',meta=[],e.date&&meta.push("Datum: "+e.date.substr(8,2)+"."+e.date.substr(5,2)+"."+e.date.substr(0,4)),e.date_begin&&e.date_end&&("-01-01"==e.date_begin.substr(4)&&"-12-31"==e.date_end.substr(4)?e.date_begin.substr(0,4)==e.date_end.substr(0,4)?meta.push("Jahr: "+e.date_begin.substr(0,4)):meta.push("Jahr: "+e.date_begin.substr(0,4)+" - "+e.date_end.substr(0,4)):meta.push("Datum: "+e.date_begin.substr(8,2)+"."+e.date_begin.substr(5,2)+"."+e.date_begin.substr(0,4)+" - "+e.date_end.substr(8,2)+"."+e.date_end.substr(5,2)+"."+e.date_end.substr(0,4))),e.category_full&&meta.push("Kategorie: "+e.category_full),e.origination&&meta.push("Herkunft: "+e.origination.replace("<","&lt;").replace(">","&gt;")),meta.length&&(html+='<p class="search-item-meta">'+meta.join(" | ").replace("<","&lt;").replace(">","&gt;")+"</p>"),e.description&&(html+="<p>"+e.description.replace("<","&lt;").replace(">","&gt;")+"</p>"),html+="</div>",e.files&&e.files.length&&(html+='<div class="search-item-image"><a href="/document/'+e.id+'"><img src="'+stadtarchiv_config.media_url+"/thumbnails/"+e.id+"/"+e.files[0].id+'/150/1.jpg"></a></div>'),html+="</li>",html}function generate_pagination_html(t,e,i){var n=Math.ceil(t/i);return list_html='<div class="pagination-page position-left '+(e>1?"active":"inactive")+'" data-page="1"><i class="fa fa-angle-double-left" aria-hidden="true"></i></div>',list_html+='<div class="pagination-page position-left '+(e-1>=1?"active":"inactive")+'" data-page="'+(e-1)+'"><i class="fa fa-angle-left" aria-hidden="true"></i></div>',list_html+='<div class="pagination-page position-right '+(e<n?"active":"inactive")+'" data-page="'+n+'"><i class="fa fa-angle-double-right" aria-hidden="true"></i></div>',list_html+='<div class="pagination-page position-right '+(e<n?"active":"inactive")+'" data-page="'+(e+1)+'"><i class="fa fa-angle-right" aria-hidden="true"></i></div>',list_html+='<div class="pagination-center-box">Seite '+e+" von "+n+"</div>",list_html}!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function i(t,e){var i=(e=e||et).createElement("script");i.text=t,e.head.appendChild(i).parentNode.removeChild(i)}function n(t){var e=!!t&&"length"in t&&t.length,i=ft.type(t);return"function"!==i&&!ft.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function o(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function r(t,e,i){return ft.isFunction(e)?ft.grep(t,function(t,n){return!!e.call(t,n,t)!==i}):e.nodeType?ft.grep(t,function(t){return t===e!==i}):"string"!=typeof e?ft.grep(t,function(t){return at.call(e,t)>-1!==i}):Tt.test(e)?ft.filter(e,t,i):(e=ft.filter(e,t),ft.grep(t,function(t){return at.call(e,t)>-1!==i&&1===t.nodeType}))}function a(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function s(t){var e={};return ft.each(t.match(kt)||[],function(t,i){e[i]=!0}),e}function l(t){return t}function u(t){throw t}function c(t,e,i,n){var o;try{t&&ft.isFunction(o=t.promise)?o.call(t).done(e).fail(i):t&&ft.isFunction(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}function h(){et.removeEventListener("DOMContentLoaded",h),t.removeEventListener("load",h),ft.ready()}function p(){this.expando=ft.expando+p.uid++}function f(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ot.test(t)?JSON.parse(t):t)}function d(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Rt,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=f(i)}catch(t){}Mt.set(t,e,i)}else i=void 0;return i}function m(t,e,i,n){var o,r=1,a=20,s=n?function(){return n.cur()}:function(){return ft.css(t,e,"")},l=s(),u=i&&i[3]||(ft.cssNumber[e]?"":"px"),c=(ft.cssNumber[e]||"px"!==u&&+l)&&jt.exec(ft.css(t,e));if(c&&c[3]!==u){u=u||c[3],i=i||[],c=+l||1;do{c/=r=r||".5",ft.style(t,e,c+u)}while(r!==(r=s()/l)&&1!==r&&--a)}return i&&(c=+c||+l||0,o=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=u,n.start=c,n.end=o)),o}function g(t){var e,i=t.ownerDocument,n=t.nodeName,o=Ut[n];return o||(e=i.body.appendChild(i.createElement(n)),o=ft.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),Ut[n]=o,o)}function y(t,e){for(var i,n,o=[],r=0,a=t.length;r<a;r++)(n=t[r]).style&&(i=n.style.display,e?("none"===i&&(o[r]=zt.get(n,"display")||null,o[r]||(n.style.display="")),""===n.style.display&&Bt(n)&&(o[r]=g(n))):"none"!==i&&(o[r]="none",zt.set(n,"display",i)));for(r=0;r<a;r++)null!=o[r]&&(t[r].style.display=o[r]);return t}function v(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&o(t,e)?ft.merge([t],i):i}function _(t,e){for(var i=0,n=t.length;i<n;i++)zt.set(t[i],"globalEval",!e||zt.get(e[i],"globalEval"))}function x(t,e,i,n,o){for(var r,a,s,l,u,c,h=e.createDocumentFragment(),p=[],f=0,d=t.length;f<d;f++)if((r=t[f])||0===r)if("object"===ft.type(r))ft.merge(p,r.nodeType?[r]:r);else if(Gt.test(r)){for(a=a||h.appendChild(e.createElement("div")),s=(qt.exec(r)||["",""])[1].toLowerCase(),l=$t[s]||$t._default,a.innerHTML=l[1]+ft.htmlPrefilter(r)+l[2],c=l[0];c--;)a=a.lastChild;ft.merge(p,a.childNodes),(a=h.firstChild).textContent=""}else p.push(e.createTextNode(r));for(h.textContent="",f=0;r=p[f++];)if(n&&ft.inArray(r,n)>-1)o&&o.push(r);else if(u=ft.contains(r.ownerDocument,r),a=v(h.appendChild(r),"script"),u&&_(a),i)for(c=0;r=a[c++];)Wt.test(r.type||"")&&i.push(r);return h}function b(){return!0}function w(){return!1}function T(){try{return et.activeElement}catch(t){}}function E(t,e,i,n,o,r){var a,s;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(s in e)E(t,s,i,n,e[s],r);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=w;else if(!o)return t;return 1===r&&(a=o,(o=function(t){return ft().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=ft.guid++)),t.each(function(){ft.event.add(this,e,o,n,i)})}function C(t,e){return o(t,"table")&&o(11!==e.nodeType?e:e.firstChild,"tr")?ft(">tbody",t)[0]||t:t}function S(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function A(t){var e=ee.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function k(t,e){var i,n,o,r,a,s,l,u;if(1===e.nodeType){if(zt.hasData(t)&&(r=zt.access(t),a=zt.set(e,r),u=r.events)){delete a.handle,a.events={};for(o in u)for(i=0,n=u[o].length;i<n;i++)ft.event.add(e,o,u[o][i])}Mt.hasData(t)&&(s=Mt.access(t),l=ft.extend({},s),Mt.set(e,l))}}function I(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Ht.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function L(t,e,n,o){e=ot.apply([],e);var r,a,s,l,u,c,h=0,p=t.length,f=p-1,d=e[0],m=ft.isFunction(d);if(m||p>1&&"string"==typeof d&&!pt.checkClone&&te.test(d))return t.each(function(i){var r=t.eq(i);m&&(e[0]=d.call(this,i,r.html())),L(r,e,n,o)});if(p&&(r=x(e,t[0].ownerDocument,!1,t,o),a=r.firstChild,1===r.childNodes.length&&(r=a),a||o)){for(l=(s=ft.map(v(r,"script"),S)).length;h<p;h++)u=r,h!==f&&(u=ft.clone(u,!0,!0),l&&ft.merge(s,v(u,"script"))),n.call(t[h],u,h);if(l)for(c=s[s.length-1].ownerDocument,ft.map(s,A),h=0;h<l;h++)u=s[h],Wt.test(u.type||"")&&!zt.access(u,"globalEval")&&ft.contains(c,u)&&(u.src?ft._evalUrl&&ft._evalUrl(u.src):i(u.textContent.replace(ie,""),c))}return t}function D(t,e,i){for(var n,o=e?ft.filter(e,t):t,r=0;null!=(n=o[r]);r++)i||1!==n.nodeType||ft.cleanData(v(n)),n.parentNode&&(i&&ft.contains(n.ownerDocument,n)&&_(v(n,"script")),n.parentNode.removeChild(n));return t}function P(t,e,i){var n,o,r,a,s=t.style;return(i=i||re(t))&&(""!==(a=i.getPropertyValue(e)||i[e])||ft.contains(t.ownerDocument,t)||(a=ft.style(t,e)),!pt.pixelMarginRight()&&oe.test(a)&&ne.test(e)&&(n=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function z(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}function M(t){if(t in he)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=ce.length;i--;)if((t=ce[i]+e)in he)return t}function O(t){var e=ft.cssProps[t];return e||(e=ft.cssProps[t]=M(t)||t),e}function R(t,e,i){var n=jt.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function N(t,e,i,n,o){var r,a=0;for(r=i===(n?"border":"content")?4:"width"===e?1:0;r<4;r+=2)"margin"===i&&(a+=ft.css(t,i+Ft[r],!0,o)),n?("content"===i&&(a-=ft.css(t,"padding"+Ft[r],!0,o)),"margin"!==i&&(a-=ft.css(t,"border"+Ft[r]+"Width",!0,o))):(a+=ft.css(t,"padding"+Ft[r],!0,o),"padding"!==i&&(a+=ft.css(t,"border"+Ft[r]+"Width",!0,o)));return a}function j(t,e,i){var n,o=re(t),r=P(t,e,o),a="border-box"===ft.css(t,"boxSizing",!1,o);return oe.test(r)?r:(n=a&&(pt.boxSizingReliable()||r===t.style[e]),"auto"===r&&(r=t["offset"+e[0].toUpperCase()+e.slice(1)]),(r=parseFloat(r)||0)+N(t,e,i||(a?"border":"content"),n,o)+"px")}function F(t,e,i,n,o){return new F.prototype.init(t,e,i,n,o)}function B(){fe&&(!1===et.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(B):t.setTimeout(B,ft.fx.interval),ft.fx.tick())}function V(){return t.setTimeout(function(){pe=void 0}),pe=ft.now()}function U(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)o["margin"+(i=Ft[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function H(t,e,i){for(var n,o=(W.tweeners[e]||[]).concat(W.tweeners["*"]),r=0,a=o.length;r<a;r++)if(n=o[r].call(i,e,t))return n}function q(t,e){var i,n,o,r,a;for(i in t)if(n=ft.camelCase(i),o=e[n],r=t[i],Array.isArray(r)&&(o=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),(a=ft.cssHooks[n])&&"expand"in a){r=a.expand(r),delete t[n];for(i in r)i in t||(t[i]=r[i],e[i]=o)}else e[n]=o}function W(t,e,i){var n,o,r=0,a=W.prefilters.length,s=ft.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=pe||V(),i=Math.max(0,u.startTime+u.duration-e),n=1-(i/u.duration||0),r=0,a=u.tweens.length;r<a;r++)u.tweens[r].run(n);return s.notifyWith(t,[u,n,i]),n<1&&a?i:(a||s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u]),!1)},u=s.promise({elem:t,props:ft.extend({},e),opts:ft.extend(!0,{specialEasing:{},easing:ft.easing._default},i),originalProperties:e,originalOptions:i,startTime:pe||V(),duration:i.duration,tweens:[],createTween:function(e,i){var n=ft.Tween(t,u.opts,e,i,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(n),n},stop:function(e){var i=0,n=e?u.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)u.tweens[i].run(1);return e?(s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u,e])):s.rejectWith(t,[u,e]),this}}),c=u.props;for(q(c,u.opts.specialEasing);r<a;r++)if(n=W.prefilters[r].call(u,t,c,u.opts))return ft.isFunction(n.stop)&&(ft._queueHooks(u.elem,u.opts.queue).stop=ft.proxy(n.stop,n)),n;return ft.map(c,H,u),ft.isFunction(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),ft.fx.timer(ft.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}function $(t){return(t.match(kt)||[]).join(" ")}function G(t){return t.getAttribute&&t.getAttribute("class")||""}function Z(t,e,i,n){var o;if(Array.isArray(e))ft.each(e,function(e,o){i||Ce.test(t)?n(t,o):Z(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,i,n)});else if(i||"object"!==ft.type(e))n(t,e);else for(o in e)Z(t+"["+o+"]",e[o],i,n)}function X(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,r=e.toLowerCase().match(kt)||[];if(ft.isFunction(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function K(t,e,i,n){function o(s){var l;return r[s]=!0,ft.each(t[s]||[],function(t,s){var u=s(e,i,n);return"string"!=typeof u||a||r[u]?a?!(l=u):void 0:(e.dataTypes.unshift(u),o(u),!1)}),l}var r={},a=t===Ne;return o(e.dataTypes[0])||!r["*"]&&o("*")}function Q(t,e){var i,n,o=ft.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&ft.extend(!0,t,n),t}function Y(t,e,i){for(var n,o,r,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in s)if(s[o]&&s[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}if(r)return r!==l[0]&&l.unshift(r),i[r]}function J(t,e,i,n){var o,r,a,s,l,u={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(r=c.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=c.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(a=u[l+" "+r]||u["* "+r]))for(o in u)if((s=o.split(" "))[1]===r&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[o]:!0!==u[o]&&(r=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}var tt=[],et=t.document,it=Object.getPrototypeOf,nt=tt.slice,ot=tt.concat,rt=tt.push,at=tt.indexOf,st={},lt=st.toString,ut=st.hasOwnProperty,ct=ut.toString,ht=ct.call(Object),pt={},ft=function(t,e){return new ft.fn.init(t,e)},dt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,mt=/^-ms-/,gt=/-([a-z])/g,yt=function(t,e){return e.toUpperCase()};ft.fn=ft.prototype={jquery:"3.2.1",constructor:ft,length:0,toArray:function(){return nt.call(this)},get:function(t){return null==t?nt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=ft.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return ft.each(this,t)},map:function(t){return this.pushStack(ft.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(nt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:rt,sort:tt.sort,splice:tt.splice},ft.extend=ft.fn.extend=function(){var t,e,i,n,o,r,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||ft.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(t=arguments[s]))for(e in t)i=a[e],a!==(n=t[e])&&(u&&n&&(ft.isPlainObject(n)||(o=Array.isArray(n)))?(o?(o=!1,r=i&&Array.isArray(i)?i:[]):r=i&&ft.isPlainObject(i)?i:{},a[e]=ft.extend(u,r,n)):void 0!==n&&(a[e]=n));return a},ft.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===ft.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=ft.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==lt.call(t))&&(!(e=it(t))||"function"==typeof(i=ut.call(e,"constructor")&&e.constructor)&&ct.call(i)===ht)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?st[lt.call(t)]||"object":typeof t},globalEval:function(t){i(t)},camelCase:function(t){return t.replace(mt,"ms-").replace(gt,yt)},each:function(t,e){var i,o=0;if(n(t))for(i=t.length;o<i&&!1!==e.call(t[o],o,t[o]);o++);else for(o in t)if(!1===e.call(t[o],o,t[o]))break;return t},trim:function(t){return null==t?"":(t+"").replace(dt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?ft.merge(i,"string"==typeof t?[t]:t):rt.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:at.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,r=t.length,a=!i;o<r;o++)!e(t[o],o)!==a&&n.push(t[o]);return n},map:function(t,e,i){var o,r,a=0,s=[];if(n(t))for(o=t.length;a<o;a++)null!=(r=e(t[a],a,i))&&s.push(r);else for(a in t)null!=(r=e(t[a],a,i))&&s.push(r);return ot.apply([],s)},guid:1,proxy:function(t,e){var i,n,o;if("string"==typeof e&&(i=t[e],e=t,t=i),ft.isFunction(t))return n=nt.call(arguments,2),o=function(){return t.apply(e||this,n.concat(nt.call(arguments)))},o.guid=t.guid=t.guid||ft.guid++,o},now:Date.now,support:pt}),"function"==typeof Symbol&&(ft.fn[Symbol.iterator]=tt[Symbol.iterator]),ft.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){st["[object "+e+"]"]=e.toLowerCase()});var vt=function(t){function e(t,e,i,n){var o,r,a,s,l,c,p,f=e&&e.ownerDocument,d=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return i;if(!n&&((e?e.ownerDocument||e:F)!==D&&L(e),e=e||D,z)){if(11!==d&&(l=mt.exec(t)))if(o=l[1]){if(9===d){if(!(a=e.getElementById(o)))return i;if(a.id===o)return i.push(a),i}else if(f&&(a=f.getElementById(o))&&N(e,a)&&a.id===o)return i.push(a),i}else{if(l[2])return K.apply(i,e.getElementsByTagName(t)),i;if((o=l[3])&&x.getElementsByClassName&&e.getElementsByClassName)return K.apply(i,e.getElementsByClassName(o)),i}if(x.qsa&&!q[t+" "]&&(!M||!M.test(t))){if(1!==d)f=e,p=t;else if("object"!==e.nodeName.toLowerCase()){for((s=e.getAttribute("id"))?s=s.replace(_t,xt):e.setAttribute("id",s=j),r=(c=E(t)).length;r--;)c[r]="#"+s+" "+h(c[r]);p=c.join(","),f=gt.test(t)&&u(e.parentNode)||e}if(p)try{return K.apply(i,f.querySelectorAll(p)),i}catch(t){}finally{s===j&&e.removeAttribute("id")}}}return S(t.replace(rt,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>b.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[j]=!0,t}function o(t){var e=D.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var i=t.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function s(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&wt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var o,r=t([],i.length,e),a=r.length;a--;)i[o=r[a]]&&(i[o]=!(n[o]=i[o]))})})}function u(t){return t&&void 0!==t.getElementsByTagName&&t}function c(){}function h(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function p(t,e,i){var n=e.dir,o=e.next,r=o||n,a=i&&"parentNode"===r,s=V++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||a)return t(e,i,o);return!1}:function(e,i,l){var u,c,h,p=[B,s];if(l){for(;e=e[n];)if((1===e.nodeType||a)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||a)if(h=e[j]||(e[j]={}),c=h[e.uniqueID]||(h[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[n]||e;else{if((u=c[r])&&u[0]===B&&u[1]===s)return p[2]=u[2];if(c[r]=p,p[2]=t(e,i,l))return!0}return!1}}function f(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function d(t,i,n){for(var o=0,r=i.length;o<r;o++)e(t,i[o],n);return n}function m(t,e,i,n,o){for(var r,a=[],s=0,l=t.length,u=null!=e;s<l;s++)(r=t[s])&&(i&&!i(r,n,o)||(a.push(r),u&&e.push(s)));return a}function g(t,e,i,o,r,a){return o&&!o[j]&&(o=g(o)),r&&!r[j]&&(r=g(r,a)),n(function(n,a,s,l){var u,c,h,p=[],f=[],g=a.length,y=n||d(e||"*",s.nodeType?[s]:s,[]),v=!t||!n&&e?y:m(y,p,t,s,l),_=i?r||(n?t:g||o)?[]:a:v;if(i&&i(v,_,s,l),o)for(u=m(_,f),o(u,[],s,l),c=u.length;c--;)(h=u[c])&&(_[f[c]]=!(v[f[c]]=h));if(n){if(r||t){if(r){for(u=[],c=_.length;c--;)(h=_[c])&&u.push(v[c]=h);r(null,_=[],u,l)}for(c=_.length;c--;)(h=_[c])&&(u=r?Y(n,h):p[c])>-1&&(n[u]=!(a[u]=h))}}else _=m(_===a?_.splice(g,_.length):_),r?r(null,a,_,l):K.apply(a,_)})}function y(t){for(var e,i,n,o=t.length,r=b.relative[t[0].type],a=r||b.relative[" "],s=r?1:0,l=p(function(t){return t===e},a,!0),u=p(function(t){return Y(e,t)>-1},a,!0),c=[function(t,i,n){var o=!r&&(n||i!==A)||((e=i).nodeType?l(t,i,n):u(t,i,n));return e=null,o}];s<o;s++)if(i=b.relative[t[s].type])c=[p(f(c),i)];else{if((i=b.filter[t[s].type].apply(null,t[s].matches))[j]){for(n=++s;n<o&&!b.relative[t[n].type];n++);return g(s>1&&f(c),s>1&&h(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(rt,"$1"),i,s<n&&y(t.slice(s,n)),n<o&&y(t=t.slice(n)),n<o&&h(t))}c.push(i)}return f(c)}function v(t,i){var o=i.length>0,r=t.length>0,a=function(n,a,s,l,u){var c,h,p,f=0,d="0",g=n&&[],y=[],v=A,_=n||r&&b.find.TAG("*",u),x=B+=null==v?1:Math.random()||.1,w=_.length;for(u&&(A=a===D||a||u);d!==w&&null!=(c=_[d]);d++){if(r&&c){for(h=0,a||c.ownerDocument===D||(L(c),s=!z);p=t[h++];)if(p(c,a||D,s)){l.push(c);break}u&&(B=x)}o&&((c=!p&&c)&&f--,n&&g.push(c))}if(f+=d,o&&d!==f){for(h=0;p=i[h++];)p(g,y,a,s);if(n){if(f>0)for(;d--;)g[d]||y[d]||(y[d]=Z.call(l));y=m(y)}K.apply(l,y),u&&!n&&y.length>0&&f+i.length>1&&e.uniqueSort(l)}return u&&(B=x,A=v),g};return o?n(a):a}var _,x,b,w,T,E,C,S,A,k,I,L,D,P,z,M,O,R,N,j="sizzle"+1*new Date,F=t.document,B=0,V=0,U=i(),H=i(),q=i(),W=function(t,e){return t===e&&(I=!0),0},$={}.hasOwnProperty,G=[],Z=G.pop,X=G.push,K=G.push,Q=G.slice,Y=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",it="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",nt=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",ot=new RegExp(tt+"+","g"),rt=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),at=new RegExp("^"+tt+"*,"+tt+"*"),st=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),lt=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),ut=new RegExp(nt),ct=new RegExp("^"+et+"$"),ht={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+nt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,ft=/^h\d$/i,dt=/^[^{]+\{\s*\[native \w/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/[+~]/,yt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),vt=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},_t=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,xt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},bt=function(){L()},wt=p(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{K.apply(G=Q.call(F.childNodes),F.childNodes),G[F.childNodes.length].nodeType}catch(t){K={apply:G.length?function(t,e){X.apply(t,Q.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}x=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},L=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:F;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,P=D.documentElement,z=!T(D),F!==D&&(i=D.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",bt,!1):i.attachEvent&&i.attachEvent("onunload",bt)),x.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=o(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=dt.test(D.getElementsByClassName),x.getById=o(function(t){return P.appendChild(t).id=j,!D.getElementsByName||!D.getElementsByName(j).length}),x.getById?(b.filter.ID=function(t){var e=t.replace(yt,vt);return function(t){return t.getAttribute("id")===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&z){var i=e.getElementById(t);return i?[i]:[]}}):(b.filter.ID=function(t){var e=t.replace(yt,vt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&z){var i,n,o,r=e.getElementById(t);if(r){if((i=r.getAttributeNode("id"))&&i.value===t)return[r];for(o=e.getElementsByName(t),n=0;r=o[n++];)if((i=r.getAttributeNode("id"))&&i.value===t)return[r]}return[]}}),b.find.TAG=x.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},b.find.CLASS=x.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&z)return e.getElementsByClassName(t)},O=[],M=[],(x.qsa=dt.test(D.querySelectorAll))&&(o(function(t){P.appendChild(t).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&M.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||M.push("\\["+tt+"*(?:value|"+J+")"),t.querySelectorAll("[id~="+j+"-]").length||M.push("~="),t.querySelectorAll(":checked").length||M.push(":checked"),t.querySelectorAll("a#"+j+"+*").length||M.push(".#.+[+~]")}),o(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&M.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&M.push(":enabled",":disabled"),P.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&M.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),M.push(",.*:")})),(x.matchesSelector=dt.test(R=P.matches||P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&o(function(t){x.disconnectedMatch=R.call(t,"*"),R.call(t,"[s!='']:x"),O.push("!=",nt)}),M=M.length&&new RegExp(M.join("|")),O=O.length&&new RegExp(O.join("|")),e=dt.test(P.compareDocumentPosition),N=e||dt.test(P.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return I=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!x.sortDetached&&e.compareDocumentPosition(t)===i?t===D||t.ownerDocument===F&&N(F,t)?-1:e===D||e.ownerDocument===F&&N(F,e)?1:k?Y(k,t)-Y(k,e):0:4&i?-1:1)}:function(t,e){if(t===e)return I=!0,0;var i,n=0,o=t.parentNode,r=e.parentNode,s=[t],l=[e];if(!o||!r)return t===D?-1:e===D?1:o?-1:r?1:k?Y(k,t)-Y(k,e):0;if(o===r)return a(t,e);for(i=t;i=i.parentNode;)s.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;s[n]===l[n];)n++;return n?a(s[n],l[n]):s[n]===F?-1:l[n]===F?1:0},D):D},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==D&&L(t),i=i.replace(lt,"='$1']"),x.matchesSelector&&z&&!q[i+" "]&&(!O||!O.test(i))&&(!M||!M.test(i)))try{var n=R.call(t,i);if(n||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(i,D,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==D&&L(t),N(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==D&&L(t);var i=b.attrHandle[e.toLowerCase()],n=i&&$.call(b.attrHandle,e.toLowerCase())?i(t,e,!z):void 0;return void 0!==n?n:x.attributes||!z?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.escape=function(t){return(t+"").replace(_t,xt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,o=0;if(I=!x.detectDuplicates,k=!x.sortStable&&t.slice(0),t.sort(W),I){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return k=null,t},w=e.getText=function(t){var e,i="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=w(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n++];)i+=w(e);return i},(b=e.selectors={cacheLength:50,createPseudo:n,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(yt,vt),t[3]=(t[3]||t[4]||t[5]||"").replace(yt,vt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ut.test(i)&&(e=E(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(yt,vt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=U[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&U(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(o){var r=e.attr(o,t);return null==r?"!="===i:!i||(r+="","="===i?r===n:"!="===i?r!==n:"^="===i?n&&0===r.indexOf(n):"*="===i?n&&r.indexOf(n)>-1:"$="===i?n&&r.slice(-n.length)===n:"~="===i?(" "+r.replace(ot," ")+" ").indexOf(n)>-1:"|="===i&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,o){var r="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var u,c,h,p,f,d,m=r!==a?"nextSibling":"previousSibling",g=e.parentNode,y=s&&e.nodeName.toLowerCase(),v=!l&&!s,_=!1;if(g){if(r){for(;m;){for(p=e;p=p[m];)if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=m="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?g.firstChild:g.lastChild],a&&v){for(_=(f=(u=(c=(h=(p=g)[j]||(p[j]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]||[])[0]===B&&u[1])&&u[2],p=f&&g.childNodes[f];p=++f&&p&&p[m]||(_=f=0)||d.pop();)if(1===p.nodeType&&++_&&p===e){c[t]=[B,f,_];break}}else if(v&&(_=f=(u=(c=(h=(p=e)[j]||(p[j]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]||[])[0]===B&&u[1]),!1===_)for(;(p=++f&&p&&p[m]||(_=f=0)||d.pop())&&((s?p.nodeName.toLowerCase()!==y:1!==p.nodeType)||!++_||(v&&((c=(h=p[j]||(p[j]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]=[B,_]),p!==e)););return(_-=o)===n||_%n==0&&_/n>=0}}},PSEUDO:function(t,i){var o,r=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[j]?r(i):r.length>1?(o=[t,t,"",i],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,o=r(t,i),a=o.length;a--;)t[n=Y(t,o[a])]=!(e[n]=o[a])}):function(t){return r(t,0,o)}):r}},pseudos:{not:n(function(t){var e=[],i=[],o=C(t.replace(rt,"$1"));return o[j]?n(function(t,e,i,n){for(var r,a=o(t,null,n,[]),s=t.length;s--;)(r=a[s])&&(t[s]=!(e[s]=r))}):function(t,n,r){return e[0]=t,o(e,null,r,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(yt,vt),function(e){return(e.textContent||e.innerText||w(e)).indexOf(t)>-1}}),lang:n(function(t){return ct.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(yt,vt).toLowerCase(),function(e){var i;do{if(i=z?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===P},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:s(!1),disabled:s(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return ft.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=b.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[_]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(_);for(_ in{submit:!0,reset:!0})b.pseudos[_]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(_);return c.prototype=b.filters=b.pseudos,b.setFilters=new c,E=e.tokenize=function(t,i){var n,o,r,a,s,l,u,c=H[t+" "];if(c)return i?0:c.slice(0);for(s=t,l=[],u=b.preFilter;s;){n&&!(o=at.exec(s))||(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),n=!1,(o=st.exec(s))&&(n=o.shift(),r.push({value:n,type:o[0].replace(rt," ")}),s=s.slice(n.length));for(a in b.filter)!(o=ht[a].exec(s))||u[a]&&!(o=u[a](o))||(n=o.shift(),r.push({value:n,type:a,matches:o}),s=s.slice(n.length));if(!n)break}return i?s.length:s?e.error(t):H(t,l).slice(0)},C=e.compile=function(t,e){var i,n=[],o=[],r=q[t+" "];if(!r){for(e||(e=E(t)),i=e.length;i--;)(r=y(e[i]))[j]?n.push(r):o.push(r);(r=q(t,v(o,n))).selector=t}return r},S=e.select=function(t,e,i,n){var o,r,a,s,l,c="function"==typeof t&&t,p=!n&&E(t=c.selector||t);if(i=i||[],1===p.length){if((r=p[0]=p[0].slice(0)).length>2&&"ID"===(a=r[0]).type&&9===e.nodeType&&z&&b.relative[r[1].type]){if(!(e=(b.find.ID(a.matches[0].replace(yt,vt),e)||[])[0]))return i;c&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(o=ht.needsContext.test(t)?0:r.length;o--&&(a=r[o],!b.relative[s=a.type]);)if((l=b.find[s])&&(n=l(a.matches[0].replace(yt,vt),gt.test(r[0].type)&&u(e.parentNode)||e))){if(r.splice(o,1),!(t=n.length&&h(r)))return K.apply(i,n),i;break}}return(c||C(t,p))(n,e,!z,i,!e||gt.test(t)&&u(e.parentNode)||e),i},x.sortStable=j.split("").sort(W).join("")===j,x.detectDuplicates=!!I,L(),x.sortDetached=o(function(t){return 1&t.compareDocumentPosition(D.createElement("fieldset"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||r(J,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);ft.find=vt,ft.expr=vt.selectors,ft.expr[":"]=ft.expr.pseudos,ft.uniqueSort=ft.unique=vt.uniqueSort,ft.text=vt.getText,ft.isXMLDoc=vt.isXML,ft.contains=vt.contains,ft.escapeSelector=vt.escape;var _t=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&ft(t).is(i))break;n.push(t)}return n},xt=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},bt=ft.expr.match.needsContext,wt=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Tt=/^.[^:#\[\.,]*$/;ft.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?ft.find.matchesSelector(n,t)?[n]:[]:ft.find.matches(t,ft.grep(e,function(t){return 1===t.nodeType}))},ft.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(ft(t).filter(function(){for(e=0;e<n;e++)if(ft.contains(o[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)ft.find(t,o[e],i);return n>1?ft.uniqueSort(i):i},filter:function(t){return this.pushStack(r(this,t||[],!1))},not:function(t){return this.pushStack(r(this,t||[],!0))},is:function(t){return!!r(this,"string"==typeof t&&bt.test(t)?ft(t):t||[],!1).length}});var Et,Ct=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ft.fn.init=function(t,e,i){var n,o;if(!t)return this;if(i=i||Et,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Ct.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof ft?e[0]:e,ft.merge(this,ft.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:et,!0)),wt.test(n[1])&&ft.isPlainObject(e))for(n in e)ft.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(o=et.getElementById(n[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):ft.isFunction(t)?void 0!==i.ready?i.ready(t):t(ft):ft.makeArray(t,this)}).prototype=ft.fn,Et=ft(et);var St=/^(?:parents|prev(?:Until|All))/,At={children:!0,contents:!0,next:!0,prev:!0};ft.fn.extend({has:function(t){var e=ft(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(ft.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,o=this.length,r=[],a="string"!=typeof t&&ft(t);if(!bt.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&ft.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?ft.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?at.call(ft(t),this[0]):at.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(ft.uniqueSort(ft.merge(this.get(),ft(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ft.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return _t(t,"parentNode")},parentsUntil:function(t,e,i){return _t(t,"parentNode",i)},next:function(t){return a(t,"nextSibling")},prev:function(t){return a(t,"previousSibling")},nextAll:function(t){return _t(t,"nextSibling")},prevAll:function(t){return _t(t,"previousSibling")},nextUntil:function(t,e,i){return _t(t,"nextSibling",i)},prevUntil:function(t,e,i){return _t(t,"previousSibling",i)},siblings:function(t){return xt((t.parentNode||{}).firstChild,t)},children:function(t){return xt(t.firstChild)},contents:function(t){return o(t,"iframe")?t.contentDocument:(o(t,"template")&&(t=t.content||t),ft.merge([],t.childNodes))}},function(t,e){ft.fn[t]=function(i,n){var o=ft.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=ft.filter(n,o)),this.length>1&&(At[t]||ft.uniqueSort(o),St.test(t)&&o.reverse()),this.pushStack(o)}});var kt=/[^\x20\t\r\n\f]+/g;ft.Callbacks=function(t){t="string"==typeof t?s(t):ft.extend({},t);var e,i,n,o,r=[],a=[],l=-1,u=function(){for(o=o||t.once,n=e=!0;a.length;l=-1)for(i=a.shift();++l<r.length;)!1===r[l].apply(i[0],i[1])&&t.stopOnFalse&&(l=r.length,i=!1);t.memory||(i=!1),e=!1,o&&(r=i?[]:"")},c={add:function(){return r&&(i&&!e&&(l=r.length-1,a.push(i)),function e(i){ft.each(i,function(i,n){ft.isFunction(n)?t.unique&&c.has(n)||r.push(n):n&&n.length&&"string"!==ft.type(n)&&e(n)})}(arguments),i&&!e&&u()),this},remove:function(){return ft.each(arguments,function(t,e){for(var i;(i=ft.inArray(e,r,i))>-1;)r.splice(i,1),i<=l&&l--}),this},has:function(t){return t?ft.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=a=[],r=i="",this},disabled:function(){return!r},lock:function(){return o=a=[],i||e||(r=i=""),this},locked:function(){return!!o},fireWith:function(t,i){return o||(i=[t,(i=i||[]).slice?i.slice():i],a.push(i),e||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},ft.extend({Deferred:function(e){var i=[["notify","progress",ft.Callbacks("memory"),ft.Callbacks("memory"),2],["resolve","done",ft.Callbacks("once memory"),ft.Callbacks("once memory"),0,"resolved"],["reject","fail",ft.Callbacks("once memory"),ft.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return ft.Deferred(function(e){ft.each(i,function(i,n){var o=ft.isFunction(t[n[4]])&&t[n[4]];r[n[1]](function(){var t=o&&o.apply(this,arguments);t&&ft.isFunction(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,o?[t]:arguments)})}),t=null}).promise()},then:function(e,n,o){function r(e,i,n,o){return function(){var s=this,c=arguments,h=function(){var t,h;if(!(e<a)){if((t=n.apply(s,c))===i.promise())throw new TypeError("Thenable self-resolution");h=t&&("object"==typeof t||"function"==typeof t)&&t.then,ft.isFunction(h)?o?h.call(t,r(a,i,l,o),r(a,i,u,o)):(a++,h.call(t,r(a,i,l,o),r(a,i,u,o),r(a,i,l,i.notifyWith))):(n!==l&&(s=void 0,c=[t]),(o||i.resolveWith)(s,c))}},p=o?h:function(){try{h()}catch(t){ft.Deferred.exceptionHook&&ft.Deferred.exceptionHook(t,p.stackTrace),e+1>=a&&(n!==u&&(s=void 0,c=[t]),i.rejectWith(s,c))}};e?p():(ft.Deferred.getStackHook&&(p.stackTrace=ft.Deferred.getStackHook()),t.setTimeout(p))}}var a=0;return ft.Deferred(function(t){i[0][3].add(r(0,t,ft.isFunction(o)?o:l,t.notifyWith)),i[1][3].add(r(0,t,ft.isFunction(e)?e:l)),i[2][3].add(r(0,t,ft.isFunction(n)?n:u))}).promise()},promise:function(t){return null!=t?ft.extend(t,o):o}},r={};return ft.each(i,function(t,e){var a=e[2],s=e[5];o[e[1]]=a.add,s&&a.add(function(){n=s},i[3-t][2].disable,i[0][2].lock),a.add(e[3].fire),r[e[0]]=function(){return r[e[0]+"With"](this===r?void 0:this,arguments),this},r[e[0]+"With"]=a.fireWith}),o.promise(r),e&&e.call(r,r),r},when:function(t){var e=arguments.length,i=e,n=Array(i),o=nt.call(arguments),r=ft.Deferred(),a=function(t){return function(i){n[t]=this,o[t]=arguments.length>1?nt.call(arguments):i,--e||r.resolveWith(n,o)}};if(e<=1&&(c(t,r.done(a(i)).resolve,r.reject,!e),"pending"===r.state()||ft.isFunction(o[i]&&o[i].then)))return r.then();for(;i--;)c(o[i],a(i),r.reject);return r.promise()}});var It=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ft.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&It.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},ft.readyException=function(e){t.setTimeout(function(){throw e})};var Lt=ft.Deferred();ft.fn.ready=function(t){return Lt.then(t).catch(function(t){ft.readyException(t)}),this},ft.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--ft.readyWait:ft.isReady)||(ft.isReady=!0,!0!==t&&--ft.readyWait>0||Lt.resolveWith(et,[ft]))}}),ft.ready.then=Lt.then,"complete"===et.readyState||"loading"!==et.readyState&&!et.documentElement.doScroll?t.setTimeout(ft.ready):(et.addEventListener("DOMContentLoaded",h),t.addEventListener("load",h));var Dt=function(t,e,i,n,o,r,a){var s=0,l=t.length,u=null==i;if("object"===ft.type(i)){o=!0;for(s in i)Dt(t,e,s,i[s],!0,r,a)}else if(void 0!==n&&(o=!0,ft.isFunction(n)||(a=!0),u&&(a?(e.call(t,n),e=null):(u=e,e=function(t,e,i){return u.call(ft(t),i)})),e))for(;s<l;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return o?t:u?e.call(t):l?e(t[0],i):r},Pt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};p.uid=1,p.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Pt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[ft.camelCase(e)]=i;else for(n in e)o[ft.camelCase(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][ft.camelCase(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(ft.camelCase):(e=ft.camelCase(e))in n?[e]:e.match(kt)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||ft.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!ft.isEmptyObject(e)}};var zt=new p,Mt=new p,Ot=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Rt=/[A-Z]/g;ft.extend({hasData:function(t){return Mt.hasData(t)||zt.hasData(t)},data:function(t,e,i){return Mt.access(t,e,i)},removeData:function(t,e){Mt.remove(t,e)},_data:function(t,e,i){return zt.access(t,e,i)},_removeData:function(t,e){zt.remove(t,e)}}),ft.fn.extend({data:function(t,e){var i,n,o,r=this[0],a=r&&r.attributes;if(void 0===t){if(this.length&&(o=Mt.get(r),1===r.nodeType&&!zt.get(r,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&0===(n=a[i].name).indexOf("data-")&&(n=ft.camelCase(n.slice(5)),d(r,n,o[n]));zt.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){Mt.set(this,t)}):Dt(this,function(e){var i;if(r&&void 0===e){if(void 0!==(i=Mt.get(r,t)))return i;if(void 0!==(i=d(r,t)))return i}else this.each(function(){Mt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Mt.remove(this,t)})}}),ft.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=zt.get(t,e),i&&(!n||Array.isArray(i)?n=zt.access(t,e,ft.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=ft.queue(t,e),n=i.length,o=i.shift(),r=ft._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete r.stop,o.call(t,function(){ft.dequeue(t,e)},r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return zt.get(t,i)||zt.access(t,i,{empty:ft.Callbacks("once memory").add(function(){zt.remove(t,[e+"queue",i])})})}}),ft.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?ft.queue(this[0],t):void 0===e?this:this.each(function(){var i=ft.queue(this,t,e);ft._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&ft.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ft.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=ft.Deferred(),r=this,a=this.length,s=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=zt.get(r[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(s));return s(),o.promise(e)}});var Nt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,jt=new RegExp("^(?:([+-])=|)("+Nt+")([a-z%]*)$","i"),Ft=["Top","Right","Bottom","Left"],Bt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&ft.contains(t.ownerDocument,t)&&"none"===ft.css(t,"display")},Vt=function(t,e,i,n){var o,r,a={};for(r in e)a[r]=t.style[r],t.style[r]=e[r];o=i.apply(t,n||[]);for(r in e)t.style[r]=a[r];return o},Ut={};ft.fn.extend({show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Bt(this)?ft(this).show():ft(this).hide()})}});var Ht=/^(?:checkbox|radio)$/i,qt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Wt=/^$|\/(?:java|ecma)script/i,$t={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$t.optgroup=$t.option,$t.tbody=$t.tfoot=$t.colgroup=$t.caption=$t.thead,$t.th=$t.td;var Gt=/<|&#?\w+;/;!function(){var t=et.createDocumentFragment().appendChild(et.createElement("div")),e=et.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),pt.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",pt.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Zt=et.documentElement,Xt=/^key/,Kt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Qt=/^([^.]*)(?:\.(.+)|)/;ft.event={global:{},add:function(t,e,i,n,o){var r,a,s,l,u,c,h,p,f,d,m,g=zt.get(t);if(g)for(i.handler&&(i=(r=i).handler,o=r.selector),o&&ft.find.matchesSelector(Zt,o),i.guid||(i.guid=ft.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(e){return void 0!==ft&&ft.event.triggered!==e.type?ft.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(kt)||[""]).length;u--;)f=m=(s=Qt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),f&&(h=ft.event.special[f]||{},f=(o?h.delegateType:h.bindType)||f,h=ft.event.special[f]||{},c=ft.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&ft.expr.match.needsContext.test(o),namespace:d.join(".")},r),(p=l[f])||((p=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,n,d,a)||t.addEventListener&&t.addEventListener(f,a)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),o?p.splice(p.delegateCount++,0,c):p.push(c),ft.event.global[f]=!0)},remove:function(t,e,i,n,o){var r,a,s,l,u,c,h,p,f,d,m,g=zt.hasData(t)&&zt.get(t);if(g&&(l=g.events)){for(u=(e=(e||"").match(kt)||[""]).length;u--;)if(s=Qt.exec(e[u])||[],f=m=s[1],d=(s[2]||"").split(".").sort(),f){for(h=ft.event.special[f]||{},p=l[f=(n?h.delegateType:h.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=p.length;r--;)c=p[r],!o&&m!==c.origType||i&&i.guid!==c.guid||s&&!s.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(p.splice(r,1),c.selector&&p.delegateCount--,h.remove&&h.remove.call(t,c));a&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,d,g.handle)||ft.removeEvent(t,f,g.handle),delete l[f])}else for(f in l)ft.event.remove(t,f+e[u],i,n,!0);ft.isEmptyObject(l)&&zt.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,r,a,s=ft.event.fix(t),l=new Array(arguments.length),u=(zt.get(this,"events")||{})[s.type]||[],c=ft.event.special[s.type]||{};for(l[0]=s,e=1;e<arguments.length;e++)l[e]=arguments[e];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(a=ft.event.handlers.call(this,s,u),e=0;(o=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(r.namespace)||(s.handleObj=r,s.data=r.data,void 0!==(n=((ft.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l))&&!1===(s.result=n)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(t,e){var i,n,o,r,a,s=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&t.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(r=[],a={},i=0;i<l;i++)void 0===a[o=(n=e[i]).selector+" "]&&(a[o]=n.needsContext?ft(o,this).index(u)>-1:ft.find(o,this,null,[u]).length),a[o]&&r.push(n);r.length&&s.push({elem:u,handlers:r})}return u=this,l<e.length&&s.push({elem:u,handlers:e.slice(l)}),s},addProp:function(t,e){Object.defineProperty(ft.Event.prototype,t,{enumerable:!0,configurable:!0,get:ft.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[ft.expando]?t:new ft.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==T()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===T()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&o(this,"input"))return this.click(),!1},_default:function(t){return o(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},ft.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},ft.Event=function(t,e){if(!(this instanceof ft.Event))return new ft.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?b:w,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&ft.extend(this,e),this.timeStamp=t&&t.timeStamp||ft.now(),this[ft.expando]=!0},ft.Event.prototype={constructor:ft.Event,isDefaultPrevented:w,isPropagationStopped:w,isImmediatePropagationStopped:w,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=b,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=b,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=b,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},ft.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Xt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Kt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},ft.event.addProp),ft.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){ft.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,r=t.handleObj;return o&&(o===n||ft.contains(n,o))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),ft.fn.extend({on:function(t,e,i,n){return E(this,t,e,i,n)},one:function(t,e,i,n){return E(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,ft(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=w),this.each(function(){ft.event.remove(this,t,i,e)})}});var Yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Jt=/<script|<style|<link/i,te=/checked\s*(?:[^=]|=\s*.checked.)/i,ee=/^true\/(.*)/,ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ft.extend({htmlPrefilter:function(t){return t.replace(Yt,"<$1></$2>")},clone:function(t,e,i){var n,o,r,a,s=t.cloneNode(!0),l=ft.contains(t.ownerDocument,t);if(!(pt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ft.isXMLDoc(t)))for(a=v(s),n=0,o=(r=v(t)).length;n<o;n++)I(r[n],a[n]);if(e)if(i)for(r=r||v(t),a=a||v(s),n=0,o=r.length;n<o;n++)k(r[n],a[n]);else k(t,s);return(a=v(s,"script")).length>0&&_(a,!l&&v(t,"script")),s},cleanData:function(t){for(var e,i,n,o=ft.event.special,r=0;void 0!==(i=t[r]);r++)if(Pt(i)){if(e=i[zt.expando]){if(e.events)for(n in e.events)o[n]?ft.event.remove(i,n):ft.removeEvent(i,n,e.handle);i[zt.expando]=void 0}i[Mt.expando]&&(i[Mt.expando]=void 0)}}}),ft.fn.extend({detach:function(t){return D(this,t,!0)},remove:function(t){return D(this,t)},text:function(t){return Dt(this,function(t){return void 0===t?ft.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return L(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||C(this,t).appendChild(t)})},prepend:function(){return L(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=C(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(ft.cleanData(v(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return ft.clone(this,t,e)})},html:function(t){return Dt(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Jt.test(t)&&!$t[(qt.exec(t)||["",""])[1].toLowerCase()]){t=ft.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(ft.cleanData(v(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return L(this,arguments,function(e){var i=this.parentNode;ft.inArray(this,t)<0&&(ft.cleanData(v(this)),i&&i.replaceChild(e,this))},t)}}),ft.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ft.fn[t]=function(t){for(var i,n=[],o=ft(t),r=o.length-1,a=0;a<=r;a++)i=a===r?this:this.clone(!0),ft(o[a])[e](i),rt.apply(n,i.get());return this.pushStack(n)}});var ne=/^margin/,oe=new RegExp("^("+Nt+")(?!px)[a-z%]+$","i"),re=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)};!function(){function e(){if(s){s.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Zt.appendChild(a);var e=t.getComputedStyle(s);i="1%"!==e.top,r="2px"===e.marginLeft,n="4px"===e.width,s.style.marginRight="50%",o="4px"===e.marginRight,Zt.removeChild(a),s=null}}var i,n,o,r,a=et.createElement("div"),s=et.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",pt.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(s),ft.extend(pt,{pixelPosition:function(){return e(),i},boxSizingReliable:function(){return e(),n},pixelMarginRight:function(){return e(),o},reliableMarginLeft:function(){return e(),r}}))}();var ae=/^(none|table(?!-c[ea]).+)/,se=/^--/,le={position:"absolute",visibility:"hidden",display:"block"},ue={letterSpacing:"0",fontWeight:"400"},ce=["Webkit","Moz","ms"],he=et.createElement("div").style;ft.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=P(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,a,s=ft.camelCase(e),l=se.test(e),u=t.style;if(l||(e=O(s)),a=ft.cssHooks[e]||ft.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:u[e];"string"==(r=typeof i)&&(o=jt.exec(i))&&o[1]&&(i=m(t,e,o),r="number"),null!=i&&i===i&&("number"===r&&(i+=o&&o[3]||(ft.cssNumber[s]?"":"px")),pt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l?u.setProperty(e,i):u[e]=i))}},css:function(t,e,i,n){var o,r,a,s=ft.camelCase(e);return se.test(e)||(e=O(s)),(a=ft.cssHooks[e]||ft.cssHooks[s])&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=P(t,e,n)),"normal"===o&&e in ue&&(o=ue[e]),""===i||i?(r=parseFloat(o),!0===i||isFinite(r)?r||0:o):o}}),ft.each(["height","width"],function(t,e){ft.cssHooks[e]={get:function(t,i,n){if(i)return!ae.test(ft.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?j(t,e,n):Vt(t,le,function(){return j(t,e,n)})},set:function(t,i,n){var o,r=n&&re(t),a=n&&N(t,e,n,"border-box"===ft.css(t,"boxSizing",!1,r),r);return a&&(o=jt.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=ft.css(t,e)),R(0,i,a)}}}),ft.cssHooks.marginLeft=z(pt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(P(t,"marginLeft"))||t.getBoundingClientRect().left-Vt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),ft.each({margin:"",padding:"",border:"Width"},function(t,e){ft.cssHooks[t+e]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];n<4;n++)o[t+Ft[n]+e]=r[n]||r[n-2]||r[0];return o}},ne.test(t)||(ft.cssHooks[t+e].set=R)}),ft.fn.extend({css:function(t,e){return Dt(this,function(t,e,i){var n,o,r={},a=0;if(Array.isArray(e)){for(n=re(t),o=e.length;a<o;a++)r[e[a]]=ft.css(t,e[a],!1,n);return r}return void 0!==i?ft.style(t,e,i):ft.css(t,e)},t,e,arguments.length>1)}}),ft.Tween=F,F.prototype={constructor:F,init:function(t,e,i,n,o,r){this.elem=t,this.prop=i,this.easing=o||ft.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(ft.cssNumber[i]?"":"px")},cur:function(){var t=F.propHooks[this.prop];return t&&t.get?t.get(this):F.propHooks._default.get(this)},run:function(t){var e,i=F.propHooks[this.prop];return this.options.duration?this.pos=e=ft.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):F.propHooks._default.set(this),this}},F.prototype.init.prototype=F.prototype,F.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=ft.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){ft.fx.step[t.prop]?ft.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[ft.cssProps[t.prop]]&&!ft.cssHooks[t.prop]?t.elem[t.prop]=t.now:ft.style(t.elem,t.prop,t.now+t.unit)}}},F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ft.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},ft.fx=F.prototype.init,ft.fx.step={};var pe,fe,de=/^(?:toggle|show|hide)$/,me=/queueHooks$/;ft.Animation=ft.extend(W,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return m(i.elem,t,jt.exec(e),i),i}]},tweener:function(t,e){ft.isFunction(t)?(e=t,t=["*"]):t=t.match(kt);for(var i,n=0,o=t.length;n<o;n++)i=t[n],W.tweeners[i]=W.tweeners[i]||[],W.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,o,r,a,s,l,u,c,h="width"in e||"height"in e,p=this,f={},d=t.style,m=t.nodeType&&Bt(t),g=zt.get(t,"fxshow");i.queue||(null==(a=ft._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ft.queue(t,"fx").length||a.empty.fire()})}));for(n in e)if(o=e[n],de.test(o)){if(delete e[n],r=r||"toggle"===o,o===(m?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;m=!0}f[n]=g&&g[n]||ft.style(t,n)}if((l=!ft.isEmptyObject(e))||!ft.isEmptyObject(f)){h&&1===t.nodeType&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],null==(u=g&&g.display)&&(u=zt.get(t,"display")),"none"===(c=ft.css(t,"display"))&&(u?c=u:(y([t],!0),u=t.style.display||u,c=ft.css(t,"display"),y([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===ft.css(t,"float")&&(l||(p.done(function(){d.display=u}),null==u&&(c=d.display,u="none"===c?"":c)),d.display="inline-block")),i.overflow&&(d.overflow="hidden",p.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]})),l=!1;for(n in f)l||(g?"hidden"in g&&(m=g.hidden):g=zt.access(t,"fxshow",{display:u}),r&&(g.hidden=!m),m&&y([t],!0),p.done(function(){m||y([t]),zt.remove(t,"fxshow");for(n in f)ft.style(t,n,f[n])})),l=H(m?g[n]:0,n,p),n in g||(g[n]=l.start,m&&(l.end=l.start,l.start=0))}}],prefilter:function(t,e){e?W.prefilters.unshift(t):W.prefilters.push(t)}}),ft.speed=function(t,e,i){var n=t&&"object"==typeof t?ft.extend({},t):{complete:i||!i&&e||ft.isFunction(t)&&t,duration:t,easing:i&&e||e&&!ft.isFunction(e)&&e};return ft.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in ft.fx.speeds?n.duration=ft.fx.speeds[n.duration]:n.duration=ft.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){ft.isFunction(n.old)&&n.old.call(this),n.queue&&ft.dequeue(this,n.queue)},n},ft.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Bt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=ft.isEmptyObject(t),r=ft.speed(e,i,n),a=function(){var e=W(this,ft.extend({},t),r);(o||zt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===r.queue?this.each(a):this.queue(r.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",r=ft.timers,a=zt.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&me.test(o)&&n(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(i),e=!1,r.splice(o,1));!e&&i||ft.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=zt.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],r=ft.timers,a=n?n.length:0;for(i.finish=!0,ft.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<a;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),ft.each(["toggle","show","hide"],function(t,e){var i=ft.fn[e];ft.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(U(e,!0),t,n,o)}}),ft.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ft.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),ft.timers=[],ft.fx.tick=function(){var t,e=0,i=ft.timers;for(pe=ft.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||ft.fx.stop(),pe=void 0},ft.fx.timer=function(t){ft.timers.push(t),ft.fx.start()},ft.fx.interval=13,ft.fx.start=function(){fe||(fe=!0,B())},ft.fx.stop=function(){fe=null},ft.fx.speeds={slow:600,fast:200,_default:400},ft.fn.delay=function(e,i){return e=ft.fx?ft.fx.speeds[e]||e:e,i=i||"fx",this.queue(i,function(i,n){var o=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(o)}})},function(){var t=et.createElement("input"),e=et.createElement("select").appendChild(et.createElement("option"));t.type="checkbox",pt.checkOn=""!==t.value,pt.optSelected=e.selected,(t=et.createElement("input")).value="t",t.type="radio",pt.radioValue="t"===t.value}();var ge,ye=ft.expr.attrHandle;ft.fn.extend({attr:function(t,e){return Dt(this,ft.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ft.removeAttr(this,t)})}}),ft.extend({attr:function(t,e,i){var n,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?ft.prop(t,e,i):(1===r&&ft.isXMLDoc(t)||(o=ft.attrHooks[e.toLowerCase()]||(ft.expr.match.bool.test(e)?ge:void 0)),void 0!==i?null===i?void ft.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:null==(n=ft.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!pt.radioValue&&"radio"===e&&o(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match(kt);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),ge={set:function(t,e,i){return!1===e?ft.removeAttr(t,i):t.setAttribute(i,i),i}},ft.each(ft.expr.match.bool.source.match(/\w+/g),function(t,e){var i=ye[e]||ft.find.attr;ye[e]=function(t,e,n){var o,r,a=e.toLowerCase();return n||(r=ye[a],ye[a]=o,o=null!=i(t,e,n)?a:null,ye[a]=r),o}});var ve=/^(?:input|select|textarea|button)$/i,_e=/^(?:a|area)$/i;ft.fn.extend({prop:function(t,e){return Dt(this,ft.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[ft.propFix[t]||t]})}}),ft.extend({prop:function(t,e,i){var n,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&ft.isXMLDoc(t)||(e=ft.propFix[e]||e,o=ft.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=ft.find.attr(t,"tabindex");return e?parseInt(e,10):ve.test(t.nodeName)||_e.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),pt.optSelected||(ft.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),ft.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ft.propFix[this.toLowerCase()]=this}),ft.fn.extend({addClass:function(t){var e,i,n,o,r,a,s,l=0;if(ft.isFunction(t))return this.each(function(e){ft(this).addClass(t.call(this,e,G(this)))});if("string"==typeof t&&t)for(e=t.match(kt)||[];i=this[l++];)if(o=G(i),n=1===i.nodeType&&" "+$(o)+" "){for(a=0;r=e[a++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o!==(s=$(n))&&i.setAttribute("class",s)}return this},removeClass:function(t){var e,i,n,o,r,a,s,l=0;if(ft.isFunction(t))return this.each(function(e){ft(this).removeClass(t.call(this,e,G(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(kt)||[];i=this[l++];)if(o=G(i),n=1===i.nodeType&&" "+$(o)+" "){for(a=0;r=e[a++];)for(;n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");o!==(s=$(n))&&i.setAttribute("class",s)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):ft.isFunction(t)?this.each(function(i){ft(this).toggleClass(t.call(this,i,G(this),e),e)}):this.each(function(){var e,n,o,r;if("string"===i)for(n=0,o=ft(this),r=t.match(kt)||[];e=r[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==i||((e=G(this))&&zt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":zt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+$(G(i))+" ").indexOf(e)>-1)return!0;return!1}});var xe=/\r/g;ft.fn.extend({val:function(t){var e,i,n,o=this[0];{if(arguments.length)return n=ft.isFunction(t),this.each(function(i){var o;1===this.nodeType&&(null==(o=n?t.call(this,i,ft(this).val()):t)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=ft.map(o,function(t){return null==t?"":t+""})),(e=ft.valHooks[this.type]||ft.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return(e=ft.valHooks[o.type]||ft.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(xe,""):null==i?"":i}}}),ft.extend({valHooks:{option:{get:function(t){var e=ft.find.attr(t,"value");return null!=e?e:$(ft.text(t))}},select:{get:function(t){var e,i,n,r=t.options,a=t.selectedIndex,s="select-one"===t.type,l=s?null:[],u=s?a+1:r.length;for(n=a<0?u:s?a:0;n<u;n++)if(((i=r[n]).selected||n===a)&&!i.disabled&&(!i.parentNode.disabled||!o(i.parentNode,"optgroup"))){if(e=ft(i).val(),s)return e;l.push(e)}return l},set:function(t,e){for(var i,n,o=t.options,r=ft.makeArray(e),a=o.length;a--;)((n=o[a]).selected=ft.inArray(ft.valHooks.option.get(n),r)>-1)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),ft.each(["radio","checkbox"],function(){ft.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=ft.inArray(ft(t).val(),e)>-1}},pt.checkOn||(ft.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var be=/^(?:focusinfocus|focusoutblur)$/;ft.extend(ft.event,{trigger:function(e,i,n,o){var r,a,s,l,u,c,h,p=[n||et],f=ut.call(e,"type")?e.type:e,d=ut.call(e,"namespace")?e.namespace.split("."):[];if(a=s=n=n||et,3!==n.nodeType&&8!==n.nodeType&&!be.test(f+ft.event.triggered)&&(f.indexOf(".")>-1&&(f=(d=f.split(".")).shift(),d.sort()),u=f.indexOf(":")<0&&"on"+f,e=e[ft.expando]?e:new ft.Event(f,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=d.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:ft.makeArray(i,[e]),h=ft.event.special[f]||{},o||!h.trigger||!1!==h.trigger.apply(n,i))){if(!o&&!h.noBubble&&!ft.isWindow(n)){for(l=h.delegateType||f,be.test(l+f)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(n.ownerDocument||et)&&p.push(s.defaultView||s.parentWindow||t)}for(r=0;(a=p[r++])&&!e.isPropagationStopped();)e.type=r>1?l:h.bindType||f,(c=(zt.get(a,"events")||{})[e.type]&&zt.get(a,"handle"))&&c.apply(a,i),(c=u&&a[u])&&c.apply&&Pt(a)&&(e.result=c.apply(a,i),!1===e.result&&e.preventDefault());return e.type=f,o||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),i)||!Pt(n)||u&&ft.isFunction(n[f])&&!ft.isWindow(n)&&((s=n[u])&&(n[u]=null),ft.event.triggered=f,n[f](),ft.event.triggered=void 0,s&&(n[u]=s)),e.result}},simulate:function(t,e,i){var n=ft.extend(new ft.Event,i,{type:t,isSimulated:!0});ft.event.trigger(n,null,e)}}),ft.fn.extend({trigger:function(t,e){return this.each(function(){ft.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return ft.event.trigger(t,e,i,!0)}}),ft.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){ft.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),ft.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),pt.focusin="onfocusin"in t,pt.focusin||ft.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){ft.event.simulate(e,t.target,ft.event.fix(t))};ft.event.special[e]={setup:function(){var n=this.ownerDocument||this,o=zt.access(n,e);o||n.addEventListener(t,i,!0),zt.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=zt.access(n,e)-1;o?zt.access(n,e,o):(n.removeEventListener(t,i,!0),zt.remove(n,e))}}});var we=t.location,Te=ft.now(),Ee=/\?/;ft.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||ft.error("Invalid XML: "+e),i};var Ce=/\[\]$/,Se=/\r?\n/g,Ae=/^(?:submit|button|image|reset|file)$/i,ke=/^(?:input|select|textarea|keygen)/i;ft.param=function(t,e){var i,n=[],o=function(t,e){var i=ft.isFunction(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!ft.isPlainObject(t))ft.each(t,function(){o(this.name,this.value)});else for(i in t)Z(i,t[i],e,o);return n.join("&")},ft.fn.extend({serialize:function(){return ft.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ft.prop(this,"elements");return t?ft.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ft(this).is(":disabled")&&ke.test(this.nodeName)&&!Ae.test(t)&&(this.checked||!Ht.test(t))}).map(function(t,e){var i=ft(this).val();return null==i?null:Array.isArray(i)?ft.map(i,function(t){return{name:e.name,value:t.replace(Se,"\r\n")}}):{name:e.name,value:i.replace(Se,"\r\n")}}).get()}});var Ie=/%20/g,Le=/#.*$/,De=/([?&])_=[^&]*/,Pe=/^(.*?):[ \t]*([^\r\n]*)$/gm,ze=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Me=/^(?:GET|HEAD)$/,Oe=/^\/\//,Re={},Ne={},je="*/".concat("*"),Fe=et.createElement("a");Fe.href=we.href,ft.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we.href,type:"GET",isLocal:ze.test(we.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ft.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Q(Q(t,ft.ajaxSettings),e):Q(ft.ajaxSettings,t)},ajaxPrefilter:X(Re),ajaxTransport:X(Ne),ajax:function(e,i){function n(e,i,n,s){var u,p,f,x,b,w=i;c||(c=!0,l&&t.clearTimeout(l),o=void 0,a=s||"",T.readyState=e>0?4:0,u=e>=200&&e<300||304===e,n&&(x=Y(d,T,n)),x=J(d,x,T,u),u?(d.ifModified&&((b=T.getResponseHeader("Last-Modified"))&&(ft.lastModified[r]=b),(b=T.getResponseHeader("etag"))&&(ft.etag[r]=b)),204===e||"HEAD"===d.type?w="nocontent":304===e?w="notmodified":(w=x.state,p=x.data,u=!(f=x.error))):(f=w,!e&&w||(w="error",e<0&&(e=0))),T.status=e,T.statusText=(i||w)+"",u?y.resolveWith(m,[p,w,T]):y.rejectWith(m,[T,w,f]),T.statusCode(_),_=void 0,h&&g.trigger(u?"ajaxSuccess":"ajaxError",[T,d,u?p:f]),v.fireWith(m,[T,w]),h&&(g.trigger("ajaxComplete",[T,d]),--ft.active||ft.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=void 0),i=i||{};var o,r,a,s,l,u,c,h,p,f,d=ft.ajaxSetup({},i),m=d.context||d,g=d.context&&(m.nodeType||m.jquery)?ft(m):ft.event,y=ft.Deferred(),v=ft.Callbacks("once memory"),_=d.statusCode||{},x={},b={},w="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Pe.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(t,e){return null==c&&(t=b[t.toLowerCase()]=b[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==c&&(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)T.always(t[T.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort:function(t){var e=t||w;return o&&o.abort(e),n(0,e),this}};if(y.promise(T),d.url=((e||d.url||we.href)+"").replace(Oe,we.protocol+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(kt)||[""],null==d.crossDomain){u=et.createElement("a");try{u.href=d.url,u.href=u.href,d.crossDomain=Fe.protocol+"//"+Fe.host!=u.protocol+"//"+u.host}catch(t){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ft.param(d.data,d.traditional)),K(Re,d,i,T),c)return T;(h=ft.event&&d.global)&&0==ft.active++&&ft.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Me.test(d.type),r=d.url.replace(Le,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Ie,"+")):(f=d.url.slice(r.length),d.data&&(r+=(Ee.test(r)?"&":"?")+d.data,delete d.data),!1===d.cache&&(r=r.replace(De,"$1"),f=(Ee.test(r)?"&":"?")+"_="+Te+++f),d.url=r+f),d.ifModified&&(ft.lastModified[r]&&T.setRequestHeader("If-Modified-Since",ft.lastModified[r]),ft.etag[r]&&T.setRequestHeader("If-None-Match",ft.etag[r])),(d.data&&d.hasContent&&!1!==d.contentType||i.contentType)&&T.setRequestHeader("Content-Type",d.contentType),T.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+je+"; q=0.01":""):d.accepts["*"]);for(p in d.headers)T.setRequestHeader(p,d.headers[p]);if(d.beforeSend&&(!1===d.beforeSend.call(m,T,d)||c))return T.abort();if(w="abort",v.add(d.complete),T.done(d.success),T.fail(d.error),o=K(Ne,d,i,T)){if(T.readyState=1,h&&g.trigger("ajaxSend",[T,d]),c)return T;d.async&&d.timeout>0&&(l=t.setTimeout(function(){T.abort("timeout")},d.timeout));try{c=!1,o.send(x,n)}catch(t){if(c)throw t;n(-1,t)}}else n(-1,"No Transport");return T},getJSON:function(t,e,i){return ft.get(t,e,i,"json")},getScript:function(t,e){return ft.get(t,void 0,e,"script")}}),ft.each(["get","post"],function(t,e){ft[e]=function(t,i,n,o){return ft.isFunction(i)&&(o=o||n,n=i,i=void 0),ft.ajax(ft.extend({url:t,type:e,dataType:o,data:i,success:n},ft.isPlainObject(t)&&t))}}),ft._evalUrl=function(t){return ft.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},ft.fn.extend({wrapAll:function(t){var e;return this[0]&&(ft.isFunction(t)&&(t=t.call(this[0])),e=ft(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return ft.isFunction(t)?this.each(function(e){ft(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ft(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=ft.isFunction(t);return this.each(function(i){ft(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){ft(this).replaceWith(this.childNodes)}),this}}),ft.expr.pseudos.hidden=function(t){return!ft.expr.pseudos.visible(t)},ft.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},ft.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Be={0:200,1223:204},Ve=ft.ajaxSettings.xhr();pt.cors=!!Ve&&"withCredentials"in Ve,pt.ajax=Ve=!!Ve,ft.ajaxTransport(function(e){var i,n;if(pt.cors||Ve&&!e.crossDomain)return{send:function(o,r){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(a in o)s.setRequestHeader(a,o[a]);i=function(t){return function(){i&&(i=n=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r(Be[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=i(),n=s.onerror=i("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout(function(){i&&n()})},i=i("abort");try{s.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}}),ft.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),ft.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return ft.globalEval(t),t}}}),ft.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),ft.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,o){e=ft("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),et.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ue=[],He=/(=)\?(?=&|$)|\?\?/;ft.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ue.pop()||ft.expando+"_"+Te++;return this[t]=!0,t}}),ft.ajaxPrefilter("json jsonp",function(e,i,n){var o,r,a,s=!1!==e.jsonp&&(He.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&He.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=ft.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(He,"$1"+o):!1!==e.jsonp&&(e.url+=(Ee.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||ft.error(o+" was not called"),a[0]},e.dataTypes[0]="json",r=t[o],t[o]=function(){a=arguments},n.always(function(){void 0===r?ft(t).removeProp(o):t[o]=r,e[o]&&(e.jsonpCallback=i.jsonpCallback,Ue.push(o)),a&&ft.isFunction(r)&&r(a[0]),a=r=void 0}),"script"}),pt.createHTMLDocument=function(){var t=et.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),ft.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var n,o,r;return e||(pt.createHTMLDocument?((n=(e=et.implementation.createHTMLDocument("")).createElement("base")).href=et.location.href,e.head.appendChild(n)):e=et),o=wt.exec(t),r=!i&&[],o?[e.createElement(o[1])]:(o=x([t],e,r),r&&r.length&&ft(r).remove(),ft.merge([],o.childNodes))},ft.fn.load=function(t,e,i){var n,o,r,a=this,s=t.indexOf(" ");return s>-1&&(n=$(t.slice(s)),t=t.slice(0,s)),ft.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&ft.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){r=arguments,a.html(n?ft("<div>").append(ft.parseHTML(t)).find(n):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,r||[t.responseText,e,t])})}),this},ft.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ft.fn[e]=function(t){return this.on(e,t)}}),ft.expr.pseudos.animated=function(t){return ft.grep(ft.timers,function(e){return t===e.elem}).length},ft.offset={setOffset:function(t,e,i){var n,o,r,a,s,l,u=ft.css(t,"position"),c=ft(t),h={};"static"===u&&(t.style.position="relative"),s=c.offset(),r=ft.css(t,"top"),l=ft.css(t,"left"),("absolute"===u||"fixed"===u)&&(r+l).indexOf("auto")>-1?(a=(n=c.position()).top,o=n.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),ft.isFunction(e)&&(e=e.call(t,i,ft.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+o),"using"in e?e.using.call(t,h):c.css(h)}},ft.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ft.offset.setOffset(this,t,e)});var e,i,n,o,r=this[0];if(r)return r.getClientRects().length?(n=r.getBoundingClientRect(),e=r.ownerDocument,i=e.documentElement,o=e.defaultView,{top:n.top+o.pageYOffset-i.clientTop,left:n.left+o.pageXOffset-i.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===ft.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),o(t[0],"html")||(n=t.offset()),n={top:n.top+ft.css(t[0],"borderTopWidth",!0),left:n.left+ft.css(t[0],"borderLeftWidth",!0)}),{top:e.top-n.top-ft.css(i,"marginTop",!0),left:e.left-n.left-ft.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===ft.css(t,"position");)t=t.offsetParent;return t||Zt})}}),ft.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;ft.fn[t]=function(n){return Dt(this,function(t,n,o){var r;if(ft.isWindow(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===o)return r?r[e]:t[n];r?r.scrollTo(i?r.pageXOffset:o,i?o:r.pageYOffset):t[n]=o},t,n,arguments.length)}}),ft.each(["top","left"],function(t,e){ft.cssHooks[e]=z(pt.pixelPosition,function(t,i){if(i)return i=P(t,e),oe.test(i)?ft(t).position()[e]+"px":i})}),ft.each({Height:"height",Width:"width"},function(t,e){ft.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){ft.fn[n]=function(o,r){var a=arguments.length&&(i||"boolean"!=typeof o),s=i||(!0===o||!0===r?"margin":"border");return Dt(this,function(e,i,o){var r;return ft.isWindow(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===o?ft.css(e,i,s):ft.style(e,i,o,s)},e,a?o:void 0,a)}})}),ft.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),ft.holdReady=function(t){t?ft.readyWait++:ft.ready(!0)},ft.isArray=Array.isArray,ft.parseJSON=JSON.parse,ft.nodeName=o,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ft});var qe=t.jQuery,We=t.$;return ft.noConflict=function(e){return t.$===ft&&(t.$=We),e&&t.jQuery===ft&&(t.jQuery=qe),ft},e||(t.jQuery=t.$=ft),ft}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Popper=e()}(this,function(){"use strict";function t(t){var e={};return t&&"[object Function]"===e.toString.call(t)}function e(t,e){if(1!==t.nodeType)return[];var i=getComputedStyle(t,null);return e?i[e]:i}function i(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function n(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var o=e(t),r=o.overflow,a=o.overflowX,s=o.overflowY;return/(auto|scroll)/.test(r+s+a)?t:n(i(t))}function o(t){var i=t&&t.offsetParent,n=i&&i.nodeName;return n&&"BODY"!==n&&"HTML"!==n?-1!==["TD","TABLE"].indexOf(i.nodeName)&&"static"===e(i,"position")?o(i):i:t?t.ownerDocument.documentElement:document.documentElement}function r(t){var e=t.nodeName;return"BODY"!==e&&("HTML"===e||o(t.firstElementChild)===t)}function a(t){return null!==t.parentNode?a(t.parentNode):t}function s(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return document.documentElement;var i=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,n=i?t:e,l=i?e:t,u=document.createRange();u.setStart(n,0),u.setEnd(l,0);var c=u.commonAncestorContainer;if(t!==c&&e!==c||n.contains(l))return r(c)?c:o(c);var h=a(t);return h.host?s(h.host,e):s(t,a(e).host)}function l(t){var e="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",i=t.nodeName;if("BODY"===i||"HTML"===i){var n=t.ownerDocument.documentElement;return(t.ownerDocument.scrollingElement||n)[e]}return t[e]}function u(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=l(e,"top"),o=l(e,"left"),r=i?-1:1;return t.top+=n*r,t.bottom+=n*r,t.left+=o*r,t.right+=o*r,t}function c(t,e){var i="x"===e?"Left":"Top",n="Left"===i?"Right":"Bottom";return parseFloat(t["border"+i+"Width"],10)+parseFloat(t["border"+n+"Width"],10)}function h(t,e,i,n){return Math.max(e["offset"+t],e["scroll"+t],i["client"+t],i["offset"+t],i["scroll"+t],Y()?i["offset"+t]+n["margin"+("Height"===t?"Top":"Left")]+n["margin"+("Height"===t?"Bottom":"Right")]:0)}function p(){var t=document.body,e=document.documentElement,i=Y()&&getComputedStyle(e);return{height:h("Height",t,e,i),width:h("Width",t,e,i)}}function f(t){return it({},t,{right:t.left+t.width,bottom:t.top+t.height})}function d(t){var i={};if(Y())try{i=t.getBoundingClientRect();var n=l(t,"top"),o=l(t,"left");i.top+=n,i.left+=o,i.bottom+=n,i.right+=o}catch(t){}else i=t.getBoundingClientRect();var r={left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top},a="HTML"===t.nodeName?p():{},s=a.width||t.clientWidth||r.right-r.left,u=a.height||t.clientHeight||r.bottom-r.top,h=t.offsetWidth-s,d=t.offsetHeight-u;if(h||d){var m=e(t);h-=c(m,"x"),d-=c(m,"y"),r.width-=h,r.height-=d}return f(r)}function m(t,i){var o=Y(),r="HTML"===i.nodeName,a=d(t),s=d(i),l=n(t),c=e(i),h=parseFloat(c.borderTopWidth,10),p=parseFloat(c.borderLeftWidth,10),m=f({top:a.top-s.top-h,left:a.left-s.left-p,width:a.width,height:a.height});if(m.marginTop=0,m.marginLeft=0,!o&&r){var g=parseFloat(c.marginTop,10),y=parseFloat(c.marginLeft,10);m.top-=h-g,m.bottom-=h-g,m.left-=p-y,m.right-=p-y,m.marginTop=g,m.marginLeft=y}return(o?i.contains(l):i===l&&"BODY"!==l.nodeName)&&(m=u(m,i)),m}function g(t){var e=t.ownerDocument.documentElement,i=m(t,e),n=Math.max(e.clientWidth,window.innerWidth||0),o=Math.max(e.clientHeight,window.innerHeight||0),r=l(e),a=l(e,"left");return f({top:r-i.top+i.marginTop,left:a-i.left+i.marginLeft,width:n,height:o})}function y(t){var n=t.nodeName;return"BODY"!==n&&"HTML"!==n&&("fixed"===e(t,"position")||y(i(t)))}function v(t,e,o,r){var a={top:0,left:0},l=s(t,e);if("viewport"===r)a=g(l);else{var u=void 0;"scrollParent"===r?"BODY"===(u=n(i(e))).nodeName&&(u=t.ownerDocument.documentElement):u="window"===r?t.ownerDocument.documentElement:r;var c=m(u,l);if("HTML"!==u.nodeName||y(l))a=c;else{var h=p(),f=h.height,d=h.width;a.top+=c.top-c.marginTop,a.bottom=f+c.top,a.left+=c.left-c.marginLeft,a.right=d+c.left}}return a.left+=o,a.top+=o,a.right-=o,a.bottom-=o,a}function _(t){return t.width*t.height}function x(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===t.indexOf("auto"))return t;var a=v(i,n,r,o),s={top:{width:a.width,height:e.top-a.top},right:{width:a.right-e.right,height:a.height},bottom:{width:a.width,height:a.bottom-e.bottom},left:{width:e.left-a.left,height:a.height}},l=Object.keys(s).map(function(t){return it({key:t},s[t],{area:_(s[t])})}).sort(function(t,e){return e.area-t.area}),u=l.filter(function(t){var e=t.width,n=t.height;return e>=i.clientWidth&&n>=i.clientHeight}),c=u.length>0?u[0].key:l[0].key,h=t.split("-")[1];return c+(h?"-"+h:"")}function b(t,e,i){return m(i,s(e,i))}function w(t){var e=getComputedStyle(t),i=parseFloat(e.marginTop)+parseFloat(e.marginBottom),n=parseFloat(e.marginLeft)+parseFloat(e.marginRight);return{width:t.offsetWidth+n,height:t.offsetHeight+i}}function T(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function E(t,e,i){i=i.split("-")[0];var n=w(t),o={width:n.width,height:n.height},r=-1!==["right","left"].indexOf(i),a=r?"top":"left",s=r?"left":"top",l=r?"height":"width",u=r?"width":"height";return o[a]=e[a]+e[l]/2-n[l]/2,o[s]=i===s?e[s]-n[u]:e[T(s)],o}function C(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function S(t,e,i){if(Array.prototype.findIndex)return t.findIndex(function(t){return t[e]===i});var n=C(t,function(t){return t[e]===i});return t.indexOf(n)}function A(e,i,n){return(void 0===n?e:e.slice(0,S(e,"name",n))).forEach(function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=e.function||e.fn;e.enabled&&t(n)&&(i.offsets.popper=f(i.offsets.popper),i.offsets.reference=f(i.offsets.reference),i=n(i,e))}),i}function k(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=b(this.state,this.popper,this.reference),t.placement=x(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.offsets.popper=E(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position="absolute",t=A(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function I(t,e){return t.some(function(t){var i=t.name;return t.enabled&&i===e})}function L(t){for(var e=[!1,"ms","Webkit","Moz","O"],i=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<e.length-1;n++){var o=e[n],r=o?""+o+i:t;if(void 0!==document.body.style[r])return r}return null}function D(){return this.state.isDestroyed=!0,I(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[L("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function P(t){var e=t.ownerDocument;return e?e.defaultView:window}function z(t,e,i,o){var r="BODY"===t.nodeName,a=r?t.ownerDocument.defaultView:t;a.addEventListener(e,i,{passive:!0}),r||z(n(a.parentNode),e,i,o),o.push(a)}function M(t,e,i,o){i.updateBound=o,P(t).addEventListener("resize",i.updateBound,{passive:!0});var r=n(t);return z(r,"scroll",i.updateBound,i.scrollParents),i.scrollElement=r,i.eventsEnabled=!0,i}function O(){this.state.eventsEnabled||(this.state=M(this.reference,this.options,this.state,this.scheduleUpdate))}function R(t,e){return P(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}function N(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=R(this.reference,this.state))}function j(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function F(t,e){Object.keys(e).forEach(function(i){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&j(e[i])&&(n="px"),t.style[i]=e[i]+n})}function B(t,e){Object.keys(e).forEach(function(i){!1!==e[i]?t.setAttribute(i,e[i]):t.removeAttribute(i)})}function V(t,e,i){var n=C(t,function(t){return t.name===e}),o=!!n&&t.some(function(t){return t.name===i&&t.enabled&&t.order<n.order});if(!o){var r="`"+e+"`",a="`"+i+"`";console.warn(a+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return o}function U(t){return"end"===t?"start":"start"===t?"end":t}function H(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=ot.indexOf(t),n=ot.slice(i+1).concat(ot.slice(0,i));return e?n.reverse():n}function q(t,e,i,n){var o=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+o[1],a=o[2];if(!r)return t;if(0===a.indexOf("%")){var s=void 0;switch(a){case"%p":s=i;break;case"%":case"%r":default:s=n}return f(s)[e]/100*r}if("vh"===a||"vw"===a){return("vh"===a?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*r}return r}function W(t,e,i,n){var o=[0,0],r=-1!==["right","left"].indexOf(n),a=t.split(/(\+|\-)/).map(function(t){return t.trim()}),s=a.indexOf(C(a,function(t){return-1!==t.search(/,|\s/)}));a[s]&&-1===a[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=-1!==s?[a.slice(0,s).concat([a[s].split(l)[0]]),[a[s].split(l)[1]].concat(a.slice(s+1))]:[a];return(u=u.map(function(t,n){var o=(1===n?!r:r)?"height":"width",a=!1;return t.reduce(function(t,e){return""===t[t.length-1]&&-1!==["+","-"].indexOf(e)?(t[t.length-1]=e,a=!0,t):a?(t[t.length-1]+=e,a=!1,t):t.concat(e)},[]).map(function(t){return q(t,o,e,i)})})).forEach(function(t,e){t.forEach(function(i,n){j(i)&&(o[e]+=i*("-"===t[n-1]?-1:1))})}),o}for(var $="undefined"!=typeof window&&"undefined"!=typeof document,G=["Edge","Trident","Firefox"],Z=0,X=0;X<G.length;X+=1)if($&&navigator.userAgent.indexOf(G[X])>=0){Z=1;break}var K=$&&window.Promise?function(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then(function(){e=!1,t()}))}}:function(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},Z))}},Q=void 0,Y=function(){return void 0===Q&&(Q=-1!==navigator.appVersion.indexOf("MSIE 10")),Q},J=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},tt=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),et=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},it=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},nt=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ot=nt.slice(3),rt={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},at={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(t){var e=t.placement,i=e.split("-")[0],n=e.split("-")[1];if(n){var o=t.offsets,r=o.reference,a=o.popper,s=-1!==["bottom","top"].indexOf(i),l=s?"left":"top",u=s?"width":"height",c={start:et({},l,r[l]),end:et({},l,r[l]+r[u]-a[u])};t.offsets.popper=it({},a,c[n])}return t}},offset:{order:200,enabled:!0,fn:function(t,e){var i=e.offset,n=t.placement,o=t.offsets,r=o.popper,a=o.reference,s=n.split("-")[0],l=void 0;return l=j(+i)?[+i,0]:W(i,r,a,s),"left"===s?(r.top+=l[0],r.left-=l[1]):"right"===s?(r.top+=l[0],r.left+=l[1]):"top"===s?(r.left+=l[0],r.top-=l[1]):"bottom"===s&&(r.left+=l[0],r.top+=l[1]),t.popper=r,t},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(t,e){var i=e.boundariesElement||o(t.instance.popper);t.instance.reference===i&&(i=o(i));var n=v(t.instance.popper,t.instance.reference,e.padding,i);e.boundaries=n;var r=e.priority,a=t.offsets.popper,s={primary:function(t){var i=a[t];return a[t]<n[t]&&!e.escapeWithReference&&(i=Math.max(a[t],n[t])),et({},t,i)},secondary:function(t){var i="right"===t?"left":"top",o=a[i];return a[t]>n[t]&&!e.escapeWithReference&&(o=Math.min(a[i],n[t]-("right"===t?a.width:a.height))),et({},i,o)}};return r.forEach(function(t){var e=-1!==["left","top"].indexOf(t)?"primary":"secondary";a=it({},a,s[e](t))}),t.offsets.popper=a,t},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(t){var e=t.offsets,i=e.popper,n=e.reference,o=t.placement.split("-")[0],r=Math.floor,a=-1!==["top","bottom"].indexOf(o),s=a?"right":"bottom",l=a?"left":"top",u=a?"width":"height";return i[s]<r(n[l])&&(t.offsets.popper[l]=r(n[l])-i[u]),i[l]>r(n[s])&&(t.offsets.popper[l]=r(n[s])),t}},arrow:{order:500,enabled:!0,fn:function(t,i){var n;if(!V(t.instance.modifiers,"arrow","keepTogether"))return t;var o=i.element;if("string"==typeof o){if(!(o=t.instance.popper.querySelector(o)))return t}else if(!t.instance.popper.contains(o))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var r=t.placement.split("-")[0],a=t.offsets,s=a.popper,l=a.reference,u=-1!==["left","right"].indexOf(r),c=u?"height":"width",h=u?"Top":"Left",p=h.toLowerCase(),d=u?"left":"top",m=u?"bottom":"right",g=w(o)[c];l[m]-g<s[p]&&(t.offsets.popper[p]-=s[p]-(l[m]-g)),l[p]+g>s[m]&&(t.offsets.popper[p]+=l[p]+g-s[m]),t.offsets.popper=f(t.offsets.popper);var y=l[p]+l[c]/2-g/2,v=e(t.instance.popper),_=parseFloat(v["margin"+h],10),x=parseFloat(v["border"+h+"Width"],10),b=y-t.offsets.popper[p]-_-x;return b=Math.max(Math.min(s[c]-g,b),0),t.arrowElement=o,t.offsets.arrow=(n={},et(n,p,Math.round(b)),et(n,d,""),n),t},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(t,e){if(I(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var i=v(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement),n=t.placement.split("-")[0],o=T(n),r=t.placement.split("-")[1]||"",a=[];switch(e.behavior){case rt.FLIP:a=[n,o];break;case rt.CLOCKWISE:a=H(n);break;case rt.COUNTERCLOCKWISE:a=H(n,!0);break;default:a=e.behavior}return a.forEach(function(s,l){if(n!==s||a.length===l+1)return t;n=t.placement.split("-")[0],o=T(n);var u=t.offsets.popper,c=t.offsets.reference,h=Math.floor,p="left"===n&&h(u.right)>h(c.left)||"right"===n&&h(u.left)<h(c.right)||"top"===n&&h(u.bottom)>h(c.top)||"bottom"===n&&h(u.top)<h(c.bottom),f=h(u.left)<h(i.left),d=h(u.right)>h(i.right),m=h(u.top)<h(i.top),g=h(u.bottom)>h(i.bottom),y="left"===n&&f||"right"===n&&d||"top"===n&&m||"bottom"===n&&g,v=-1!==["top","bottom"].indexOf(n),_=!!e.flipVariations&&(v&&"start"===r&&f||v&&"end"===r&&d||!v&&"start"===r&&m||!v&&"end"===r&&g);(p||y||_)&&(t.flipped=!0,(p||y)&&(n=a[l+1]),_&&(r=U(r)),t.placement=n+(r?"-"+r:""),t.offsets.popper=it({},t.offsets.popper,E(t.instance.popper,t.offsets.reference,t.placement)),t=A(t.instance.modifiers,t,"flip"))}),t},behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:function(t){var e=t.placement,i=e.split("-")[0],n=t.offsets,o=n.popper,r=n.reference,a=-1!==["left","right"].indexOf(i),s=-1===["top","left"].indexOf(i);return o[a?"left":"top"]=r[i]-(s?o[a?"width":"height"]:0),t.placement=T(e),t.offsets.popper=f(o),t}},hide:{order:800,enabled:!0,fn:function(t){if(!V(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,i=C(t.instance.modifiers,function(t){return"preventOverflow"===t.name}).boundaries;if(e.bottom<i.top||e.left>i.right||e.top>i.bottom||e.right<i.left){if(!0===t.hide)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(!1===t.hide)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}},computeStyle:{order:850,enabled:!0,fn:function(t,e){var i=e.x,n=e.y,r=t.offsets.popper,a=C(t.instance.modifiers,function(t){return"applyStyle"===t.name}).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s=void 0!==a?a:e.gpuAcceleration,l=d(o(t.instance.popper)),u={position:r.position},c={left:Math.floor(r.left),top:Math.floor(r.top),bottom:Math.floor(r.bottom),right:Math.floor(r.right)},h="bottom"===i?"top":"bottom",p="right"===n?"left":"right",f=L("transform"),m=void 0,g=void 0;if(g="bottom"===h?-l.height+c.bottom:c.top,m="right"===p?-l.width+c.right:c.left,s&&f)u[f]="translate3d("+m+"px, "+g+"px, 0)",u[h]=0,u[p]=0,u.willChange="transform";else{var y="bottom"===h?-1:1,v="right"===p?-1:1;u[h]=g*y,u[p]=m*v,u.willChange=h+", "+p}var _={"x-placement":t.placement};return t.attributes=it({},_,t.attributes),t.styles=it({},u,t.styles),t.arrowStyles=it({},t.offsets.arrow,t.arrowStyles),t},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(t){return F(t.instance.popper,t.styles),B(t.instance.popper,t.attributes),t.arrowElement&&Object.keys(t.arrowStyles).length&&F(t.arrowElement,t.arrowStyles),t},onLoad:function(t,e,i,n,o){var r=b(o,e,t),a=x(i.placement,r,e,t,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return e.setAttribute("x-placement",a),F(e,{position:"absolute"}),i},gpuAcceleration:void 0}}},st=function(){function e(i,n){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};J(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(o.update)},this.update=K(this.update.bind(this)),this.options=it({},e.Defaults,r),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=i&&i.jquery?i[0]:i,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(it({},e.Defaults.modifiers,r.modifiers)).forEach(function(t){o.options.modifiers[t]=it({},e.Defaults.modifiers[t]||{},r.modifiers?r.modifiers[t]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(t){return it({name:t},o.options.modifiers[t])}).sort(function(t,e){return t.order-e.order}),this.modifiers.forEach(function(e){e.enabled&&t(e.onLoad)&&e.onLoad(o.reference,o.popper,o.options,e,o.state)}),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return tt(e,[{key:"update",value:function(){return k.call(this)}},{key:"destroy",value:function(){return D.call(this)}},{key:"enableEventListeners",value:function(){return O.call(this)}},{key:"disableEventListeners",value:function(){return N.call(this)}}]),e}();return st.Utils=("undefined"!=typeof window?window:global).PopperUtils,st.placements=nt,st.Defaults=at,st});var bootstrap=function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e=e&&e.hasOwnProperty("default")?e.default:e,i=i&&i.hasOwnProperty("default")?i.default:i;var o=function(){function t(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function i(){return{bindType:r.end,delegateType:r.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}}function n(){if(window.QUnit)return!1;var t=document.createElement("bootstrap");for(var e in a)if(void 0!==t.style[e])return{end:a[e]};return!1}function o(t){var i=this,n=!1;return e(this).one(s.TRANSITION_END,function(){n=!0}),setTimeout(function(){n||s.triggerTransitionEnd(i)},t),this}var r=!1,a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},s={TRANSITION_END:"bsTransitionEnd",getUID:function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},getSelectorFromElement:function(t){var i=t.getAttribute("data-target");i&&"#"!==i||(i=t.getAttribute("href")||"");try{return e(document).find(i).length>0?i:null}catch(t){return null}},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(t){e(t).trigger(r.end)},supportsTransitionEnd:function(){return Boolean(r)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(e,i,n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o],a=i[o],l=a&&s.isElement(a)?"element":t(a);if(!new RegExp(r).test(l))throw new Error(e.toUpperCase()+': Option "'+o+'" provided type "'+l+'" but expected type "'+r+'".')}}};return r=n(),e.fn.emulateTransitionEnd=o,s.supportsTransitionEnd()&&(e.event.special[s.TRANSITION_END]=i()),s}(),r=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t},a=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e},s=function(){var t="alert",i=e.fn[t],n={DISMISS:'[data-dismiss="alert"]'},a={CLOSE:"close.bs.alert",CLOSED:"closed.bs.alert",CLICK_DATA_API:"click.bs.alert.data-api"},s={ALERT:"alert",FADE:"fade",SHOW:"show"},l=function(){function t(t){this._element=t}var i=t.prototype;return i.close=function(t){t=t||this._element;var e=this._getRootElement(t);this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},i.dispose=function(){e.removeData(this._element,"bs.alert"),this._element=null},i._getRootElement=function(t){var i=o.getSelectorFromElement(t),n=!1;return i&&(n=e(i)[0]),n||(n=e(t).closest("."+s.ALERT)[0]),n},i._triggerCloseEvent=function(t){var i=e.Event(a.CLOSE);return e(t).trigger(i),i},i._removeElement=function(t){var i=this;e(t).removeClass(s.SHOW),o.supportsTransitionEnd()&&e(t).hasClass(s.FADE)?e(t).one(o.TRANSITION_END,function(e){return i._destroyElement(t,e)}).emulateTransitionEnd(150):this._destroyElement(t)},i._destroyElement=function(t){e(t).detach().trigger(a.CLOSED).remove()},t._jQueryInterface=function(i){return this.each(function(){var n=e(this),o=n.data("bs.alert");o||(o=new t(this),n.data("bs.alert",o)),"close"===i&&o[i](this)})},t._handleDismiss=function(t){return function(e){e&&e.preventDefault(),t.close(this)}},r(t,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}}]),t}();return e(document).on(a.CLICK_DATA_API,n.DISMISS,l._handleDismiss(new l)),e.fn[t]=l._jQueryInterface,e.fn[t].Constructor=l,e.fn[t].noConflict=function(){return e.fn[t]=i,l._jQueryInterface},l}(),l=function(){var t="button",i=e.fn[t],n={ACTIVE:"active",BUTTON:"btn",FOCUS:"focus"},o={DATA_TOGGLE_CARROT:'[data-toggle^="button"]',DATA_TOGGLE:'[data-toggle="buttons"]',INPUT:"input",ACTIVE:".active",BUTTON:".btn"},a={CLICK_DATA_API:"click.bs.button.data-api",FOCUS_BLUR_DATA_API:"focus.bs.button.data-api blur.bs.button.data-api"},s=function(){function t(t){this._element=t}var i=t.prototype;return i.toggle=function(){var t=!0,i=!0,r=e(this._element).closest(o.DATA_TOGGLE)[0];if(r){var a=e(this._element).find(o.INPUT)[0];if(a){if("radio"===a.type)if(a.checked&&e(this._element).hasClass(n.ACTIVE))t=!1;else{var s=e(r).find(o.ACTIVE)[0];s&&e(s).removeClass(n.ACTIVE)}if(t){if(a.hasAttribute("disabled")||r.hasAttribute("disabled")||a.classList.contains("disabled")||r.classList.contains("disabled"))return;a.checked=!e(this._element).hasClass(n.ACTIVE),e(a).trigger("change")}a.focus(),i=!1}}i&&this._element.setAttribute("aria-pressed",!e(this._element).hasClass(n.ACTIVE)),t&&e(this._element).toggleClass(n.ACTIVE)},i.dispose=function(){e.removeData(this._element,"bs.button"),this._element=null},t._jQueryInterface=function(i){return this.each(function(){var n=e(this).data("bs.button");n||(n=new t(this),e(this).data("bs.button",n)),"toggle"===i&&n[i]()})},r(t,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}}]),t}();return e(document).on(a.CLICK_DATA_API,o.DATA_TOGGLE_CARROT,function(t){t.preventDefault();var i=t.target;e(i).hasClass(n.BUTTON)||(i=e(i).closest(o.BUTTON)),s._jQueryInterface.call(e(i),"toggle")}).on(a.FOCUS_BLUR_DATA_API,o.DATA_TOGGLE_CARROT,function(t){var i=e(t.target).closest(o.BUTTON)[0];e(i).toggleClass(n.FOCUS,/^focus(in)?$/.test(t.type))}),e.fn[t]=s._jQueryInterface,e.fn[t].Constructor=s,e.fn[t].noConflict=function(){return e.fn[t]=i,s._jQueryInterface},s}(),u=function(){var t="carousel",i="bs.carousel",n="."+i,a=e.fn[t],s={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0},l={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean"},u={NEXT:"next",PREV:"prev",LEFT:"left",RIGHT:"right"},c={SLIDE:"slide"+n,SLID:"slid"+n,KEYDOWN:"keydown"+n,MOUSEENTER:"mouseenter"+n,MOUSELEAVE:"mouseleave"+n,TOUCHEND:"touchend"+n,LOAD_DATA_API:"load.bs.carousel.data-api",CLICK_DATA_API:"click.bs.carousel.data-api"},h={CAROUSEL:"carousel",ACTIVE:"active",SLIDE:"slide",RIGHT:"carousel-item-right",LEFT:"carousel-item-left",NEXT:"carousel-item-next",PREV:"carousel-item-prev",ITEM:"carousel-item"},p={ACTIVE:".active",ACTIVE_ITEM:".active.carousel-item",ITEM:".carousel-item",NEXT_PREV:".carousel-item-next, .carousel-item-prev",INDICATORS:".carousel-indicators",DATA_SLIDE:"[data-slide], [data-slide-to]",DATA_RIDE:'[data-ride="carousel"]'},f=function(){function a(t,i){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this._config=this._getConfig(i),this._element=e(t)[0],this._indicatorsElement=e(this._element).find(p.INDICATORS)[0],this._addEventListeners()}var f=a.prototype;return f.next=function(){this._isSliding||this._slide(u.NEXT)},f.nextWhenVisible=function(){!document.hidden&&e(this._element).is(":visible")&&"hidden"!==e(this._element).css("visibility")&&this.next()},f.prev=function(){this._isSliding||this._slide(u.PREV)},f.pause=function(t){t||(this._isPaused=!0),e(this._element).find(p.NEXT_PREV)[0]&&o.supportsTransitionEnd()&&(o.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},f.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},f.to=function(t){var i=this;this._activeElement=e(this._element).find(p.ACTIVE_ITEM)[0];var n=this._getItemIndex(this._activeElement);if(!(t>this._items.length-1||t<0))if(this._isSliding)e(this._element).one(c.SLID,function(){return i.to(t)});else{if(n===t)return this.pause(),void this.cycle();var o=t>n?u.NEXT:u.PREV;this._slide(o,this._items[t])}},f.dispose=function(){e(this._element).off(n),e.removeData(this._element,i),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},f._getConfig=function(i){return i=e.extend({},s,i),o.typeCheckConfig(t,i,l),i},f._addEventListeners=function(){var t=this;this._config.keyboard&&e(this._element).on(c.KEYDOWN,function(e){return t._keydown(e)}),"hover"===this._config.pause&&(e(this._element).on(c.MOUSEENTER,function(e){return t.pause(e)}).on(c.MOUSELEAVE,function(e){return t.cycle(e)}),"ontouchstart"in document.documentElement&&e(this._element).on(c.TOUCHEND,function(){t.pause(),t.touchTimeout&&clearTimeout(t.touchTimeout),t.touchTimeout=setTimeout(function(e){return t.cycle(e)},500+t._config.interval)}))},f._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next();break;default:return}},f._getItemIndex=function(t){return this._items=e.makeArray(e(t).parent().find(p.ITEM)),this._items.indexOf(t)},f._getItemByDirection=function(t,e){var i=t===u.NEXT,n=t===u.PREV,o=this._getItemIndex(e),r=this._items.length-1;if((n&&0===o||i&&o===r)&&!this._config.wrap)return e;var a=(o+(t===u.PREV?-1:1))%this._items.length;return-1===a?this._items[this._items.length-1]:this._items[a]},f._triggerSlideEvent=function(t,i){var n=this._getItemIndex(t),o=this._getItemIndex(e(this._element).find(p.ACTIVE_ITEM)[0]),r=e.Event(c.SLIDE,{relatedTarget:t,direction:i,from:o,to:n});return e(this._element).trigger(r),r},f._setActiveIndicatorElement=function(t){if(this._indicatorsElement){e(this._indicatorsElement).find(p.ACTIVE).removeClass(h.ACTIVE);var i=this._indicatorsElement.children[this._getItemIndex(t)];i&&e(i).addClass(h.ACTIVE)}},f._slide=function(t,i){var n,r,a,s=this,l=e(this._element).find(p.ACTIVE_ITEM)[0],f=this._getItemIndex(l),d=i||l&&this._getItemByDirection(t,l),m=this._getItemIndex(d),g=Boolean(this._interval);if(t===u.NEXT?(n=h.LEFT,r=h.NEXT,a=u.LEFT):(n=h.RIGHT,r=h.PREV,a=u.RIGHT),d&&e(d).hasClass(h.ACTIVE))this._isSliding=!1;else if(!this._triggerSlideEvent(d,a).isDefaultPrevented()&&l&&d){this._isSliding=!0,g&&this.pause(),this._setActiveIndicatorElement(d);var y=e.Event(c.SLID,{relatedTarget:d,direction:a,from:f,to:m});o.supportsTransitionEnd()&&e(this._element).hasClass(h.SLIDE)?(e(d).addClass(r),o.reflow(d),e(l).addClass(n),e(d).addClass(n),e(l).one(o.TRANSITION_END,function(){e(d).removeClass(n+" "+r).addClass(h.ACTIVE),e(l).removeClass(h.ACTIVE+" "+r+" "+n),s._isSliding=!1,setTimeout(function(){return e(s._element).trigger(y)},0)}).emulateTransitionEnd(600)):(e(l).removeClass(h.ACTIVE),e(d).addClass(h.ACTIVE),this._isSliding=!1,e(this._element).trigger(y)),g&&this.cycle()}},a._jQueryInterface=function(t){return this.each(function(){var n=e(this).data(i),o=e.extend({},s,e(this).data());"object"==typeof t&&e.extend(o,t);var r="string"==typeof t?t:o.slide;if(n||(n=new a(this,o),e(this).data(i,n)),"number"==typeof t)n.to(t);else if("string"==typeof r){if(void 0===n[r])throw new Error('No method named "'+r+'"');n[r]()}else o.interval&&(n.pause(),n.cycle())})},a._dataApiClickHandler=function(t){var n=o.getSelectorFromElement(this);if(n){var r=e(n)[0];if(r&&e(r).hasClass(h.CAROUSEL)){var s=e.extend({},e(r).data(),e(this).data()),l=this.getAttribute("data-slide-to");l&&(s.interval=!1),a._jQueryInterface.call(e(r),s),l&&e(r).data(i).to(l),t.preventDefault()}}},r(a,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return s}}]),a}();return e(document).on(c.CLICK_DATA_API,p.DATA_SLIDE,f._dataApiClickHandler),e(window).on(c.LOAD_DATA_API,function(){e(p.DATA_RIDE).each(function(){var t=e(this);f._jQueryInterface.call(t,t.data())})}),e.fn[t]=f._jQueryInterface,e.fn[t].Constructor=f,e.fn[t].noConflict=function(){return e.fn[t]=a,f._jQueryInterface},f}(),c=function(){var t="collapse",i="bs.collapse",n=e.fn[t],a={toggle:!0,parent:""},s={toggle:"boolean",parent:"(string|element)"},l={SHOW:"show.bs.collapse",SHOWN:"shown.bs.collapse",HIDE:"hide.bs.collapse",HIDDEN:"hidden.bs.collapse",CLICK_DATA_API:"click.bs.collapse.data-api"},u={SHOW:"show",COLLAPSE:"collapse",COLLAPSING:"collapsing",COLLAPSED:"collapsed"},c={WIDTH:"width",HEIGHT:"height"},h={ACTIVES:".show, .collapsing",DATA_TOGGLE:'[data-toggle="collapse"]'},p=function(){function n(t,i){this._isTransitioning=!1,this._element=t,this._config=this._getConfig(i),this._triggerArray=e.makeArray(e('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'));for(var n=e(h.DATA_TOGGLE),r=0;r<n.length;r++){var a=n[r],s=o.getSelectorFromElement(a);null!==s&&e(s).filter(t).length>0&&this._triggerArray.push(a)}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var p=n.prototype;return p.toggle=function(){e(this._element).hasClass(u.SHOW)?this.hide():this.show()},p.show=function(){var t=this;if(!this._isTransitioning&&!e(this._element).hasClass(u.SHOW)){var r,a;if(this._parent&&((r=e.makeArray(e(this._parent).children().children(h.ACTIVES))).length||(r=null)),!(r&&(a=e(r).data(i))&&a._isTransitioning)){var s=e.Event(l.SHOW);if(e(this._element).trigger(s),!s.isDefaultPrevented()){r&&(n._jQueryInterface.call(e(r),"hide"),a||e(r).data(i,null));var c=this._getDimension();e(this._element).removeClass(u.COLLAPSE).addClass(u.COLLAPSING),this._element.style[c]=0,this._triggerArray.length&&e(this._triggerArray).removeClass(u.COLLAPSED).attr("aria-expanded",!0),this.setTransitioning(!0);var p=function(){e(t._element).removeClass(u.COLLAPSING).addClass(u.COLLAPSE).addClass(u.SHOW),t._element.style[c]="",t.setTransitioning(!1),e(t._element).trigger(l.SHOWN)};if(o.supportsTransitionEnd()){var f="scroll"+(c[0].toUpperCase()+c.slice(1));e(this._element).one(o.TRANSITION_END,p).emulateTransitionEnd(600),this._element.style[c]=this._element[f]+"px"}else p()}}}},p.hide=function(){var t=this;if(!this._isTransitioning&&e(this._element).hasClass(u.SHOW)){var i=e.Event(l.HIDE);if(e(this._element).trigger(i),!i.isDefaultPrevented()){var n=this._getDimension();if(this._element.style[n]=this._element.getBoundingClientRect()[n]+"px",o.reflow(this._element),e(this._element).addClass(u.COLLAPSING).removeClass(u.COLLAPSE).removeClass(u.SHOW),this._triggerArray.length)for(var r=0;r<this._triggerArray.length;r++){var a=this._triggerArray[r],s=o.getSelectorFromElement(a);null!==s&&(e(s).hasClass(u.SHOW)||e(a).addClass(u.COLLAPSED).attr("aria-expanded",!1))}this.setTransitioning(!0);var c=function(){t.setTransitioning(!1),e(t._element).removeClass(u.COLLAPSING).addClass(u.COLLAPSE).trigger(l.HIDDEN)};this._element.style[n]="",o.supportsTransitionEnd()?e(this._element).one(o.TRANSITION_END,c).emulateTransitionEnd(600):c()}}},p.setTransitioning=function(t){this._isTransitioning=t},p.dispose=function(){e.removeData(this._element,i),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},p._getConfig=function(i){return i=e.extend({},a,i),i.toggle=Boolean(i.toggle),o.typeCheckConfig(t,i,s),i},p._getDimension=function(){return e(this._element).hasClass(c.WIDTH)?c.WIDTH:c.HEIGHT},p._getParent=function(){var t=this,i=null;o.isElement(this._config.parent)?(i=this._config.parent,void 0!==this._config.parent.jquery&&(i=this._config.parent[0])):i=e(this._config.parent)[0];var r='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]';return e(i).find(r).each(function(e,i){t._addAriaAndCollapsedClass(n._getTargetFromElement(i),[i])}),i},p._addAriaAndCollapsedClass=function(t,i){if(t){var n=e(t).hasClass(u.SHOW);i.length&&e(i).toggleClass(u.COLLAPSED,!n).attr("aria-expanded",n)}},n._getTargetFromElement=function(t){var i=o.getSelectorFromElement(t);return i?e(i)[0]:null},n._jQueryInterface=function(t){return this.each(function(){var o=e(this),r=o.data(i),s=e.extend({},a,o.data(),"object"==typeof t&&t);if(!r&&s.toggle&&/show|hide/.test(t)&&(s.toggle=!1),r||(r=new n(this,s),o.data(i,r)),"string"==typeof t){if(void 0===r[t])throw new Error('No method named "'+t+'"');r[t]()}})},r(n,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return a}}]),n}();return e(document).on(l.CLICK_DATA_API,h.DATA_TOGGLE,function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var n=e(this),r=o.getSelectorFromElement(this);e(r).each(function(){var t=e(this),o=t.data(i)?"toggle":n.data();p._jQueryInterface.call(t,o)})}),e.fn[t]=p._jQueryInterface,e.fn[t].Constructor=p,e.fn[t].noConflict=function(){return e.fn[t]=n,p._jQueryInterface},p}(),h=function(){if(void 0===i)throw new Error("Bootstrap dropdown require Popper.js (https://popper.js.org)");var t="dropdown",n="bs.dropdown",a="."+n,s=e.fn[t],l=new RegExp("38|40|27"),u={HIDE:"hide"+a,HIDDEN:"hidden"+a,SHOW:"show"+a,SHOWN:"shown"+a,CLICK:"click"+a,CLICK_DATA_API:"click.bs.dropdown.data-api",KEYDOWN_DATA_API:"keydown.bs.dropdown.data-api",KEYUP_DATA_API:"keyup.bs.dropdown.data-api"},c={DISABLED:"disabled",SHOW:"show",DROPUP:"dropup",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left"},h={DATA_TOGGLE:'[data-toggle="dropdown"]',FORM_CHILD:".dropdown form",MENU:".dropdown-menu",NAVBAR_NAV:".navbar-nav",VISIBLE_ITEMS:".dropdown-menu .dropdown-item:not(.disabled)"},p={TOP:"top-start",TOPEND:"top-end",BOTTOM:"bottom-start",BOTTOMEND:"bottom-end"},f={offset:0,flip:!0},d={offset:"(number|string|function)",flip:"boolean"},m=function(){function s(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var m=s.prototype;return m.toggle=function(){if(!this._element.disabled&&!e(this._element).hasClass(c.DISABLED)){var t=s._getParentFromElement(this._element),n=e(this._menu).hasClass(c.SHOW);if(s._clearMenus(),!n){var o={relatedTarget:this._element},r=e.Event(u.SHOW,o);if(e(t).trigger(r),!r.isDefaultPrevented()){var a=this._element;e(t).hasClass(c.DROPUP)&&(e(this._menu).hasClass(c.MENULEFT)||e(this._menu).hasClass(c.MENURIGHT))&&(a=t),this._popper=new i(a,this._menu,this._getPopperConfig()),"ontouchstart"in document.documentElement&&!e(t).closest(h.NAVBAR_NAV).length&&e("body").children().on("mouseover",null,e.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),e(this._menu).toggleClass(c.SHOW),e(t).toggleClass(c.SHOW).trigger(e.Event(u.SHOWN,o))}}}},m.dispose=function(){e.removeData(this._element,n),e(this._element).off(a),this._element=null,this._menu=null,null!==this._popper&&this._popper.destroy(),this._popper=null},m.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},m._addEventListeners=function(){var t=this;e(this._element).on(u.CLICK,function(e){e.preventDefault(),e.stopPropagation(),t.toggle()})},m._getConfig=function(i){return i=e.extend({},this.constructor.Default,e(this._element).data(),i),o.typeCheckConfig(t,i,this.constructor.DefaultType),i},m._getMenuElement=function(){if(!this._menu){var t=s._getParentFromElement(this._element);this._menu=e(t).find(h.MENU)[0]}return this._menu},m._getPlacement=function(){var t=e(this._element).parent(),i=p.BOTTOM;return t.hasClass(c.DROPUP)?(i=p.TOP,e(this._menu).hasClass(c.MENURIGHT)&&(i=p.TOPEND)):e(this._menu).hasClass(c.MENURIGHT)&&(i=p.BOTTOMEND),i},m._detectNavbar=function(){return e(this._element).closest(".navbar").length>0},m._getPopperConfig=function(){var t=this,i={};"function"==typeof this._config.offset?i.fn=function(i){return i.offsets=e.extend({},i.offsets,t._config.offset(i.offsets)||{}),i}:i.offset=this._config.offset;var n={placement:this._getPlacement(),modifiers:{offset:i,flip:{enabled:this._config.flip}}};return this._inNavbar&&(n.modifiers.applyStyle={enabled:!this._inNavbar}),n},s._jQueryInterface=function(t){return this.each(function(){var i=e(this).data(n),o="object"==typeof t?t:null;if(i||(i=new s(this,o),e(this).data(n,i)),"string"==typeof t){if(void 0===i[t])throw new Error('No method named "'+t+'"');i[t]()}})},s._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var i=e.makeArray(e(h.DATA_TOGGLE)),o=0;o<i.length;o++){var r=s._getParentFromElement(i[o]),a=e(i[o]).data(n),l={relatedTarget:i[o]};if(a){var p=a._menu;if(e(r).hasClass(c.SHOW)&&!(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&e.contains(r,t.target))){var f=e.Event(u.HIDE,l);e(r).trigger(f),f.isDefaultPrevented()||("ontouchstart"in document.documentElement&&e("body").children().off("mouseover",null,e.noop),i[o].setAttribute("aria-expanded","false"),e(p).removeClass(c.SHOW),e(r).removeClass(c.SHOW).trigger(e.Event(u.HIDDEN,l)))}}}},s._getParentFromElement=function(t){var i,n=o.getSelectorFromElement(t);return n&&(i=e(n)[0]),i||t.parentNode},s._dataApiKeydownHandler=function(t){if(!(!l.test(t.which)||/button/i.test(t.target.tagName)&&32===t.which||/input|textarea/i.test(t.target.tagName)||(t.preventDefault(),t.stopPropagation(),this.disabled||e(this).hasClass(c.DISABLED)))){var i=s._getParentFromElement(this),n=e(i).hasClass(c.SHOW);if((n||27===t.which&&32===t.which)&&(!n||27!==t.which&&32!==t.which)){var o=e(i).find(h.VISIBLE_ITEMS).get();if(o.length){var r=o.indexOf(t.target);38===t.which&&r>0&&r--,40===t.which&&r<o.length-1&&r++,r<0&&(r=0),o[r].focus()}}else{if(27===t.which){var a=e(i).find(h.DATA_TOGGLE)[0];e(a).trigger("focus")}e(this).trigger("click")}}},r(s,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return f}},{key:"DefaultType",get:function(){return d}}]),s}();return e(document).on(u.KEYDOWN_DATA_API,h.DATA_TOGGLE,m._dataApiKeydownHandler).on(u.KEYDOWN_DATA_API,h.MENU,m._dataApiKeydownHandler).on(u.CLICK_DATA_API+" "+u.KEYUP_DATA_API,m._clearMenus).on(u.CLICK_DATA_API,h.DATA_TOGGLE,function(t){t.preventDefault(),t.stopPropagation(),m._jQueryInterface.call(e(this),"toggle")}).on(u.CLICK_DATA_API,h.FORM_CHILD,function(t){t.stopPropagation()}),e.fn[t]=m._jQueryInterface,e.fn[t].Constructor=m,e.fn[t].noConflict=function(){return e.fn[t]=s,m._jQueryInterface},m}(),p=function(){var t="modal",i=".bs.modal",n=e.fn[t],a={backdrop:!0,keyboard:!0,focus:!0,show:!0},s={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},l={HIDE:"hide.bs.modal",HIDDEN:"hidden.bs.modal",SHOW:"show.bs.modal",SHOWN:"shown.bs.modal",FOCUSIN:"focusin.bs.modal",RESIZE:"resize.bs.modal",CLICK_DISMISS:"click.dismiss.bs.modal",KEYDOWN_DISMISS:"keydown.dismiss.bs.modal",MOUSEUP_DISMISS:"mouseup.dismiss.bs.modal",MOUSEDOWN_DISMISS:"mousedown.dismiss.bs.modal",CLICK_DATA_API:"click.bs.modal.data-api"},u={SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",SHOW:"show"},c={DIALOG:".modal-dialog",DATA_TOGGLE:'[data-toggle="modal"]',DATA_DISMISS:'[data-dismiss="modal"]',FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"},h=function(){function n(t,i){this._config=this._getConfig(i),this._element=t,this._dialog=e(t).find(c.DIALOG)[0],this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._originalBodyPadding=0,this._scrollbarWidth=0}var h=n.prototype;return h.toggle=function(t){return this._isShown?this.hide():this.show(t)},h.show=function(t){var i=this;if(!this._isTransitioning&&!this._isShown){o.supportsTransitionEnd()&&e(this._element).hasClass(u.FADE)&&(this._isTransitioning=!0);var n=e.Event(l.SHOW,{relatedTarget:t});e(this._element).trigger(n),this._isShown||n.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),e(document.body).addClass(u.OPEN),this._setEscapeEvent(),this._setResizeEvent(),e(this._element).on(l.CLICK_DISMISS,c.DATA_DISMISS,function(t){return i.hide(t)}),e(this._dialog).on(l.MOUSEDOWN_DISMISS,function(){e(i._element).one(l.MOUSEUP_DISMISS,function(t){e(t.target).is(i._element)&&(i._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return i._showElement(t)}))}},h.hide=function(t){var i=this;if(t&&t.preventDefault(),!this._isTransitioning&&this._isShown){var n=e.Event(l.HIDE);if(e(this._element).trigger(n),this._isShown&&!n.isDefaultPrevented()){this._isShown=!1;var r=o.supportsTransitionEnd()&&e(this._element).hasClass(u.FADE);r&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),e(document).off(l.FOCUSIN),e(this._element).removeClass(u.SHOW),e(this._element).off(l.CLICK_DISMISS),e(this._dialog).off(l.MOUSEDOWN_DISMISS),r?e(this._element).one(o.TRANSITION_END,function(t){return i._hideModal(t)}).emulateTransitionEnd(300):this._hideModal()}}},h.dispose=function(){e.removeData(this._element,"bs.modal"),e(window,document,this._element,this._backdrop).off(i),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._scrollbarWidth=null},h.handleUpdate=function(){this._adjustDialog()},h._getConfig=function(i){return i=e.extend({},a,i),o.typeCheckConfig(t,i,s),i},h._showElement=function(t){var i=this,n=o.supportsTransitionEnd()&&e(this._element).hasClass(u.FADE);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.scrollTop=0,n&&o.reflow(this._element),e(this._element).addClass(u.SHOW),this._config.focus&&this._enforceFocus();var r=e.Event(l.SHOWN,{relatedTarget:t}),a=function(){i._config.focus&&i._element.focus(),i._isTransitioning=!1,e(i._element).trigger(r)};n?e(this._dialog).one(o.TRANSITION_END,a).emulateTransitionEnd(300):a()},h._enforceFocus=function(){var t=this;e(document).off(l.FOCUSIN).on(l.FOCUSIN,function(i){document===i.target||t._element===i.target||e(t._element).has(i.target).length||t._element.focus()})},h._setEscapeEvent=function(){var t=this;this._isShown&&this._config.keyboard?e(this._element).on(l.KEYDOWN_DISMISS,function(e){27===e.which&&(e.preventDefault(),t.hide())}):this._isShown||e(this._element).off(l.KEYDOWN_DISMISS)},h._setResizeEvent=function(){var t=this;this._isShown?e(window).on(l.RESIZE,function(e){return t.handleUpdate(e)}):e(window).off(l.RESIZE)},h._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._isTransitioning=!1,this._showBackdrop(function(){e(document.body).removeClass(u.OPEN),t._resetAdjustments(),t._resetScrollbar(),e(t._element).trigger(l.HIDDEN)})},h._removeBackdrop=function(){this._backdrop&&(e(this._backdrop).remove(),this._backdrop=null)},h._showBackdrop=function(t){var i=this,n=e(this._element).hasClass(u.FADE)?u.FADE:"";if(this._isShown&&this._config.backdrop){var r=o.supportsTransitionEnd()&&n;if(this._backdrop=document.createElement("div"),this._backdrop.className=u.BACKDROP,n&&e(this._backdrop).addClass(n),e(this._backdrop).appendTo(document.body),e(this._element).on(l.CLICK_DISMISS,function(t){i._ignoreBackdropClick?i._ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"===i._config.backdrop?i._element.focus():i.hide())}),r&&o.reflow(this._backdrop),e(this._backdrop).addClass(u.SHOW),!t)return;if(!r)return void t();e(this._backdrop).one(o.TRANSITION_END,t).emulateTransitionEnd(150)}else if(!this._isShown&&this._backdrop){e(this._backdrop).removeClass(u.SHOW);var a=function(){i._removeBackdrop(),t&&t()};o.supportsTransitionEnd()&&e(this._element).hasClass(u.FADE)?e(this._backdrop).one(o.TRANSITION_END,a).emulateTransitionEnd(150):a()}else t&&t()},h._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},h._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},h._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=t.left+t.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},h._setScrollbar=function(){var t=this;if(this._isBodyOverflowing){e(c.FIXED_CONTENT).each(function(i,n){var o=e(n)[0].style.paddingRight,r=e(n).css("padding-right");e(n).data("padding-right",o).css("padding-right",parseFloat(r)+t._scrollbarWidth+"px")}),e(c.STICKY_CONTENT).each(function(i,n){var o=e(n)[0].style.marginRight,r=e(n).css("margin-right");e(n).data("margin-right",o).css("margin-right",parseFloat(r)-t._scrollbarWidth+"px")}),e(c.NAVBAR_TOGGLER).each(function(i,n){var o=e(n)[0].style.marginRight,r=e(n).css("margin-right");e(n).data("margin-right",o).css("margin-right",parseFloat(r)+t._scrollbarWidth+"px")});var i=document.body.style.paddingRight,n=e("body").css("padding-right");e("body").data("padding-right",i).css("padding-right",parseFloat(n)+this._scrollbarWidth+"px")}},h._resetScrollbar=function(){e(c.FIXED_CONTENT).each(function(t,i){var n=e(i).data("padding-right");void 0!==n&&e(i).css("padding-right",n).removeData("padding-right")}),e(c.STICKY_CONTENT+", "+c.NAVBAR_TOGGLER).each(function(t,i){var n=e(i).data("margin-right");void 0!==n&&e(i).css("margin-right",n).removeData("margin-right")});var t=e("body").data("padding-right");void 0!==t&&e("body").css("padding-right",t).removeData("padding-right")},h._getScrollbarWidth=function(){var t=document.createElement("div");t.className=u.SCROLLBAR_MEASURER,document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},n._jQueryInterface=function(t,i){return this.each(function(){var o=e(this).data("bs.modal"),r=e.extend({},n.Default,e(this).data(),"object"==typeof t&&t);if(o||(o=new n(this,r),e(this).data("bs.modal",o)),"string"==typeof t){if(void 0===o[t])throw new Error('No method named "'+t+'"');o[t](i)}else r.show&&o.show(i)})},r(n,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return a}}]),n}();return e(document).on(l.CLICK_DATA_API,c.DATA_TOGGLE,function(t){var i,n=this,r=o.getSelectorFromElement(this);r&&(i=e(r)[0]);var a=e(i).data("bs.modal")?"toggle":e.extend({},e(i).data(),e(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault();var s=e(i).one(l.SHOW,function(t){t.isDefaultPrevented()||s.one(l.HIDDEN,function(){e(n).is(":visible")&&n.focus()})});h._jQueryInterface.call(e(i),a,this)}),e.fn[t]=h._jQueryInterface,e.fn[t].Constructor=h,e.fn[t].noConflict=function(){return e.fn[t]=n,h._jQueryInterface},h}(),f=function(){if(void 0===i)throw new Error("Bootstrap tooltips require Popper.js (https://popper.js.org)");var t="tooltip",n=".bs.tooltip",a=e.fn[t],s=new RegExp("(^|\\s)bs-tooltip\\S+","g"),l={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)"},u={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},c={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip"},h={SHOW:"show",OUT:"out"},p={HIDE:"hide"+n,HIDDEN:"hidden"+n,SHOW:"show"+n,SHOWN:"shown"+n,INSERTED:"inserted"+n,CLICK:"click"+n,FOCUSIN:"focusin"+n,FOCUSOUT:"focusout"+n,MOUSEENTER:"mouseenter"+n,MOUSELEAVE:"mouseleave"+n},f={FADE:"fade",SHOW:"show"},d={TOOLTIP:".tooltip",TOOLTIP_INNER:".tooltip-inner",ARROW:".arrow"},m={HOVER:"hover",FOCUS:"focus",CLICK:"click",MANUAL:"manual"},g=function(){function a(t,e){this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var g=a.prototype;return g.enable=function(){this._isEnabled=!0},g.disable=function(){this._isEnabled=!1},g.toggleEnabled=function(){this._isEnabled=!this._isEnabled},g.toggle=function(t){if(this._isEnabled)if(t){var i=this.constructor.DATA_KEY,n=e(t.currentTarget).data(i);n||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(i,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)}else{if(e(this.getTipElement()).hasClass(f.SHOW))return void this._leave(null,this);this._enter(null,this)}},g.dispose=function(){clearTimeout(this._timeout),e.removeData(this.element,this.constructor.DATA_KEY),e(this.element).off(this.constructor.EVENT_KEY),e(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&e(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},g.show=function(){var t=this;if("none"===e(this.element).css("display"))throw new Error("Please use show on visible elements");var n=e.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){e(this.element).trigger(n);var r=e.contains(this.element.ownerDocument.documentElement,this.element);if(n.isDefaultPrevented()||!r)return;var s=this.getTipElement(),l=o.getUID(this.constructor.NAME);s.setAttribute("id",l),this.element.setAttribute("aria-describedby",l),this.setContent(),this.config.animation&&e(s).addClass(f.FADE);var u="function"==typeof this.config.placement?this.config.placement.call(this,s,this.element):this.config.placement,c=this._getAttachment(u);this.addAttachmentClass(c);var p=!1===this.config.container?document.body:e(this.config.container);e(s).data(this.constructor.DATA_KEY,this),e.contains(this.element.ownerDocument.documentElement,this.tip)||e(s).appendTo(p),e(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new i(this.element,s,{placement:c,modifiers:{offset:{offset:this.config.offset},flip:{behavior:this.config.fallbackPlacement},arrow:{element:d.ARROW}},onCreate:function(e){e.originalPlacement!==e.placement&&t._handlePopperPlacementChange(e)},onUpdate:function(e){t._handlePopperPlacementChange(e)}}),e(s).addClass(f.SHOW),"ontouchstart"in document.documentElement&&e("body").children().on("mouseover",null,e.noop);var m=function(){t.config.animation&&t._fixTransition();var i=t._hoverState;t._hoverState=null,e(t.element).trigger(t.constructor.Event.SHOWN),i===h.OUT&&t._leave(null,t)};o.supportsTransitionEnd()&&e(this.tip).hasClass(f.FADE)?e(this.tip).one(o.TRANSITION_END,m).emulateTransitionEnd(a._TRANSITION_DURATION):m()}},g.hide=function(t){var i=this,n=this.getTipElement(),r=e.Event(this.constructor.Event.HIDE),a=function(){i._hoverState!==h.SHOW&&n.parentNode&&n.parentNode.removeChild(n),i._cleanTipClass(),i.element.removeAttribute("aria-describedby"),e(i.element).trigger(i.constructor.Event.HIDDEN),null!==i._popper&&i._popper.destroy(),t&&t()};e(this.element).trigger(r),r.isDefaultPrevented()||(e(n).removeClass(f.SHOW),"ontouchstart"in document.documentElement&&e("body").children().off("mouseover",null,e.noop),this._activeTrigger[m.CLICK]=!1,this._activeTrigger[m.FOCUS]=!1,this._activeTrigger[m.HOVER]=!1,o.supportsTransitionEnd()&&e(this.tip).hasClass(f.FADE)?e(n).one(o.TRANSITION_END,a).emulateTransitionEnd(150):a(),this._hoverState="")},g.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},g.isWithContent=function(){return Boolean(this.getTitle())},g.addAttachmentClass=function(t){e(this.getTipElement()).addClass("bs-tooltip-"+t)},g.getTipElement=function(){return this.tip=this.tip||e(this.config.template)[0],this.tip},g.setContent=function(){var t=e(this.getTipElement());this.setElementContent(t.find(d.TOOLTIP_INNER),this.getTitle()),t.removeClass(f.FADE+" "+f.SHOW)},g.setElementContent=function(t,i){var n=this.config.html;"object"==typeof i&&(i.nodeType||i.jquery)?n?e(i).parent().is(t)||t.empty().append(i):t.text(e(i).text()):t[n?"html":"text"](i)},g.getTitle=function(){var t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t},g._getAttachment=function(t){return u[t.toUpperCase()]},g._setListeners=function(){var t=this;this.config.trigger.split(" ").forEach(function(i){if("click"===i)e(t.element).on(t.constructor.Event.CLICK,t.config.selector,function(e){return t.toggle(e)});else if(i!==m.MANUAL){var n=i===m.HOVER?t.constructor.Event.MOUSEENTER:t.constructor.Event.FOCUSIN,o=i===m.HOVER?t.constructor.Event.MOUSELEAVE:t.constructor.Event.FOCUSOUT;e(t.element).on(n,t.config.selector,function(e){return t._enter(e)}).on(o,t.config.selector,function(e){return t._leave(e)})}e(t.element).closest(".modal").on("hide.bs.modal",function(){return t.hide()})}),this.config.selector?this.config=e.extend({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},g._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},g._enter=function(t,i){var n=this.constructor.DATA_KEY;(i=i||e(t.currentTarget).data(n))||(i=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(n,i)),t&&(i._activeTrigger["focusin"===t.type?m.FOCUS:m.HOVER]=!0),e(i.getTipElement()).hasClass(f.SHOW)||i._hoverState===h.SHOW?i._hoverState=h.SHOW:(clearTimeout(i._timeout),i._hoverState=h.SHOW,i.config.delay&&i.config.delay.show?i._timeout=setTimeout(function(){i._hoverState===h.SHOW&&i.show()},i.config.delay.show):i.show())},g._leave=function(t,i){var n=this.constructor.DATA_KEY;(i=i||e(t.currentTarget).data(n))||(i=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(n,i)),t&&(i._activeTrigger["focusout"===t.type?m.FOCUS:m.HOVER]=!1),i._isWithActiveTrigger()||(clearTimeout(i._timeout),i._hoverState=h.OUT,i.config.delay&&i.config.delay.hide?i._timeout=setTimeout(function(){i._hoverState===h.OUT&&i.hide()},i.config.delay.hide):i.hide())},g._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},g._getConfig=function(i){return"number"==typeof(i=e.extend({},this.constructor.Default,e(this.element).data(),i)).delay&&(i.delay={show:i.delay,hide:i.delay}),"number"==typeof i.title&&(i.title=i.title.toString()),"number"==typeof i.content&&(i.content=i.content.toString()),o.typeCheckConfig(t,i,this.constructor.DefaultType),i},g._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},g._cleanTipClass=function(){var t=e(this.getTipElement()),i=t.attr("class").match(s);null!==i&&i.length>0&&t.removeClass(i.join(""))},g._handlePopperPlacementChange=function(t){this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},g._fixTransition=function(){var t=this.getTipElement(),i=this.config.animation;null===t.getAttribute("x-placement")&&(e(t).removeClass(f.FADE),this.config.animation=!1,this.hide(),this.show(),this.config.animation=i)},a._jQueryInterface=function(t){return this.each(function(){var i=e(this).data("bs.tooltip"),n="object"==typeof t&&t;if((i||!/dispose|hide/.test(t))&&(i||(i=new a(this,n),e(this).data("bs.tooltip",i)),"string"==typeof t)){if(void 0===i[t])throw new Error('No method named "'+t+'"');i[t]()}})},r(a,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return c}},{key:"NAME",get:function(){return t}},{key:"DATA_KEY",get:function(){return"bs.tooltip"}},{key:"Event",get:function(){return p}},{key:"EVENT_KEY",get:function(){return n}},{key:"DefaultType",get:function(){return l}}]),a}();return e.fn[t]=g._jQueryInterface,e.fn[t].Constructor=g,e.fn[t].noConflict=function(){return e.fn[t]=a,g._jQueryInterface},g}(),d=function(){var t="popover",i=".bs.popover",n=e.fn[t],o=new RegExp("(^|\\s)bs-popover\\S+","g"),s=e.extend({},f.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),l=e.extend({},f.DefaultType,{content:"(string|element|function)"}),u={FADE:"fade",SHOW:"show"},c={TITLE:".popover-header",CONTENT:".popover-body"},h={HIDE:"hide"+i,HIDDEN:"hidden"+i,SHOW:"show"+i,SHOWN:"shown"+i,INSERTED:"inserted"+i,CLICK:"click"+i,FOCUSIN:"focusin"+i,FOCUSOUT:"focusout"+i,MOUSEENTER:"mouseenter"+i,MOUSELEAVE:"mouseleave"+i},p=function(n){function p(){return n.apply(this,arguments)||this}a(p,n);var f=p.prototype;return f.isWithContent=function(){return this.getTitle()||this._getContent()},f.addAttachmentClass=function(t){e(this.getTipElement()).addClass("bs-popover-"+t)},f.getTipElement=function(){return this.tip=this.tip||e(this.config.template)[0],this.tip},f.setContent=function(){var t=e(this.getTipElement());this.setElementContent(t.find(c.TITLE),this.getTitle()),this.setElementContent(t.find(c.CONTENT),this._getContent()),t.removeClass(u.FADE+" "+u.SHOW)},f._getContent=function(){return this.element.getAttribute("data-content")||("function"==typeof this.config.content?this.config.content.call(this.element):this.config.content)},f._cleanTipClass=function(){var t=e(this.getTipElement()),i=t.attr("class").match(o);null!==i&&i.length>0&&t.removeClass(i.join(""))},p._jQueryInterface=function(t){return this.each(function(){var i=e(this).data("bs.popover"),n="object"==typeof t?t:null;if((i||!/destroy|hide/.test(t))&&(i||(i=new p(this,n),e(this).data("bs.popover",i)),"string"==typeof t)){if(void 0===i[t])throw new Error('No method named "'+t+'"');i[t]()}})},r(p,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return s}},{key:"NAME",get:function(){return t}},{key:"DATA_KEY",get:function(){return"bs.popover"}},{key:"Event",get:function(){return h}},{key:"EVENT_KEY",get:function(){return i}},{key:"DefaultType",get:function(){return l}}]),p}(f);return e.fn[t]=p._jQueryInterface,e.fn[t].Constructor=p,e.fn[t].noConflict=function(){return e.fn[t]=n,p._jQueryInterface},p}(),m=function(){var t="scrollspy",i=e.fn[t],n={offset:10,method:"auto",target:""},a={offset:"number",method:"string",target:"(string|element)"},s={ACTIVATE:"activate.bs.scrollspy",SCROLL:"scroll.bs.scrollspy",LOAD_DATA_API:"load.bs.scrollspy.data-api"},l={DROPDOWN_ITEM:"dropdown-item",DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active"},u={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",NAV_LIST_GROUP:".nav, .list-group",NAV_LINKS:".nav-link",NAV_ITEMS:".nav-item",LIST_ITEMS:".list-group-item",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},c={OFFSET:"offset",POSITION:"position"},h=function(){function i(t,i){var n=this;this._element=t,this._scrollElement="BODY"===t.tagName?window:t,this._config=this._getConfig(i),this._selector=this._config.target+" "+u.NAV_LINKS+","+this._config.target+" "+u.LIST_ITEMS+","+this._config.target+" "+u.DROPDOWN_ITEMS,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,e(this._scrollElement).on(s.SCROLL,function(t){return n._process(t)}),this.refresh(),this._process()}var h=i.prototype;return h.refresh=function(){var t=this,i=this._scrollElement!==this._scrollElement.window?c.POSITION:c.OFFSET,n="auto"===this._config.method?i:this._config.method,r=n===c.POSITION?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),e.makeArray(e(this._selector)).map(function(t){var i,a=o.getSelectorFromElement(t);if(a&&(i=e(a)[0]),i){var s=i.getBoundingClientRect();if(s.width||s.height)return[e(i)[n]().top+r,a]}return null}).filter(function(t){return t}).sort(function(t,e){return t[0]-e[0]}).forEach(function(e){t._offsets.push(e[0]),t._targets.push(e[1])})},h.dispose=function(){e.removeData(this._element,"bs.scrollspy"),e(this._scrollElement).off(".bs.scrollspy"),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},h._getConfig=function(i){if("string"!=typeof(i=e.extend({},n,i)).target){var r=e(i.target).attr("id");r||(r=o.getUID(t),e(i.target).attr("id",r)),i.target="#"+r}return o.typeCheckConfig(t,i,a),i},h._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},h._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},h._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},h._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),i=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),t>=i){var n=this._targets[this._targets.length-1];this._activeTarget!==n&&this._activate(n)}else{if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var o=this._offsets.length;o--;)this._activeTarget!==this._targets[o]&&t>=this._offsets[o]&&(void 0===this._offsets[o+1]||t<this._offsets[o+1])&&this._activate(this._targets[o])}},h._activate=function(t){this._activeTarget=t,this._clear();var i=this._selector.split(",");i=i.map(function(e){return e+'[data-target="'+t+'"],'+e+'[href="'+t+'"]'});var n=e(i.join(","));n.hasClass(l.DROPDOWN_ITEM)?(n.closest(u.DROPDOWN).find(u.DROPDOWN_TOGGLE).addClass(l.ACTIVE),n.addClass(l.ACTIVE)):(n.addClass(l.ACTIVE),n.parents(u.NAV_LIST_GROUP).prev(u.NAV_LINKS+", "+u.LIST_ITEMS).addClass(l.ACTIVE),n.parents(u.NAV_LIST_GROUP).prev(u.NAV_ITEMS).children(u.NAV_LINKS).addClass(l.ACTIVE)),e(this._scrollElement).trigger(s.ACTIVATE,{relatedTarget:t})},h._clear=function(){e(this._selector).filter(u.ACTIVE).removeClass(l.ACTIVE)},i._jQueryInterface=function(t){return this.each(function(){var n=e(this).data("bs.scrollspy"),o="object"==typeof t&&t;if(n||(n=new i(this,o),e(this).data("bs.scrollspy",n)),"string"==typeof t){if(void 0===n[t])throw new Error('No method named "'+t+'"');n[t]()}})},r(i,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return n}}]),i}();return e(window).on(s.LOAD_DATA_API,function(){for(var t=e.makeArray(e(u.DATA_SPY)),i=t.length;i--;){var n=e(t[i]);h._jQueryInterface.call(n,n.data())}}),e.fn[t]=h._jQueryInterface,e.fn[t].Constructor=h,e.fn[t].noConflict=function(){return e.fn[t]=i,h._jQueryInterface},h}(),g=function(){var t=e.fn.tab,i={HIDE:"hide.bs.tab",HIDDEN:"hidden.bs.tab",SHOW:"show.bs.tab",SHOWN:"shown.bs.tab",CLICK_DATA_API:"click.bs.tab.data-api"},n={DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active",DISABLED:"disabled",FADE:"fade",SHOW:"show"},a={DROPDOWN:".dropdown",NAV_LIST_GROUP:".nav, .list-group",ACTIVE:".active",ACTIVE_UL:"> li > .active",DATA_TOGGLE:'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',DROPDOWN_TOGGLE:".dropdown-toggle",DROPDOWN_ACTIVE_CHILD:"> .dropdown-menu .active"},s=function(){function t(t){this._element=t}var s=t.prototype;return s.show=function(){var t=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&e(this._element).hasClass(n.ACTIVE)||e(this._element).hasClass(n.DISABLED))){var r,s,l=e(this._element).closest(a.NAV_LIST_GROUP)[0],u=o.getSelectorFromElement(this._element);if(l){var c="UL"===l.nodeName?a.ACTIVE_UL:a.ACTIVE;s=e.makeArray(e(l).find(c)),s=s[s.length-1]}var h=e.Event(i.HIDE,{relatedTarget:this._element}),p=e.Event(i.SHOW,{relatedTarget:s});if(s&&e(s).trigger(h),e(this._element).trigger(p),!p.isDefaultPrevented()&&!h.isDefaultPrevented()){u&&(r=e(u)[0]),this._activate(this._element,l);var f=function(){var n=e.Event(i.HIDDEN,{relatedTarget:t._element}),o=e.Event(i.SHOWN,{relatedTarget:s});e(s).trigger(n),e(t._element).trigger(o)};r?this._activate(r,r.parentNode,f):f()}}},s.dispose=function(){e.removeData(this._element,"bs.tab"),this._element=null},s._activate=function(t,i,r){var s,l=this,u=(s="UL"===i.nodeName?e(i).find(a.ACTIVE_UL):e(i).children(a.ACTIVE))[0],c=r&&o.supportsTransitionEnd()&&u&&e(u).hasClass(n.FADE),h=function(){return l._transitionComplete(t,u,c,r)};u&&c?e(u).one(o.TRANSITION_END,h).emulateTransitionEnd(150):h(),u&&e(u).removeClass(n.SHOW)},s._transitionComplete=function(t,i,r,s){if(i){e(i).removeClass(n.ACTIVE);var l=e(i.parentNode).find(a.DROPDOWN_ACTIVE_CHILD)[0];l&&e(l).removeClass(n.ACTIVE),"tab"===i.getAttribute("role")&&i.setAttribute("aria-selected",!1)}if(e(t).addClass(n.ACTIVE),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),r?(o.reflow(t),e(t).addClass(n.SHOW)):e(t).removeClass(n.FADE),t.parentNode&&e(t.parentNode).hasClass(n.DROPDOWN_MENU)){var u=e(t).closest(a.DROPDOWN)[0];u&&e(u).find(a.DROPDOWN_TOGGLE).addClass(n.ACTIVE),t.setAttribute("aria-expanded",!0)}s&&s()},t._jQueryInterface=function(i){return this.each(function(){var n=e(this),o=n.data("bs.tab");if(o||(o=new t(this),n.data("bs.tab",o)),"string"==typeof i){if(void 0===o[i])throw new Error('No method named "'+i+'"');o[i]()}})},r(t,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}}]),t}();return e(document).on(i.CLICK_DATA_API,a.DATA_TOGGLE,function(t){t.preventDefault(),s._jQueryInterface.call(e(this),"show")}),e.fn.tab=s._jQueryInterface,e.fn.tab.Constructor=s,e.fn.tab.noConflict=function(){return e.fn.tab=t,s._jQueryInterface},s}();return function(){if(void 0===e)throw new Error("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1===t[0]&&9===t[1]&&t[2]<1||t[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}(),t.Util=o,t.Alert=s,t.Button=l,t.Carousel=u,t.Collapse=c,t.Dropdown=h,t.Modal=p,t.Popover=d,t.Scrollspy=m,t.Tab=g,t.Tooltip=f,t}({},$,Popper),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},windowIsDefined="object"===("undefined"==typeof window?"undefined":_typeof(window));!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e;try{e=require("jquery")}catch(t){e=null}module.exports=t(e)}else window&&(window.Slider=t(window.jQuery))}(function(t){windowIsDefined&&!window.console&&(window.console={}),windowIsDefined&&!window.console.log&&(window.console.log=function(){}),windowIsDefined&&!window.console.warn&&(window.console.warn=function(){});var e;return function(t){"use strict";function e(){}var i=Array.prototype.slice;!function(t){function n(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function o(e,n){t.fn[e]=function(o){if("string"==typeof o){for(var a=i.call(arguments,1),s=0,l=this.length;s<l;s++){var u=this[s],c=t.data(u,e);if(c)if(t.isFunction(c[o])&&"_"!==o.charAt(0)){var h=c[o].apply(c,a);if(void 0!==h&&h!==c)return h}else r("no such method '"+o+"' for "+e+" instance");else r("cannot call methods on "+e+" prior to initialization; attempted to call '"+o+"'")}return this}var p=this.map(function(){var i=t.data(this,e);return i?(i.option(o),i._init()):(i=new n(this,o),t.data(this,e,i)),t(this)});return!p||p.length>1?p:p[0]}}if(t){var r="undefined"==typeof console?e:function(t){console.error(t)};t.bridget=function(t,e){n(e),o(t,e)},t.bridget}}(t)}(t),function(t){function i(e,i){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),i=i||{};for(var n=Object.keys(this.defaultOptions),r=0;r<n.length;r++){var a=n[r],s=i[a];s=null!==(s=void 0!==s?s:function(t,e){var i="data-slider-"+e.replace(/_/g,"-"),n=t.getAttribute(i);try{return JSON.parse(n)}catch(t){return n}}(this.element,a))?s:this.defaultOptions[a],this.options||(this.options={}),this.options[a]=s}"auto"===this.options.rtl&&(this.options.rtl="rtl"===window.getComputedStyle(this.element).direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var l,u,c,h,p,f=this.element.style.width,d=!1,m=this.element.parentNode;if(this.sliderElem)d=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var g=document.createElement("div");g.className="slider-track",(u=document.createElement("div")).className="slider-track-low",(l=document.createElement("div")).className="slider-selection",(c=document.createElement("div")).className="slider-track-high",(h=document.createElement("div")).className="slider-handle min-slider-handle",h.setAttribute("role","slider"),h.setAttribute("aria-valuemin",this.options.min),h.setAttribute("aria-valuemax",this.options.max),(p=document.createElement("div")).className="slider-handle max-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),g.appendChild(u),g.appendChild(l),g.appendChild(c),this.rangeHighlightElements=[];var y=this.options.rangeHighlights;if(Array.isArray(y)&&y.length>0)for(var v=0;v<y.length;v++){var _=document.createElement("div"),x=y[v].class||"";_.className="slider-rangeHighlight slider-selection "+x,this.rangeHighlightElements.push(_),g.appendChild(_)}var b=Array.isArray(this.options.labelledby);if(b&&this.options.labelledby[0]&&h.setAttribute("aria-labelledby",this.options.labelledby[0]),b&&this.options.labelledby[1]&&p.setAttribute("aria-labelledby",this.options.labelledby[1]),!b&&this.options.labelledby&&(h.setAttribute("aria-labelledby",this.options.labelledby),p.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",r=0;r<this.options.ticks.length;r++){var w=document.createElement("div");if(w.className="slider-tick",this.options.ticks_tooltip){var T=this._addTickListener(),E=T.addMouseEnter(this,w,r),C=T.addMouseLeave(this,w);this.ticksCallbackMap[r]={mouseEnter:E,mouseLeave:C}}this.ticks.push(w),this.ticksContainer.appendChild(w)}l.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",r=0;r<this.options.ticks_labels.length;r++){var S=document.createElement("div"),A=0===this.options.ticks_positions.length,k=this.options.reversed&&A?this.options.ticks_labels.length-(r+1):r;S.className="slider-tick-label",S.innerHTML=this.options.ticks_labels[k],this.tickLabels.push(S),this.tickLabelContainer.appendChild(S)}var I=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},L=document.createElement("div");L.className="tooltip tooltip-main",L.setAttribute("role","presentation"),I(L);var D=document.createElement("div");D.className="tooltip tooltip-min",D.setAttribute("role","presentation"),I(D);var P=document.createElement("div");P.className="tooltip tooltip-max",P.setAttribute("role","presentation"),I(P),this.sliderElem.appendChild(g),this.sliderElem.appendChild(L),this.sliderElem.appendChild(D),this.sliderElem.appendChild(P),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(h),this.sliderElem.appendChild(p),m.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),o[this.options.scale]&&(this.options.scale=o[this.options.scale]),!0===d&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach(function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-right"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"left"),this._removeClass(t,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=f,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=u||this.trackLow,this.trackSelection=l||this.trackSelection,this.trackHigh=c||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=h||this.handle1,this.handle2=p||this.handle2,!0===d)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),r=0;r<this.ticks.length;r++)this._removeClass(this.ticks[r],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),r=0;r<this.ticks.length;r++)this._addClass(this.ticks[r],this.options.handle);if(this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable){var z=!1;try{var M=Object.defineProperty({},"passive",{get:function(){z=!0}});window.addEventListener("test",null,M)}catch(t){}var O=!!z&&{passive:!0};this.sliderElem.addEventListener("touchstart",this.touchstart,O),this.sliderElem.addEventListener("touchmove",this.touchmove,O)}if(this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip)this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide");else if("always"===this.options.tooltip)this._showTooltip(),this._alwaysShowTooltip=!0;else{if(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip){var R=this._addTickListener(),N=R.addMouseEnter(this,this.handle1),j=R.addMouseLeave(this,this.handle1);this.handleCallbackMap.handle1={mouseEnter:N,mouseLeave:j},N=R.addMouseEnter(this,this.handle2),j=R.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:N,mouseLeave:j}}else this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1);this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)}this.options.enabled?this.enable():this.disable()}var n={formatInvalidInputErrorMsg:function(t){return"Invalid input value '"+t+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"},o={linear:{toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(this.options.ticks_positions.length>0){for(var n,o,r,a=0,s=1;s<this.options.ticks_positions.length;s++)if(t<=this.options.ticks_positions[s]){n=this.options.ticks[s-1],r=this.options.ticks_positions[s-1],o=this.options.ticks[s],a=this.options.ticks_positions[s];break}e=n+(t-r)/(a-r)*(o-n),i=!1}var l=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return l<this.options.min?this.options.min:l>this.options.max?this.options.max:l},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var e,i,n,o=0,r=0;r<this.options.ticks.length;r++)if(t<=this.options.ticks[r]){e=r>0?this.options.ticks[r-1]:0,n=r>0?this.options.ticks_positions[r-1]:0,i=this.options.ticks[r],o=this.options.ticks_positions[r];break}if(r>0)return n+(t-e)/(i-e)*(o-n)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),n=Math.exp(e+(i-e)*t/100);return Math.round(n)===this.options.max?this.options.max:(n=this.options.min+Math.round((n-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:n>this.options.max?this.options.max:n},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===t?0:Math.log(t))-i)/(e-i)}}};if(e=function(t,e){return i.call(this,t,e),this},e.prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t||(t=0);var n=this.getValue();this._state.value=this._validateInputValue(t);var o=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=o(this._state.value[0]),this._state.value[1]=o(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=o(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var r=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(r),!0===e&&this._trigger("slide",r),n!==r&&!0===i&&this._trigger("change",{oldValue:n,newValue:r}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(e,i){t?(this.$element.off(e,i),this.$sliderElem.off(e,i)):this._unbindNonQueryEventHandler(e,i)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),i.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._resize(),this._layout(),this},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1)}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var n=0;n<i.length;n++)if(i[n]===e){i.splice(n,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_setToolTipOnMouseOver:function(t){function e(t,e){return e?[100-t.percentage[0],this.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}var i=this.options.formatter(t?t.value[0]:this._state.value[0]),n=t?e(t,this.options.reversed):e(this._state,this.options.reversed);this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=n[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px")},_addTickListener:function(){return{addMouseEnter:function(t,e,i){var n=function(){var e=t._state,n=i>=0?i:this.attributes["aria-valuenow"].value,o=parseInt(n,10);e.value[0]=o,e.percentage[0]=t.options.ticks_positions[o],t._setToolTipOnMouseOver(e),t._showTooltip()};return e.addEventListener("mouseenter",n,!1),n},addMouseLeave:function(t,e){var i=function(){t._hideTooltip()};return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),isNaN(this.options.formatter(this._state.value[0]))&&this.handle1.setAttribute("aria-valuetext",this.options.formatter(this._state.value[0])),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),isNaN(this.options.formatter(this._state.value[1]))&&this.handle2.setAttribute("aria-valuetext",this.options.formatter(this._state.value[1])),this.rangeHighlightElements.length>0&&Array.isArray(this.options.rangeHighlights)&&this.options.rangeHighlights.length>0)for(var e=0;e<this.options.rangeHighlights.length;e++){var i=this._toPercentage(this.options.rangeHighlights[e].start),n=this._toPercentage(this.options.rangeHighlights[e].end);if(this.options.reversed){var o=100-n;n=100-i,i=o}var r=this._createHighlightRange(i,n);r?"vertical"===this.options.orientation?(this.rangeHighlightElements[e].style.top=r.start+"%",this.rangeHighlightElements[e].style.height=r.size+"%"):(this.options.rtl?this.rangeHighlightElements[e].style.right=r.start+"%":this.rangeHighlightElements[e].style.left=r.start+"%",this.rangeHighlightElements[e].style.width=r.size+"%"):this.rangeHighlightElements[e].style.display="none"}if(Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var a,s="vertical"===this.options.orientation?"height":"width";a="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft";var l=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var u=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[a]=-l/2+"px"),u=this.tickLabelContainer.offsetHeight;else for(c=0;c<this.tickLabelContainer.childNodes.length;c++)this.tickLabelContainer.childNodes[c].offsetHeight>u&&(u=this.tickLabelContainer.childNodes[c].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=u+"px")}for(var c=0;c<this.options.ticks.length;c++){var h=this.options.ticks_positions[c]||this._toPercentage(this.options.ticks[c]);this.options.reversed&&(h=100-h),this.ticks[c].style[this.stylePos]=h+"%",this._removeClass(this.ticks[c],"in-selection"),this.options.range?h>=t[0]&&h<=t[1]&&this._addClass(this.ticks[c],"in-selection"):"after"===this.options.selection&&h>=t[0]?this._addClass(this.ticks[c],"in-selection"):"before"===this.options.selection&&h<=t[0]&&this._addClass(this.ticks[c],"in-selection"),this.tickLabels[c]&&(this.tickLabels[c].style[s]=l+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[c]?(this.tickLabels[c].style.position="absolute",this.tickLabels[c].style[this.stylePos]=h+"%",this.tickLabels[c].style[a]=-l/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[c].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[c].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[a]=this.sliderElem.offsetWidth/2*-1+"px"))}}var p;if(this.options.range){p=this.options.formatter(this._state.value),this._setText(this.tooltipInner,p),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");var f=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,f);var d=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,d),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetWidth/2+"px")}else p=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,p),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{"right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(t[0],t[1])+"%":this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var m=this.tooltip_min.getBoundingClientRect(),g=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?m.right>g.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):m.right>g.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?t>e?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var i=Math.abs(this._state.percentage[0]-e),n=Math.abs(this._state.percentage[1]-e);this._state.dragged=i<n?0:1,this._adjustPercentageForRangeSliders(e)}else this._state.dragged=0;this._state.percentage[this._state.dragged]=e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0];this.touchX=e.pageX,this.touchY=e.pageY}else this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var n="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(n||o)&&(i=-i)}var r=this._state.value[t]+i*this.options.step,a=r/this.options.max*100;return this._state.keyCtrl=t,this.options.range&&(this._adjustPercentageForRangeSliders(a),r=[this._state.keyCtrl?this._state.value[0]:r,this._state.keyCtrl?r:this._state.value[1]]),this._trigger("slideStart",r),this._setDataVal(r),this.setValue(r,!0,!0),this._setDataVal(r),this._trigger("slideStop",r),this._layout(),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this._state.percentage[this._state.dragged]=e,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_touchmove:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0],i=e.pageX-this.touchX,n=e.pageY-this.touchY;this._state.inDrag||("vertical"===this.options.orientation&&i<=5&&i>=-5&&(n>=15||n<=-15)?this._mousedown(t):n<=5&&n>=-5&&(i>=15||i<=-15)&&this._mousedown(t))}},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var e=this._getNumDigitsAfterDecimalPlace(t);e=e?e-1:0;var i=this._applyToFixedAndParseFloat(t,e);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._state.value[1]/this.options.max*100<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._state.value[0]/this.options.max*100>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus())}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,!1===this._state.over&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var e;if(this.options.range?(e=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(e[0]=this._toValue(this._state.percentage[0]),e[0]=this._applyPrecision(e[0])),100!==this._state.percentage[1]&&(e[1]=this._toValue(this._state.percentage[1]),e[1]=this._applyPrecision(e[1]))):(e=this._toValue(this._state.percentage[0]),e=parseFloat(e),e=this._applyPrecision(e)),t){for(var i=[e,1/0],n=0;n<this.options.ticks.length;n++){var o=Math.abs(this.options.ticks[n]-e);o<=i[1]&&(i=[this.options.ticks[n],o])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return e},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var i=t.toFixed(e);return parseFloat(i)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(e=-e);var i=e/this._state.size*100;return i=Math.round(i/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(i=100-i),Math.max(0,Math.min(100,i))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(n.formatInvalidInputErrorMsg(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("number"!=typeof i)throw new Error(n.formatInvalidInputErrorMsg(i))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(e,i){i=i||0===i?i:void 0;var n=this.eventToCallbackMap[e];if(n&&n.length)for(var o=0;o<n.length;o++)(0,n[o])(i);t&&this._triggerJQueryEvent(e,i)},_triggerJQueryEvent:function(t,e){var i={type:t,value:e};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),n=t.className,o=0;o<i.length;o++){var r=i[o],a=new RegExp("(?:\\s|^)"+r+"(?:\\s|$)");n=n.replace(a," ")}t.className=n.trim()},_addClass:function(t,e){for(var i=e.split(" "),n=t.className,o=0;o<i.length;o++){var r=i[o];new RegExp("(?:\\s|^)"+r+"(?:\\s|$)").test(n)||(n+=" "+r)}t.className=n.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(e,i,n){if(t)t.style(e,i,n);else{var o=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()});e.style[o]=n}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var e,i="left"===(e=this.options.tooltip_position?this.options.tooltip_position:this.options.rtl?"left":"right")?"right":"left";t.forEach(function(t){this._addClass(t,e),t.style[i]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t&&t.fn){var r=void 0;t.fn.slider?(windowIsDefined&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),r="bootstrapSlider"):(t.bridget("slider",e),r="slider"),t.bridget("bootstrapSlider",e),t(function(){t("input[data-provide=slider]")[r]()})}}(t),e}),function(t){"use strict";function e(t,e){for(var i=0;i<t.length;++i)e(t[i],i)}function i(e,i){this.$select=t(e),this.$select.attr("data-placeholder")&&(i.nonSelectedText=this.$select.data("placeholder")),this.options=this.mergeOptions(t.extend({},i,this.$select.data())),this.originalOptions=this.$select.clone()[0].options,this.query="",this.searchTimeout=null,this.lastToggledInput=null,this.options.multiple="multiple"===this.$select.attr("multiple"),this.options.onChange=t.proxy(this.options.onChange,this),this.options.onDropdownShow=t.proxy(this.options.onDropdownShow,this),this.options.onDropdownHide=t.proxy(this.options.onDropdownHide,this),this.options.onDropdownShown=t.proxy(this.options.onDropdownShown,this),this.options.onDropdownHidden=t.proxy(this.options.onDropdownHidden,this),this.buildContainer(),this.buildButton(),this.buildDropdown(),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&t("option",this.$select).length<=0&&this.disable(),this.$select.hide().after(this.$container)}"undefined"!=typeof ko&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect&&(ko.bindingHandlers.multiselect={after:["options","value","selectedOptions"],init:function(e,i,n,o,r){var a=t(e),s=ko.toJS(i());if(a.multiselect(s),n.has("options")){var l=n.get("options");ko.isObservable(l)&&ko.computed({read:function(){l(),setTimeout(function(){var t=a.data("multiselect");t&&t.updateOriginalOptions(),a.multiselect("rebuild")},1)},disposeWhenNodeIsRemoved:e})}if(n.has("value")){var u=n.get("value");ko.isObservable(u)&&ko.computed({read:function(){u(),setTimeout(function(){a.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:e}).extend({rateLimit:100,notifyWhenChangesStop:!0})}if(n.has("selectedOptions")){var c=n.get("selectedOptions");ko.isObservable(c)&&ko.computed({read:function(){c(),setTimeout(function(){a.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:e}).extend({rateLimit:100,notifyWhenChangesStop:!0})}ko.utils.domNodeDisposal.addDisposeCallback(e,function(){a.multiselect("destroy")})},update:function(e,i,n,o,r){var a=t(e),s=ko.toJS(i());a.multiselect("setOptions",s),a.multiselect("rebuild")}}),i.prototype={defaults:{buttonText:function(e,i){if(0===e.length)return this.nonSelectedText;if(this.allSelectedText&&e.length===t("option",t(i)).length&&1!==t("option",t(i)).length&&this.multiple)return this.selectAllNumber?this.allSelectedText+" ("+e.length+")":this.allSelectedText;if(e.length>this.numberDisplayed)return e.length+" "+this.nSelectedText;var n="",o=this.delimiterText;return e.each(function(){var e=void 0!==t(this).attr("label")?t(this).attr("label"):t(this).text();n+=e+o}),n.substr(0,n.length-2)},buttonTitle:function(e,i){if(0===e.length)return this.nonSelectedText;var n="",o=this.delimiterText;return e.each(function(){var e=void 0!==t(this).attr("label")?t(this).attr("label"):t(this).text();n+=e+o}),n.substr(0,n.length-2)},optionLabel:function(e){return t(e).attr("label")||t(e).text()},onChange:function(t,e){},onDropdownShow:function(t){},onDropdownHide:function(t){},onDropdownShown:function(t){},onDropdownHidden:function(t){},onSelectAll:function(){},enableHTML:!1,buttonClass:"btn btn-default",inheritClass:!1,buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',dropRight:!1,selectedClass:"active",maxHeight:!1,checkboxName:!1,includeSelectAllOption:!1,includeSelectAllIfMoreThan:0,selectAllText:" Select all",selectAllValue:"multiselect-all",selectAllName:!1,selectAllNumber:!0,enableFiltering:!1,enableCaseInsensitiveFiltering:!1,enableClickableOptGroups:!1,filterPlaceholder:"Search",filterBehavior:"text",includeFilterClearBtn:!0,preventInputChangeEvent:!1,nonSelectedText:"None selected",nSelectedText:"selected",allSelectedText:"All selected",numberDisplayed:3,disableIfEmpty:!1,delimiterText:", ",templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a tabindex="0"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>'}},constructor:i,buildContainer:function(){this.$container=t(this.options.buttonContainer),this.$container.on("show.bs.dropdown",this.options.onDropdownShow),this.$container.on("hide.bs.dropdown",this.options.onDropdownHide),this.$container.on("shown.bs.dropdown",this.options.onDropdownShown),this.$container.on("hidden.bs.dropdown",this.options.onDropdownHidden)},buildButton:function(){this.$button=t(this.options.templates.button).addClass(this.options.buttonClass),this.$select.attr("class")&&this.options.inheritClass&&this.$button.addClass(this.$select.attr("class")),this.$select.prop("disabled")?this.disable():this.enable(),this.options.buttonWidth&&"auto"!==this.options.buttonWidth&&(this.$button.css({width:this.options.buttonWidth,overflow:"hidden","text-overflow":"ellipsis"}),this.$container.css({width:this.options.buttonWidth}));var e=this.$select.attr("tabindex");e&&this.$button.attr("tabindex",e),this.$container.prepend(this.$button)},buildDropdown:function(){this.$ul=t(this.options.templates.ul),this.options.dropRight&&this.$ul.addClass("pull-right"),this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"}),this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each(t.proxy(function(e,i){var n=t(i),o=n.prop("tagName").toLowerCase();n.prop("value")!==this.options.selectAllValue&&("optgroup"===o?this.createOptgroup(i):"option"===o&&("divider"===n.data("role")?this.createDivider():this.createOptionValue(i)))},this)),t("li input",this.$ul).on("change",t.proxy(function(e){var i=t(e.target),n=i.prop("checked")||!1,o=i.val()===this.options.selectAllValue;this.options.selectedClass&&(n?i.closest("li").addClass(this.options.selectedClass):i.closest("li").removeClass(this.options.selectedClass));var r=i.val(),a=this.getOptionByValue(r),s=t("option",this.$select).not(a),l=t("input",this.$container).not(i);if(o&&(n?this.selectAll():this.deselectAll()),o||(n?(a.prop("selected",!0),this.options.multiple?a.prop("selected",!0):(this.options.selectedClass&&t(l).closest("li").removeClass(this.options.selectedClass),t(l).prop("checked",!1),s.prop("selected",!1),this.$button.click()),"active"===this.options.selectedClass&&s.closest("a").css("outline","")):a.prop("selected",!1)),this.$select.change(),this.updateButtonText(),this.updateSelectAll(),this.options.onChange(a,n),this.options.preventInputChangeEvent)return!1},this)),t("li a",this.$ul).on("mousedown",function(t){if(t.shiftKey)return!1}),t("li a",this.$ul).on("touchstart click",t.proxy(function(e){e.stopPropagation();var i=t(e.target);if(e.shiftKey&&this.options.multiple){i.is("label")&&(e.preventDefault(),(i=i.find("input")).prop("checked",!i.prop("checked")));var n=i.prop("checked")||!1;if(null!==this.lastToggledInput&&this.lastToggledInput!==i){var o=i.closest("li").index(),r=this.lastToggledInput.closest("li").index();if(o>r){var a=r;r=o,o=a}++r;var s=this.$ul.find("li").slice(o,r).find("input");s.prop("checked",n),this.options.selectedClass&&s.closest("li").toggleClass(this.options.selectedClass,n);for(var l=0,u=s.length;l<u;l++){var c=t(s[l]);this.getOptionByValue(c.val()).prop("selected",n)}}i.trigger("change")}i.is("input")&&!i.closest("li").is(".multiselect-item")&&(this.lastToggledInput=i),i.blur()},this)),this.$container.off("keydown.multiselect").on("keydown.multiselect",t.proxy(function(e){if(!t('input[type="text"]',this.$container).is(":focus"))if(9===e.keyCode&&this.$container.hasClass("open"))this.$button.click();else{var i=t(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!i.length)return;var n=i.index(i.filter(":focus"));38===e.keyCode&&n>0?n--:40===e.keyCode&&n<i.length-1?n++:~n||(n=0);var o=i.eq(n);if(o.focus(),32===e.keyCode||13===e.keyCode){var r=o.find("input");r.prop("checked",!r.prop("checked")),r.change()}e.stopPropagation(),e.preventDefault()}},this)),this.options.enableClickableOptGroups&&this.options.multiple&&t("li.multiselect-group",this.$ul).on("click",t.proxy(function(e){e.stopPropagation();var i=!0,n=t(e.target).parent().nextUntil("li.multiselect-group").filter(":visible:not(.disabled)").find("input");n.each(function(){i=i&&t(this).prop("checked")}),n.prop("checked",!i).trigger("change")},this))},createOptionValue:function(e){var i=t(e);i.is(":selected")&&i.prop("selected",!0);var n=this.options.optionLabel(e),o=i.val(),r=this.options.multiple?"checkbox":"radio",a=t(this.options.templates.li),s=t("label",a);s.addClass(r),this.options.enableHTML?s.html(" "+n):s.text(" "+n);var l=t("<input/>").attr("type",r);this.options.checkboxName&&l.attr("name",this.options.checkboxName),s.prepend(l);var u=i.prop("selected")||!1;l.val(o),o===this.options.selectAllValue&&(a.addClass("multiselect-item multiselect-all"),l.parent().parent().addClass("multiselect-all")),s.attr("title",i.attr("title")),this.$ul.append(a),i.is(":disabled")&&l.attr("disabled","disabled").prop("disabled",!0).closest("a").attr("tabindex","-1").closest("li").addClass("disabled"),l.prop("checked",u),u&&this.options.selectedClass&&l.closest("li").addClass(this.options.selectedClass)},createDivider:function(e){var i=t(this.options.templates.divider);this.$ul.append(i)},createOptgroup:function(e){var i=t(e).prop("label"),n=t(this.options.templates.liGroup);this.options.enableHTML?t("label",n).html(i):t("label",n).text(i),this.options.enableClickableOptGroups&&n.addClass("multiselect-group-clickable"),this.$ul.append(n),t(e).is(":disabled")&&n.addClass("disabled"),t("option",e).each(t.proxy(function(t,e){this.createOptionValue(e)},this))},buildSelectAll:function(){if("number"==typeof this.options.selectAllValue&&(this.options.selectAllValue=this.options.selectAllValue.toString()),!this.hasSelectAll()&&this.options.includeSelectAllOption&&this.options.multiple&&t("option",this.$select).length>this.options.includeSelectAllIfMoreThan){this.options.includeSelectAllDivider&&this.$ul.prepend(t(this.options.templates.divider));var e=t(this.options.templates.li);t("label",e).addClass("checkbox"),this.options.enableHTML?t("label",e).html(" "+this.options.selectAllText):t("label",e).text(" "+this.options.selectAllText),this.options.selectAllName?t("label",e).prepend('<input type="checkbox" name="'+this.options.selectAllName+'" />'):t("label",e).prepend('<input type="checkbox" />');var i=t("input",e);i.val(this.options.selectAllValue),e.addClass("multiselect-item multiselect-all"),i.parent().parent().addClass("multiselect-all"),this.$ul.prepend(e),i.prop("checked",!1)}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var e=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=e){if(this.$filter=t(this.options.templates.filter),t("input",this.$filter).attr("placeholder",this.options.filterPlaceholder),this.options.includeFilterClearBtn){var i=t(this.options.templates.filterClearBtn);i.on("click",t.proxy(function(e){clearTimeout(this.searchTimeout),this.$filter.find(".multiselect-search").val(""),t("li",this.$ul).show().removeClass("filter-hidden"),this.updateSelectAll()},this)),this.$filter.find(".input-group").append(i)}this.$ul.prepend(this.$filter),this.$filter.val(this.query).on("click",function(t){t.stopPropagation()}).on("input keydown",t.proxy(function(e){13===e.which&&e.preventDefault(),clearTimeout(this.searchTimeout),this.searchTimeout=this.asyncFunction(t.proxy(function(){if(this.query!==e.target.value){this.query=e.target.value;var i,n;t.each(t("li",this.$ul),t.proxy(function(e,o){var r=t("input",o).length>0?t("input",o).val():"",a=t("label",o).text(),s="";if("text"===this.options.filterBehavior?s=a:"value"===this.options.filterBehavior?s=r:"both"===this.options.filterBehavior&&(s=a+"\n"+r),r!==this.options.selectAllValue&&a){var l=!1;this.options.enableCaseInsensitiveFiltering&&s.toLowerCase().indexOf(this.query.toLowerCase())>-1?l=!0:s.indexOf(this.query)>-1&&(l=!0),t(o).toggle(l).toggleClass("filter-hidden",!l),t(o).hasClass("multiselect-group")?(i=o,n=l):(l&&t(i).show().removeClass("filter-hidden"),!l&&n&&t(o).show().removeClass("filter-hidden"))}},this))}this.updateSelectAll()},this),300,this)},this))}}},destroy:function(){this.$container.remove(),this.$select.show(),this.$select.data("multiselect",null)},refresh:function(){t("option",this.$select).each(t.proxy(function(e,i){var n=t("li input",this.$ul).filter(function(){return t(this).val()===t(i).val()});t(i).is(":selected")?(n.prop("checked",!0),this.options.selectedClass&&n.closest("li").addClass(this.options.selectedClass)):(n.prop("checked",!1),this.options.selectedClass&&n.closest("li").removeClass(this.options.selectedClass)),t(i).is(":disabled")?n.attr("disabled","disabled").prop("disabled",!0).closest("li").addClass("disabled"):n.prop("disabled",!1).closest("li").removeClass("disabled")},this)),this.updateButtonText(),this.updateSelectAll()},select:function(e,i){t.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var o=e[n];if(null!==o&&void 0!==o){var r=this.getOptionByValue(o),a=this.getInputByValue(o);void 0!==r&&void 0!==a&&(this.options.multiple||this.deselectAll(!1),this.options.selectedClass&&a.closest("li").addClass(this.options.selectedClass),a.prop("checked",!0),r.prop("selected",!0),i&&this.options.onChange(r,!0))}}this.updateButtonText(),this.updateSelectAll()},clearSelection:function(){this.deselectAll(!1),this.updateButtonText(),this.updateSelectAll()},deselect:function(e,i){t.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var o=e[n];if(null!==o&&void 0!==o){var r=this.getOptionByValue(o),a=this.getInputByValue(o);void 0!==r&&void 0!==a&&(this.options.selectedClass&&a.closest("li").removeClass(this.options.selectedClass),a.prop("checked",!1),r.prop("selected",!1),i&&this.options.onChange(r,!1))}}this.updateButtonText(),this.updateSelectAll()},selectAll:function(e,i){var e=void 0===e||e,n=t("li input[type='checkbox']:enabled",this.$ul),o=n.filter(":visible"),r=n.length,a=o.length;if(e?(o.prop("checked",!0),t("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").addClass(this.options.selectedClass)):(n.prop("checked",!0),t("li:not(.divider):not(.disabled)",this.$ul).addClass(this.options.selectedClass)),r===a||!1===e)t("option:enabled",this.$select).prop("selected",!0);else{var s=o.map(function(){return t(this).val()}).get();t("option:enabled",this.$select).filter(function(e){return-1!==t.inArray(t(this).val(),s)}).prop("selected",!0)}i&&this.options.onSelectAll()},deselectAll:function(e){if(e=void 0===e||e){var i=t("li input[type='checkbox']:not(:disabled)",this.$ul).filter(":visible");i.prop("checked",!1);var n=i.map(function(){return t(this).val()}).get();t("option:enabled",this.$select).filter(function(e){return-1!==t.inArray(t(this).val(),n)}).prop("selected",!1),this.options.selectedClass&&t("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").removeClass(this.options.selectedClass)}else t("li input[type='checkbox']:enabled",this.$ul).prop("checked",!1),t("option:enabled",this.$select).prop("selected",!1),this.options.selectedClass&&t("li:not(.divider):not(.disabled)",this.$ul).removeClass(this.options.selectedClass)},rebuild:function(){this.$ul.html(""),this.options.multiple="multiple"===this.$select.attr("multiple"),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&t("option",this.$select).length<=0?this.disable():this.enable(),this.options.dropRight&&this.$ul.addClass("pull-right")},dataprovider:function(i){var n=0,o=this.$select.empty();t.each(i,function(i,r){var a;t.isArray(r.children)?(n++,a=t("<optgroup/>").attr({label:r.label||"Group "+n,disabled:!!r.disabled}),e(r.children,function(e){a.append(t("<option/>").attr({value:e.value,label:e.label||e.value,title:e.title,selected:!!e.selected,disabled:!!e.disabled}))})):a=t("<option/>").attr({value:r.value,label:r.label||r.value,title:r.title,selected:!!r.selected,disabled:!!r.disabled}),o.append(a)}),this.rebuild()},enable:function(){this.$select.prop("disabled",!1),this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0),this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(t){this.options=this.mergeOptions(t)},mergeOptions:function(e){return t.extend(!0,{},this.defaults,this.options,e)},hasSelectAll:function(){return t("li.multiselect-all",this.$ul).length>0},updateSelectAll:function(){if(this.hasSelectAll()){var e=t("li:not(.multiselect-item):not(.filter-hidden) input:enabled",this.$ul),i=e.length,n=e.filter(":checked").length,o=t("li.multiselect-all",this.$ul),r=o.find("input");n>0&&n===i?(r.prop("checked",!0),o.addClass(this.options.selectedClass),this.options.onSelectAll()):(r.prop("checked",!1),o.removeClass(this.options.selectedClass))}},updateButtonText:function(){var e=this.getSelected();this.options.enableHTML?t(".multiselect .multiselect-selected-text",this.$container).html(this.options.buttonText(e,this.$select)):t(".multiselect .multiselect-selected-text",this.$container).text(this.options.buttonText(e,this.$select)),t(".multiselect",this.$container).attr("title",this.options.buttonTitle(e,this.$select))},getSelected:function(){return t("option",this.$select).filter(":selected")},getOptionByValue:function(e){for(var i=t("option",this.$select),n=e.toString(),o=0;o<i.length;o+=1){var r=i[o];if(r.value===n)return t(r)}},getInputByValue:function(e){for(var i=t("li input",this.$ul),n=e.toString(),o=0;o<i.length;o+=1){var r=i[o];if(r.value===n)return t(r)}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(t,e,i){var n=Array.prototype.slice.call(arguments,3);return setTimeout(function(){t.apply(i||window,n)},e)},setAllSelectedText:function(t){this.options.allSelectedText=t,this.updateButtonText()}},t.fn.multiselect=function(e,n,o){return this.each(function(){var r=t(this).data("multiselect"),a="object"==typeof e&&e;r||(r=new i(this,a),t(this).data("multiselect",r)),"string"==typeof e&&(r[e](n,o),"destroy"===e&&t(this).data("multiselect",!1))})},t.fn.multiselect.Constructor=i,t(function(){t("select[data-role=multiselect]").multiselect()})}(window.jQuery),function(t){"use strict";jQuery.fn.multiselect.Constructor.prototype.selectAll=function(){var t=jQuery.fn.multiselect.Constructor.prototype.selectAll;return function(){var e=Array.prototype.slice.call(arguments);e[0]=(!this.options.enableCollapsibleOptGroups||!this.options.multiple)&&e[0],t.apply(this,e)}}(),jQuery.fn.multiselect.Constructor.prototype.deselectAll=function(){var t=jQuery.fn.multiselect.Constructor.prototype.deselectAll;return function(){var e=Array.prototype.slice.call(arguments);e[0]=(!this.options.enableCollapsibleOptGroups||!this.options.multiple)&&e[0],t.apply(this,e)}}(),jQuery.fn.multiselect.Constructor.prototype.createOptgroup=function(){var e=jQuery.fn.multiselect.Constructor.prototype.createOptgroup;return function(){var i=Array.prototype.slice.call(arguments)[0];if(this.options.enableCollapsibleOptGroups&&this.options.multiple){var n=t(i).attr("label"),o=t(i).attr("value"),r=t('<li class="multiselect-item multiselect-group"><a href="javascript:void(0);"><input type="checkbox" value="'+o+'"/><b> '+n+'<b class="caret"></b></b></a></li>');this.options.enableClickableOptGroups&&r.addClass("multiselect-group-clickable"),this.$ul.append(r),t(i).is(":disabled")&&r.addClass("disabled"),t("option",i).each(t.proxy(function(t,e){this.createOptionValue(e)},this))}else e.apply(this,arguments)}}(),jQuery.fn.multiselect.Constructor.prototype.buildDropdownOptions=function(){var e=jQuery.fn.multiselect.Constructor.prototype.buildDropdownOptions;return function(){e.apply(this,arguments),this.options.enableCollapsibleOptGroups&&this.options.multiple&&(t("li.multiselect-group input",this.$ul).off(),t("li.multiselect-group",this.$ul).siblings().not("li.multiselect-group, li.multiselect-all",this.$ul).each(function(){$(this).toggleClass("hidden",!0)}),t("li.multiselect-group",this.$ul).on("click",t.proxy(function(t){t.stopPropagation()},this)),t("li.multiselect-group > a > b",this.$ul).on("click",t.proxy(function(e){e.stopPropagation();var i=t(e.target).closest("li").nextUntil("li.multiselect-group"),n=!0;i.each(function(){n=n&&t(this).hasClass("hidden")}),i.toggleClass("hidden",!n)},this)),t("li.multiselect-group > a > input",this.$ul).on("change",t.proxy(function(e){e.stopPropagation();var i=!0,n=t(e.target).closest("li").nextUntil("li.multiselect-group").find("input");n.each(function(){i=i&&t(this).prop("checked")}),n.prop("checked",!i).trigger("change")},this)),t("li.multiselect-all",this.$ul).css("background","#f3f3f3").css("border-bottom","1px solid #eaeaea"),t("li.multiselect-group > a, li.multiselect-all > a > label.checkbox",this.$ul).css("padding","3px 20px 3px 35px"),t("li.multiselect-group > a > input",this.$ul).css("margin","4px 0px 5px -20px"))}}()}(window.jQuery),function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(t){var n="ekkoLightbox",o=t.fn[n],r={title:"",footer:"",maxWidth:9999,maxHeight:9999,showArrows:!0,wrapping:!0,type:null,alwaysShowClose:!1,loadingMessage:'<div class="ekko-lightbox-loader"><div><div></div><div></div></div></div>',leftArrow:"<span>&#10094;</span>",rightArrow:"<span>&#10095;</span>",strings:{close:"Close",fail:"Failed to load image:",type:"Could not detect remote target type. Force the type using data-type"},doc:document,onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNavigate:function(){},onContentLoaded:function(){}},a=function(){function n(i,o){var a=this;e(this,n),this._config=t.extend({},r,o),this._$modalArrows=null,this._galleryIndex=0,this._galleryName=null,this._padding=null,this._border=null,this._titleIsShown=!1,this._footerIsShown=!1,this._wantedWidth=0,this._wantedHeight=0,this._touchstartX=0,this._touchendX=0,this._modalId="ekkoLightbox-"+Math.floor(1e3*Math.random()+1),this._$element=i instanceof jQuery?i:t(i),this._isBootstrap3=3==t.fn.modal.Constructor.VERSION[0];var s='<h4 class="modal-title">'+(this._config.title||"&nbsp;")+"</h4>",l='<button type="button" class="close" data-dismiss="modal" aria-label="'+this._config.strings.close+'"><span aria-hidden="true">&times;</span></button>',u='<div class="modal-dialog" role="document"><div class="modal-content">'+('<div class="modal-header'+(this._config.title||this._config.alwaysShowClose?"":" hide")+'">'+(this._isBootstrap3?l+s:s+l)+"</div>")+'<div class="modal-body"><div class="ekko-lightbox-container"><div class="ekko-lightbox-item fade in show"></div><div class="ekko-lightbox-item fade"></div></div></div>'+('<div class="modal-footer'+(this._config.footer?"":" hide")+'">'+(this._config.footer||"&nbsp;")+"</div>")+"</div></div>";t(this._config.doc.body).append('<div id="'+this._modalId+'" class="ekko-lightbox modal fade" tabindex="-1" tabindex="-1" role="dialog" aria-hidden="true">'+u+"</div>"),this._$modal=t("#"+this._modalId,this._config.doc),this._$modalDialog=this._$modal.find(".modal-dialog").first(),this._$modalContent=this._$modal.find(".modal-content").first(),this._$modalBody=this._$modal.find(".modal-body").first(),this._$modalHeader=this._$modal.find(".modal-header").first(),this._$modalFooter=this._$modal.find(".modal-footer").first(),this._$lightboxContainer=this._$modalBody.find(".ekko-lightbox-container").first(),this._$lightboxBodyOne=this._$lightboxContainer.find("> div:first-child").first(),this._$lightboxBodyTwo=this._$lightboxContainer.find("> div:last-child").first(),this._border=this._calculateBorders(),this._padding=this._calculatePadding(),this._galleryName=this._$element.data("gallery"),this._galleryName&&(this._$galleryItems=t(document.body).find('*[data-gallery="'+this._galleryName+'"]'),this._galleryIndex=this._$galleryItems.index(this._$element),t(document).on("keydown.ekkoLightbox",this._navigationalBinder.bind(this)),this._config.showArrows&&this._$galleryItems.length>1&&(this._$lightboxContainer.append('<div class="ekko-lightbox-nav-overlay"><a href="#">'+this._config.leftArrow+'</a><a href="#">'+this._config.rightArrow+"</a></div>"),this._$modalArrows=this._$lightboxContainer.find("div.ekko-lightbox-nav-overlay").first(),this._$lightboxContainer.on("click","a:first-child",function(t){return t.preventDefault(),a.navigateLeft()}),this._$lightboxContainer.on("click","a:last-child",function(t){return t.preventDefault(),a.navigateRight()}),this.updateNavigation())),this._$modal.on("show.bs.modal",this._config.onShow.bind(this)).on("shown.bs.modal",function(){return a._toggleLoading(!0),a._handle(),a._config.onShown.call(a)}).on("hide.bs.modal",this._config.onHide.bind(this)).on("hidden.bs.modal",function(){return a._galleryName&&(t(document).off("keydown.ekkoLightbox"),t(window).off("resize.ekkoLightbox")),a._$modal.remove(),a._config.onHidden.call(a)}).modal(this._config),t(window).on("resize.ekkoLightbox",function(){a._resize(a._wantedWidth,a._wantedHeight)}),this._$lightboxContainer.on("touchstart",function(){a._touchstartX=event.changedTouches[0].screenX}).on("touchend",function(){a._touchendX=event.changedTouches[0].screenX,a._swipeGesure()})}return i(n,null,[{key:"Default",get:function(){return r}}]),i(n,[{key:"element",value:function(){return this._$element}},{key:"modal",value:function(){return this._$modal}},{key:"navigateTo",value:function(e){if(e<0||e>this._$galleryItems.length-1)return this;this._galleryIndex=e,this.updateNavigation(),this._$element=t(this._$galleryItems.get(this._galleryIndex)),this._handle()}},{key:"navigateLeft",value:function(){if(this._$galleryItems&&1!==this._$galleryItems.length){if(0===this._galleryIndex){if(!this._config.wrapping)return;this._galleryIndex=this._$galleryItems.length-1}else this._galleryIndex--;return this._config.onNavigate.call(this,"left",this._galleryIndex),this.navigateTo(this._galleryIndex)}}},{key:"navigateRight",value:function(){if(this._$galleryItems&&1!==this._$galleryItems.length){if(this._galleryIndex===this._$galleryItems.length-1){if(!this._config.wrapping)return;this._galleryIndex=0}else this._galleryIndex++;return this._config.onNavigate.call(this,"right",this._galleryIndex),this.navigateTo(this._galleryIndex)}}},{key:"updateNavigation",value:function(){if(!this._config.wrapping){var t=this._$lightboxContainer.find("div.ekko-lightbox-nav-overlay");0===this._galleryIndex?t.find("a:first-child").addClass("disabled"):t.find("a:first-child").removeClass("disabled"),this._galleryIndex===this._$galleryItems.length-1?t.find("a:last-child").addClass("disabled"):t.find("a:last-child").removeClass("disabled")}}},{key:"close",value:function(){return this._$modal.modal("hide")}},{key:"_navigationalBinder",value:function(t){return 39===(t=t||window.event).keyCode?this.navigateRight():37===t.keyCode?this.navigateLeft():void 0}},{key:"_detectRemoteType",value:function(t,e){return!(e=e||!1)&&this._isImage(t)&&(e="image"),!e&&this._getYoutubeId(t)&&(e="youtube"),!e&&this._getVimeoId(t)&&(e="vimeo"),!e&&this._getInstagramId(t)&&(e="instagram"),(!e||["image","youtube","vimeo","instagram","video","url"].indexOf(e)<0)&&(e="url"),e}},{key:"_isImage",value:function(t){return t&&t.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)}},{key:"_containerToUse",value:function(){var t=this,e=this._$lightboxBodyTwo,i=this._$lightboxBodyOne;return this._$lightboxBodyTwo.hasClass("in")&&(e=this._$lightboxBodyOne,i=this._$lightboxBodyTwo),i.removeClass("in show"),setTimeout(function(){t._$lightboxBodyTwo.hasClass("in")||t._$lightboxBodyTwo.empty(),t._$lightboxBodyOne.hasClass("in")||t._$lightboxBodyOne.empty()},500),e.addClass("in show"),e}},{key:"_handle",value:function(){var t=this._containerToUse();this._updateTitleAndFooter();var e=this._$element.attr("data-remote")||this._$element.attr("href"),i=this._detectRemoteType(e,this._$element.attr("data-type")||!1);if(["image","youtube","vimeo","instagram","video","url"].indexOf(i)<0)return this._error(this._config.strings.type);switch(i){case"image":this._preloadImage(e,t),this._preloadImageByIndex(this._galleryIndex,3);break;case"youtube":this._showYoutubeVideo(e,t);break;case"vimeo":this._showVimeoVideo(this._getVimeoId(e),t);break;case"instagram":this._showInstagramVideo(this._getInstagramId(e),t);break;case"video":this._showHtml5Video(e,t);break;default:this._loadRemoteContent(e,t)}return this}},{key:"_getYoutubeId",value:function(t){if(!t)return!1;var e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return!(!e||11!==e[2].length)&&e[2]}},{key:"_getVimeoId",value:function(t){return!!(t&&t.indexOf("vimeo")>0)&&t}},{key:"_getInstagramId",value:function(t){return!!(t&&t.indexOf("instagram")>0)&&t}},{key:"_toggleLoading",value:function(e){return(e=e||!1)?(this._$modalDialog.css("display","none"),this._$modal.removeClass("in show"),t(".modal-backdrop").append(this._config.loadingMessage)):(this._$modalDialog.css("display","block"),this._$modal.addClass("in show"),t(".modal-backdrop").find(".ekko-lightbox-loader").remove()),this}},{key:"_calculateBorders",value:function(){return{top:this._totalCssByAttribute("border-top-width"),right:this._totalCssByAttribute("border-right-width"),bottom:this._totalCssByAttribute("border-bottom-width"),left:this._totalCssByAttribute("border-left-width")}}},{key:"_calculatePadding",value:function(){return{top:this._totalCssByAttribute("padding-top"),right:this._totalCssByAttribute("padding-right"),bottom:this._totalCssByAttribute("padding-bottom"),left:this._totalCssByAttribute("padding-left")}}},{key:"_totalCssByAttribute",value:function(t){return parseInt(this._$modalDialog.css(t),10)+parseInt(this._$modalContent.css(t),10)+parseInt(this._$modalBody.css(t),10)}},{key:"_updateTitleAndFooter",value:function(){var t=this._$element.data("title")||"",e=this._$element.data("footer")||"";return this._titleIsShown=!1,t||this._config.alwaysShowClose?(this._titleIsShown=!0,this._$modalHeader.css("display","").find(".modal-title").html(t||"&nbsp;")):this._$modalHeader.css("display","none"),this._footerIsShown=!1,e?(this._footerIsShown=!0,this._$modalFooter.css("display","").html(e)):this._$modalFooter.css("display","none"),this}},{key:"_showYoutubeVideo",value:function(t,e){var i=this._getYoutubeId(t),n=t.indexOf("&")>0?t.substr(t.indexOf("&")):"",o=this._$element.data("width")||560,r=this._$element.data("height")||o/(560/315);return this._showVideoIframe("//www.youtube.com/embed/"+i+"?badge=0&autoplay=1&html5=1"+n,o,r,e)}},{key:"_showVimeoVideo",value:function(t,e){var i=this._$element.data("width")||500,n=this._$element.data("height")||i/(560/315);return this._showVideoIframe(t+"?autoplay=1",i,n,e)}},{key:"_showInstagramVideo",value:function(t,e){var i=this._$element.data("width")||612,n=i+80;return t="/"!==t.substr(-1)?t+"/":t,e.html('<iframe width="'+i+'" height="'+n+'" src="'+t+'embed/" frameborder="0" allowfullscreen></iframe>'),this._resize(i,n),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_showVideoIframe",value:function(t,e,i,n){return i=i||e,n.html('<div class="embed-responsive embed-responsive-16by9"><iframe width="'+e+'" height="'+i+'" src="'+t+'" frameborder="0" allowfullscreen class="embed-responsive-item"></iframe></div>'),this._resize(e,i),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_showHtml5Video",value:function(t,e){var i=this._$element.data("width")||560,n=this._$element.data("height")||i/(560/315);return e.html('<div class="embed-responsive embed-responsive-16by9"><video width="'+i+'" height="'+n+'" src="'+t+'" preload="auto" autoplay controls class="embed-responsive-item"></video></div>'),this._resize(i,n),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_loadRemoteContent",value:function(e,i){var n=this,o=this._$element.data("width")||560,r=this._$element.data("height")||560,a=this._$element.data("disableExternalCheck")||!1;return this._toggleLoading(!1),a||this._isExternal(e)?(i.html('<iframe src="'+e+'" frameborder="0" allowfullscreen></iframe>'),this._config.onContentLoaded.call(this)):i.load(e,t.proxy(function(){return n._$element.trigger("loaded.bs.modal")})),this._$modalArrows&&this._$modalArrows.css("display","none"),this._resize(o,r),this}},{key:"_isExternal",value:function(t){var e=t.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof e[1]&&e[1].length>0&&e[1].toLowerCase()!==location.protocol||"string"==typeof e[2]&&e[2].length>0&&e[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host}},{key:"_error",value:function(t){return console.error(t),this._containerToUse().html(t),this._resize(300,300),this}},{key:"_preloadImageByIndex",value:function(e,i){if(this._$galleryItems){var n=t(this._$galleryItems.get(e),!1);if(void 0!==n){var o=n.attr("data-remote")||n.attr("href");return("image"===n.attr("data-type")||this._isImage(o))&&this._preloadImage(o,!1),i>0?this._preloadImageByIndex(e+1,i-1):void 0}}}},{key:"_preloadImage",value:function(e,i){var n=this;i=i||!1;var o=new Image;return i&&function(){var r=setTimeout(function(){i.append(n._config.loadingMessage)},200);o.onload=function(){r&&clearTimeout(r),r=null;var e=t("<img />");return e.attr("src",o.src),e.addClass("img-fluid"),e.css("width","100%"),i.html(e),n._$modalArrows&&n._$modalArrows.css("display",""),n._resize(o.width,o.height),n._toggleLoading(!1),n._config.onContentLoaded.call(n)},o.onerror=function(){return n._toggleLoading(!1),n._error(n._config.strings.fail+"  "+e)}}(),o.src=e,o}},{key:"_swipeGesure",value:function(){return this._touchendX<this._touchstartX?this.navigateRight():this._touchendX>this._touchstartX?this.navigateLeft():void 0}},{key:"_resize",value:function(e,i){i=i||e,this._wantedWidth=e,this._wantedHeight=i;var n=e/i,o=this._padding.left+this._padding.right+this._border.left+this._border.right,r=this._config.doc.body.clientWidth>575?20:0,a=this._config.doc.body.clientWidth>575?0:20,s=Math.min(e+o,this._config.doc.body.clientWidth-r,this._config.maxWidth);e+o>s?(i=(s-o-a)/n,e=s):e+=o;var l=0,u=0;this._footerIsShown&&(u=this._$modalFooter.outerHeight(!0)||55),this._titleIsShown&&(l=this._$modalHeader.outerHeight(!0)||67);var c=this._padding.top+this._padding.bottom+this._border.bottom+this._border.top,h=parseFloat(this._$modalDialog.css("margin-top"))+parseFloat(this._$modalDialog.css("margin-bottom")),p=Math.min(i,t(window).height()-c-h-l-u,this._config.maxHeight-c-l-u);i>p&&(e=Math.ceil(p*n)+o),this._$lightboxContainer.css("height",p),this._$modalDialog.css("flex",1).css("maxWidth",e);var f=this._$modal.data("bs.modal");if(f)try{f._handleUpdate()}catch(t){f.handleUpdate()}return this}}],[{key:"_jQueryInterface",value:function(e){var i=this;return e=e||{},this.each(function(){var o=t(i),r=t.extend({},n.Default,o.data(),"object"==typeof e&&e);new n(i,r)})}}]),n}();t.fn[n]=a._jQueryInterface,t.fn[n].Constructor=a,t.fn[n].noConflict=function(){return t.fn[n]=o,a._jQueryInterface}}(jQuery)}(jQuery),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).mapboxgl=t()}}(function(){return function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){!function(t,n){"object"==typeof i&&void 0!==e?e.exports=n():t.glMatrix=n()}(this,function(){"use strict";(function(){var t=new Float32Array(3);t[0]=0,t[1]=0,t[2]=0})(),function(){var t=new Float32Array(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0}();return{vec3:{transformMat3:function(t,e,i){var n=e[0],o=e[1],r=e[2];return t[0]=n*i[0]+o*i[3]+r*i[6],t[1]=n*i[1]+o*i[4]+r*i[7],t[2]=n*i[2]+o*i[5]+r*i[8],t}},vec4:{transformMat4:function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3];return t[0]=i[0]*n+i[4]*o+i[8]*r+i[12]*a,t[1]=i[1]*n+i[5]*o+i[9]*r+i[13]*a,t[2]=i[2]*n+i[6]*o+i[10]*r+i[14]*a,t[3]=i[3]*n+i[7]*o+i[11]*r+i[15]*a,t}},mat2:{create:function(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},rotate:function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+r*s,t[1]=o*l+a*s,t[2]=n*-s+r*l,t[3]=o*-s+a*l,t},scale:function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3],s=i[0],l=i[1];return t[0]=n*s,t[1]=o*s,t[2]=r*l,t[3]=a*l,t}},mat3:{create:function(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromRotation:function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},mat4:{create:function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},translate:function(t,e,i){var n,o,r,a,s,l,u,c,h,p,f,d,m=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(n=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=n,t[1]=o,t[2]=r,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=n*m+s*g+h*y+e[12],t[13]=o*m+l*g+p*y+e[13],t[14]=r*m+u*g+f*y+e[14],t[15]=a*m+c*g+d*y+e[15]),t},scale:function(t,e,i){var n=i[0],o=i[1],r=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},multiply:function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=i[0],x=i[1],b=i[2],w=i[3];return t[0]=_*n+x*s+b*h+w*m,t[1]=_*o+x*l+b*p+w*g,t[2]=_*r+x*u+b*f+w*y,t[3]=_*a+x*c+b*d+w*v,_=i[4],x=i[5],b=i[6],w=i[7],t[4]=_*n+x*s+b*h+w*m,t[5]=_*o+x*l+b*p+w*g,t[6]=_*r+x*u+b*f+w*y,t[7]=_*a+x*c+b*d+w*v,_=i[8],x=i[9],b=i[10],w=i[11],t[8]=_*n+x*s+b*h+w*m,t[9]=_*o+x*l+b*p+w*g,t[10]=_*r+x*u+b*f+w*y,t[11]=_*a+x*c+b*d+w*v,_=i[12],x=i[13],b=i[14],w=i[15],t[12]=_*n+x*s+b*h+w*m,t[13]=_*o+x*l+b*p+w*g,t[14]=_*r+x*u+b*f+w*y,t[15]=_*a+x*c+b*d+w*v,t},perspective:function(t,e,i,n,o){var r=1/Math.tan(e/2),a=1/(n-o);return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*n*a,t[15]=0,t},rotateX:function(t,e,i){var n=Math.sin(i),o=Math.cos(i),r=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*o+u*n,t[5]=a*o+c*n,t[6]=s*o+h*n,t[7]=l*o+p*n,t[8]=u*o-r*n,t[9]=c*o-a*n,t[10]=h*o-s*n,t[11]=p*o-l*n,t},rotateZ:function(t,e,i){var n=Math.sin(i),o=Math.cos(i),r=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*o+u*n,t[1]=a*o+c*n,t[2]=s*o+h*n,t[3]=l*o+p*n,t[4]=u*o-r*n,t[5]=c*o-a*n,t[6]=h*o-s*n,t[7]=p*o-l*n,t},invert:function(t,e){var i=e[0],n=e[1],o=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],m=e[13],g=e[14],y=e[15],v=i*s-n*a,_=i*l-o*a,x=i*u-r*a,b=n*l-o*s,w=n*u-r*s,T=o*u-r*l,E=c*m-h*d,C=c*g-p*d,S=c*y-f*d,A=h*g-p*m,k=h*y-f*m,I=p*y-f*g,L=v*I-_*k+x*A+b*S-w*C+T*E;return L?(L=1/L,t[0]=(s*I-l*k+u*A)*L,t[1]=(o*k-n*I-r*A)*L,t[2]=(m*T-g*w+y*b)*L,t[3]=(p*w-h*T-f*b)*L,t[4]=(l*S-a*I-u*C)*L,t[5]=(i*I-o*S+r*C)*L,t[6]=(g*x-d*T-y*_)*L,t[7]=(c*T-p*x+f*_)*L,t[8]=(a*k-s*S+u*E)*L,t[9]=(n*S-i*k-r*E)*L,t[10]=(d*w-m*x+y*v)*L,t[11]=(h*x-c*w-f*v)*L,t[12]=(s*C-a*A-l*E)*L,t[13]=(i*A-n*C+o*E)*L,t[14]=(m*_-d*b-g*v)*L,t[15]=(c*b-h*_+p*v)*L,t):null},ortho:function(t,e,i,n,o,r,a){var s=1/(e-i),l=1/(n-o),u=1/(r-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(o+n)*l,t[14]=(a+r)*u,t[15]=1,t}}}})},{}],2:[function(t,e,i){!function(t,n){"object"==typeof i&&void 0!==e?e.exports=n():t.ShelfPack=n()}(this,function(){function t(t,e,i){i=i||{},this.w=t||64,this.h=e||64,this.autoResize=!!i.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,i){this.x=0,this.y=t,this.w=this.free=e,this.h=i}function i(t,e,i,n,o,r,a){this.id=t,this.x=e,this.y=i,this.w=n,this.h=o,this.maxw=r||n,this.maxh=a||o,this.refcount=0}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var i,n,o,r,a=[],s=0;s<t.length;s++)if(i=t[s].w||t[s].width,n=t[s].h||t[s].height,o=t[s].id,i&&n){if(!(r=this.packOne(i,n,o)))continue;e.inPlace&&(t[s].x=r.x,t[s].y=r.y,t[s].id=r.id),a.push(r)}if(this.shelves.length>0){for(var l=0,u=0,c=0;c<this.shelves.length;c++){var h=this.shelves[c];u+=h.h,l=Math.max(h.w-h.free,l)}this.resize(l,u)}return a},t.prototype.packOne=function(t,i,n){var o,r,a,s,l={freebin:-1,shelf:-1,waste:1/0},u=0;if("string"==typeof n||"number"==typeof n){if(o=this.getBin(n))return this.ref(o),o;"number"==typeof n&&(this.maxId=Math.max(n,this.maxId))}else n=++this.maxId;for(s=0;s<this.freebins.length;s++){if(o=this.freebins[s],i===o.maxh&&t===o.maxw)return this.allocFreebin(s,t,i,n);i>o.maxh||t>o.maxw||i<=o.maxh&&t<=o.maxw&&(a=o.maxw*o.maxh-t*i)<l.waste&&(l.waste=a,l.freebin=s)}for(s=0;s<this.shelves.length;s++)if(r=this.shelves[s],u+=r.h,!(t>r.free)){if(i===r.h)return this.allocShelf(s,t,i,n);i>r.h||i<r.h&&(a=(r.h-i)*t)<l.waste&&(l.freebin=-1,l.waste=a,l.shelf=s)}if(-1!==l.freebin)return this.allocFreebin(l.freebin,t,i,n);if(-1!==l.shelf)return this.allocShelf(l.shelf,t,i,n);if(i<=this.h-u&&t<=this.w)return r=new e(u,this.w,i),this.allocShelf(this.shelves.push(r)-1,t,i,n);if(this.autoResize){var c,h,p,f;return c=h=this.h,((p=f=this.w)<=c||t>p)&&(f=2*Math.max(t,p)),(c<p||i>c)&&(h=2*Math.max(i,c)),this.resize(f,h),this.packOne(t,i,n)}return null},t.prototype.allocFreebin=function(t,e,i,n){var o=this.freebins.splice(t,1)[0];return o.id=n,o.w=e,o.h=i,o.refcount=0,this.bins[n]=o,this.ref(o),o},t.prototype.allocShelf=function(t,e,i,n){var o=this.shelves[t].alloc(e,i,n);return this.bins[n]=o,this.ref(o),o},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var i=0;i<this.shelves.length;i++)this.shelves[i].resize(t);return!0},e.prototype.alloc=function(t,e,n){if(t>this.free||e>this.h)return null;var o=this.x;return this.x+=t,this.free-=t,new i(n,o,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t})},{}],3:[function(t,e,i){"use strict";function n(t,e,i,n,o,r){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=o||"sans-serif",this.fontWeight=r||"normal",this.radius=i||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,i,n,o,a,s){for(var l=0;l<e;l++){for(var u=0;u<i;u++)n[u]=t[u*e+l];for(r(n,o,a,s,i),u=0;u<i;u++)t[u*e+l]=o[u]}for(u=0;u<i;u++){for(l=0;l<e;l++)n[l]=t[u*e+l];for(r(n,o,a,s,e),l=0;l<e;l++)t[u*e+l]=Math.sqrt(o[l])}}function r(t,e,i,n,o){i[0]=0,n[0]=-a,n[1]=+a;for(var r=1,s=0;r<o;r++){for(var l=(t[r]+r*r-(t[i[s]]+i[s]*i[s]))/(2*r-2*i[s]);l<=n[s];)s--,l=(t[r]+r*r-(t[i[s]]+i[s]*i[s]))/(2*r-2*i[s]);i[++s]=r,n[s]=l,n[s+1]=+a}for(r=0,s=0;r<o;r++){for(;n[s+1]<r;)s++;e[r]=(r-i[s])*(r-i[s])+t[i[s]]}}e.exports=n;var a=1e20;n.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var r=e.data[4*n+3]/255;this.gridOuter[n]=1===r?0:0===r?a:Math.pow(Math.max(0,.5-r),2),this.gridInner[n]=1===r?a:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++){var s=this.gridOuter[n]-this.gridInner[n];i[n]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return i}},{}],4:[function(t,e,i){function n(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=i,this.p2y=n}e.exports=n,n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){void 0===e&&(e=1e-6);var i,n,o,r,a;for(o=t,a=0;a<8;a++){if(r=this.sampleCurveX(o)-t,Math.abs(r)<e)return o;var s=this.sampleCurveDerivativeX(o);if(Math.abs(s)<1e-6)break;o-=r/s}if(i=0,n=1,(o=t)<i)return i;if(o>n)return n;for(;i<n;){if(r=this.sampleCurveX(o),Math.abs(r-t)<e)return o;t>r?i=o:n=o,o=.5*(n-i)+i}return o},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],5:[function(t,e,i){!function(t,n){n("object"==typeof i&&void 0!==e?i:t.WhooTS=t.WhooTS||{})}(this,function(t){function e(t,e,n){var o=i(256*t,256*(e=Math.pow(2,n)-e-1),n),r=i(256*(t+1),256*(e+1),n);return o[0]+","+o[1]+","+r[0]+","+r[1]}function i(t,e,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[t*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}t.getURL=function(t,i,n,o,r,a){return a=a||{},t+"?"+["bbox="+e(n,o,r),"format="+(a.format||"image/png"),"service="+(a.service||"WMS"),"version="+(a.version||"1.1.1"),"request="+(a.request||"GetMap"),"srs="+(a.srs||"EPSG:3857"),"width="+(a.width||256),"height="+(a.height||256),"layers="+i].join("&")},t.getTileBBox=e,t.getMercCoords=i,Object.defineProperty(t,"__esModule",{value:!0})})},{}],6:[function(t,e,i){(function(i){"use strict";function n(t,e){if(t===e)return 0;for(var i=t.length,n=e.length,o=0,r=Math.min(i,n);o<r;++o)if(t[o]!==e[o]){i=t[o],n=e[o];break}return i<n?-1:n<i?1:0}function o(t){return i.Buffer&&"function"==typeof i.Buffer.isBuffer?i.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}function r(t){return Object.prototype.toString.call(t)}function a(t){return!o(t)&&("function"==typeof i.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}function s(t){if(x.isFunction(t)){if(T)return t.name;var e=t.toString().match(C);return e&&e[1]}}function l(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function u(t){if(T||!x.isFunction(t))return x.inspect(t);var e=s(t);return"[Function"+(e?": "+e:"")+"]"}function c(t){return l(u(t.actual),128)+" "+t.operator+" "+l(u(t.expected),128)}function h(t,e,i,n,o){throw new E.AssertionError({message:i,actual:t,expected:e,operator:n,stackStartFunction:o})}function p(t,e){t||h(t,!0,e,"==",E.ok)}function f(t,e,i,s){if(t===e)return!0;if(o(t)&&o(e))return 0===n(t,e);if(x.isDate(t)&&x.isDate(e))return t.getTime()===e.getTime();if(x.isRegExp(t)&&x.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(a(t)&&a(e)&&r(t)===r(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var l=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),m(t,e,i,s))}return i?t===e:t==e}function d(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function m(t,e,i,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(x.isPrimitive(t)||x.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=d(t),r=d(e);if(o&&!r||!o&&r)return!1;if(o)return t=w.call(t),e=w.call(e),f(t,e,i);var a,s,l=S(t),u=S(e);if(l.length!==u.length)return!1;for(l.sort(),u.sort(),s=l.length-1;s>=0;s--)if(l[s]!==u[s])return!1;for(s=l.length-1;s>=0;s--)if(a=l[s],!f(t[a],e[a],i,n))return!1;return!0}function g(t,e,i){f(t,e,!0)&&h(t,e,i,"notDeepStrictEqual",g)}function y(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function v(t){var e;try{t()}catch(t){e=t}return e}function _(t,e,i,n){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),o=v(e),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),t&&!o&&h(o,i,"Missing expected exception"+n);var r="string"==typeof n,a=!t&&x.isError(o),s=!t&&o&&!i;if((a&&r&&y(o,i)||s)&&h(o,i,"Got unwanted exception"+n),t&&o&&i&&!y(o,i)||!t&&o)throw o}var x=t("util/"),b=Object.prototype.hasOwnProperty,w=Array.prototype.slice,T="foo"===function(){}.name,E=e.exports=p,C=/\s*function\s+([^\(\s]*)\s*/;E.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var e=t.stackStartFunction||h;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var i=new Error;if(i.stack){var n=i.stack,o=s(e),r=n.indexOf("\n"+o);if(r>=0){var a=n.indexOf("\n",r+1);n=n.substring(a+1)}this.stack=n}}},x.inherits(E.AssertionError,Error),E.fail=h,E.ok=p,E.equal=function(t,e,i){t!=e&&h(t,e,i,"==",E.equal)},E.notEqual=function(t,e,i){t==e&&h(t,e,i,"!=",E.notEqual)},E.deepEqual=function(t,e,i){f(t,e,!1)||h(t,e,i,"deepEqual",E.deepEqual)},E.deepStrictEqual=function(t,e,i){f(t,e,!0)||h(t,e,i,"deepStrictEqual",E.deepStrictEqual)},E.notDeepEqual=function(t,e,i){f(t,e,!1)&&h(t,e,i,"notDeepEqual",E.notDeepEqual)},E.notDeepStrictEqual=g,E.strictEqual=function(t,e,i){t!==e&&h(t,e,i,"===",E.strictEqual)},E.notStrictEqual=function(t,e,i){t===e&&h(t,e,i,"!==",E.notStrictEqual)},E.throws=function(t,e,i){_(!0,t,e,i)},E.doesNotThrow=function(t,e,i){_(!1,t,e,i)},E.ifError=function(t){if(t)throw t};var S=Object.keys||function(t){var e=[];for(var i in t)b.call(t,i)&&e.push(i);return e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":44}],7:[function(t,e,i){function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function o(t){return t<0?0:t>1?1:t}function r(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return o("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function s(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{i.parseCSSColor=function(t){var e=t.replace(/ /g,"").toLowerCase();if(e in l)return l[e].slice();if("#"===e[0]){if(4===e.length)return(i=parseInt(e.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null;if(7===e.length){var i=parseInt(e.substr(1),16);return i>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null}return null}var o=e.indexOf("("),u=e.indexOf(")");if(-1!==o&&u+1===e.length){var c=e.substr(0,o),h=e.substr(o+1,u-(o+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),m=a(h[2]),g=m<=.5?m*(d+1):m+d-m*d,y=2*m-g;return[n(255*s(y,g,f+1/3)),n(255*s(y,g,f)),n(255*s(y,g,f-1/3)),p];default:return null}}return null}}catch(t){}},{}],8:[function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:t.length,s=o(t,0,r,i,!0),l=[];if(!s)return l;var u,c,p,f,d,m,g;if(n&&(s=h(t,e,s,i)),t.length>80*i){u=p=t[0],c=f=t[1];for(var y=i;y<r;y+=i)d=t[y],m=t[y+1],d<u&&(u=d),m<c&&(c=m),d>p&&(p=d),m>f&&(f=m);g=Math.max(p-u,f-c)}return a(s,l,i,u,c,g),l}function o(t,e,i,n,o){var r,a;if(o===D(t,e,i,n)>0)for(r=e;r<i;r+=n)a=k(r,t[r],t[r+1],a);else for(r=i-n;r>=e;r-=n)a=k(r,t[r],t[r+1],a);return a&&w(a,a.next)&&(I(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!w(n,n.next)&&0!==b(n.prev,n,n.next))n=n.next;else{if(I(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function a(t,e,i,n,o,h,p){if(t){!p&&h&&m(t,n,o,h);for(var f,d,g=t;t.prev!==t.next;)if(f=t.prev,d=t.next,h?l(t,n,o,h):s(t))e.push(f.i/i),e.push(t.i/i),e.push(d.i/i),I(t),t=d.next,g=d.next;else if((t=d)===g){p?1===p?a(t=u(t,e,i),e,i,n,o,h,2):2===p&&c(t,e,i,n,o,h):a(r(t),e,i,n,o,h,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(b(e,i,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(_(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&b(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(t,e,i,n){var o=t.prev,r=t,a=t.next;if(b(o,r,a)>=0)return!1;for(var s=o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,l=o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,u=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,c=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,h=y(s,l,e,i,n),p=y(u,c,e,i,n),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&_(o.x,o.y,r.x,r.y,a.x,a.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&_(o.x,o.y,r.x,r.y,a.x,a.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function u(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!w(o,r)&&T(o,n,n.next,r)&&C(o,r)&&C(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),I(n),I(n.next),n=t=r),n=n.next}while(n!==t);return n}function c(t,e,i,n,o,s){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&x(l,u)){var c=A(l,u);return l=r(l,l.next),c=r(c,c.next),a(l,e,i,n,o,s),void a(c,e,i,n,o,s)}u=u.next}l=l.next}while(l!==t)}function h(t,e,i,n){var a,s,l,u=[];for(a=0,s=e.length;a<s;a++)(l=o(t,e[a]*n,a<s-1?e[a+1]*n:t.length,n,!1))===l.next&&(l.steiner=!0),u.push(v(l));for(u.sort(p),a=0;a<u.length;a++)f(u[a],i),i=r(i,i.next);return i}function p(t,e){return t.x-e.x}function f(t,e){if(e=d(t,e)){var i=A(e,t);r(i,i.next)}}function d(t,e){var i,n=e,o=t.x,r=t.y,a=-1/0;do{if(r<=n.y&&r>=n.next.y){var s=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=o&&s>a){if(a=s,s===o){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===a)return i.prev;var l,u=i,c=i.x,h=i.y,p=1/0;for(n=i.next;n!==u;)o>=n.x&&n.x>=c&&_(r<h?o:a,r,c,h,r<h?a:o,r,n.x,n.y)&&((l=Math.abs(r-n.y)/(o-n.x))<p||l===p&&n.x>i.x)&&C(n,t)&&(i=n,p=l),n=n.next;return i}function m(t,e,i,n){var o=t;do{null===o.z&&(o.z=y(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,g(o)}function g(t){var e,i,n,o,r,a,s,l,u=1;do{for(i=t,t=null,r=null,a=0;i;){for(a++,n=i,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0===s?(o=n,n=n.nextZ,l--):0!==l&&n?i.z<=n.z?(o=i,i=i.nextZ,s--):(o=n,n=n.nextZ,l--):(o=i,i=i.nextZ,s--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;i=n}r.nextZ=null,u*=2}while(a>1);return t}function y(t,e,i,n,o){return t=32767*(t-i)/o,e=32767*(e-n)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function v(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function _(t,e,i,n,o,r,a,s){return(o-a)*(e-s)-(t-a)*(r-s)>=0&&(t-a)*(n-s)-(i-a)*(e-s)>=0&&(i-a)*(r-s)-(o-a)*(n-s)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!E(t,e)&&C(t,e)&&C(e,t)&&S(t,e)}function b(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function T(t,e,i,n){return!!(w(t,e)&&w(i,n)||w(t,n)&&w(i,e))||b(t,e,i)>0!=b(t,e,n)>0&&b(i,n,t)>0!=b(i,n,e)>0}function E(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&T(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function C(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function S(t,e){var i=t,n=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&o<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function A(t,e){var i=new L(t.i,t.x,t.y),n=new L(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function k(t,e,i,n){var o=new L(t,e,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(t,e,i,n){for(var o=0,r=e,a=i-n;r<i;r+=n)o+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return o}e.exports=n,n.deviation=function(t,e,i,n){var o=e&&e.length,r=o?e[0]*i:t.length,a=Math.abs(D(t,0,r,i));if(o)for(var s=0,l=e.length;s<l;s++){var u=e[s]*i,c=s<l-1?e[s+1]*i:t.length;a-=Math.abs(D(t,u,c,i))}var h=0;for(s=0;s<n.length;s+=3){var p=n[s]*i,f=n[s+1]*i,d=n[s+2]*i;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var a=0;a<e;a++)i.vertices.push(t[o][r][a]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i}},{}],9:[function(t,e,i){function n(t){var e,i,o,u,c,h;switch(typeof t){case"object":if(null===t)return null;if(r(t)){for(o="[",i=t.length-1,e=0;e<i;e++)o+=n(t[e])+",";return i>-1&&(o+=n(t[e])),o+"]"}for(i=(u=a(t).sort()).length,o="{",c=u[e=0],h=i>0&&void 0!==t[c];e<i;)h?(o+='"'+c.replace(s,l)+'":'+n(t[c]),c=u[++e],(h=e<i&&void 0!==t[c])&&(o+=",")):(c=u[++e],h=e<i&&void 0!==t[c]);return o+"}";case"undefined":return null;case"string":return'"'+t.replace(s,l)+'"';default:return t}}var o={}.toString,r=Array.isArray||function(t){return"[object Array]"===o.call(t)},a=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},s=/[\u0000-\u001f"\\]/g,l=function(t){var e=t.charCodeAt(0);switch(e){case 34:return'\\"';case 92:return"\\\\";case 12:return"\\f";case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 8:return"\\b";default:return e>15?"\\u00"+e.toString(16):"\\u000"+e.toString(16)}};e.exports=function(t){if(void 0!==t)return""+n(t)},e.exports.stringSearch=s,e.exports.stringReplace=l},{}],10:[function(t,e,i){function n(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(o(t[i]))}return e}function o(t){var e=0;if(t.length>2){for(var i,n,o=0;o<t.length-1;o++)i=t[o],e+=r((n=t[o+1])[0]-i[0])*(2+Math.sin(r(i[1]))+Math.sin(r(n[1])));e=e*a.RADIUS*a.RADIUS/2}return e}function r(t){return t*Math.PI/180}var a=t("wgs84");e.exports.geometry=function(t){if("Polygon"===t.type)return n(t.coordinates);if("MultiPolygon"===t.type){for(var e=0,i=0;i<t.coordinates.length;i++)e+=n(t.coordinates[i]);return e}return null},e.exports.ring=o},{wgs84:53}],11:[function(t,e,i){function n(t,e){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(o(n,e)),t;case"Feature":return t.geometry=n(t.geometry,e),t;case"Polygon":case"MultiPolygon":return r(t,e);default:return t}}function o(t,e){return function(i){return t(i,e)}}function r(t,e){return"Polygon"===t.type?t.coordinates=a(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(o(a,e))),t}function a(t,e){e=!!e,t[0]=s(t[0],!e);for(var i=1;i<t.length;i++)t[i]=s(t[i],e);return t}function s(t,e){return l(t)===e?t:t.reverse()}function l(t){return u.ring(t)>=0}var u=t("geojson-area");e.exports=n},{"geojson-area":10}],12:[function(t,e,i){"use strict";function n(t,e,i,n){for(var o=[],r=0;r<t.length;r++){var a=t[r],s=a[n];s>=e&&s<=i&&o.push(a)}return o}function o(t,e,i,n,o,a){for(var s=[],l=0;l<t.length;l++){var u,c,h,p=0,f=0,d=null,m=t[l],g=m.area,y=m.dist,v=m.outer,_=m.length,x=[];for(c=0;c<_-1;c++)u=d||m[c],d=m[c+1],p=f||u[n],f=d[n],p<e?f>i?(x.push(o(u,d,e),o(u,d,i)),a||(x=r(s,x,g,y,v))):f>=e&&x.push(o(u,d,e)):p>i?f<e?(x.push(o(u,d,i),o(u,d,e)),a||(x=r(s,x,g,y,v))):f<=i&&x.push(o(u,d,i)):(x.push(u),f<e?(x.push(o(u,d,e)),a||(x=r(s,x,g,y,v))):f>i&&(x.push(o(u,d,i)),a||(x=r(s,x,g,y,v))));(p=(u=m[_-1])[n])>=e&&p<=i&&x.push(u),h=x[x.length-1],a&&h&&(x[0][0]!==h[0]||x[0][1]!==h[1])&&x.push(x[0]),r(s,x,g,y,v)}return s}function r(t,e,i,n,o){return e.length&&(e.area=i,e.dist=n,void 0!==o&&(e.outer=o),t.push(e)),[]}e.exports=function(t,e,i,r,s,l,u,c){if(i/=e,r/=e,u>=i&&c<=r)return t;if(u>r||c<i)return null;for(var h=[],p=0;p<t.length;p++){var f,d,m=t[p],g=m.geometry,y=m.type;if(f=m.min[s],d=m.max[s],f>=i&&d<=r)h.push(m);else if(!(f>r||d<i)){var v=1===y?n(g,i,r,s):o(g,i,r,s,l,3===y);v.length&&h.push(a(m.tags,y,v,m.id))}}return h.length?h:null};var a=t("./feature")},{"./feature":14}],13:[function(t,e,i){"use strict";function n(t,e,i){if(null!==e.geometry){var a,s,u,c,h=e.geometry,p=h.type,f=h.coordinates,d=e.properties,m=e.id;if("Point"===p)t.push(l(d,1,[r(f)],m));else if("MultiPoint"===p)t.push(l(d,1,o(f),m));else if("LineString"===p)t.push(l(d,2,[o(f,i)],m));else if("MultiLineString"===p||"Polygon"===p){for(u=[],a=0;a<f.length;a++)c=o(f[a],i),"Polygon"===p&&(c.outer=0===a),u.push(c);t.push(l(d,"Polygon"===p?3:2,u,m))}else if("MultiPolygon"===p){for(u=[],a=0;a<f.length;a++)for(s=0;s<f[a].length;s++)(c=o(f[a][s],i)).outer=0===s,u.push(c);t.push(l(d,3,u,m))}else{if("GeometryCollection"!==p)throw new Error("Input data is not a valid GeoJSON object.");for(a=0;a<h.geometries.length;a++)n(t,{geometry:h.geometries[a],properties:d},i)}}}function o(t,e){for(var i=[],n=0;n<t.length;n++)i.push(r(t[n]));return e&&(s(i,e),a(i)),i}function r(t){var e=Math.sin(t[1]*Math.PI/180),i=t[0]/360+.5,n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n=n<0?0:n>1?1:n,[i,n,0]}function a(t){for(var e,i,n=0,o=0,r=0;r<t.length-1;r++)e=i||t[r],i=t[r+1],n+=e[0]*i[1]-i[0]*e[1],o+=Math.abs(i[0]-e[0])+Math.abs(i[1]-e[1]);t.area=Math.abs(n/2),t.dist=o}e.exports=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var o=0;o<t.features.length;o++)n(i,t.features[o],e);else"Feature"===t.type?n(i,t,e):n(i,{geometry:t},e);return i};var s=t("./simplify"),l=t("./feature")},{"./feature":14,"./simplify":16}],14:[function(t,e,i){"use strict";function n(t){var e=t.geometry,i=t.min,n=t.max;if(1===t.type)o(i,n,e);else for(var r=0;r<e.length;r++)o(i,n,e[r]);return t}function o(t,e,i){for(var n,o=0;o<i.length;o++)n=i[o],t[0]=Math.min(n[0],t[0]),e[0]=Math.max(n[0],e[0]),t[1]=Math.min(n[1],t[1]),e[1]=Math.max(n[1],e[1])}e.exports=function(t,e,i,o){var r={id:o||null,type:e,geometry:i,tags:t||null,min:[1/0,1/0],max:[-1/0,-1/0]};return n(r),r}},{}],15:[function(t,e,i){"use strict";function n(t,e){var i=(e=this.options=s(Object.create(this.options),e)).debug;i&&console.time("preprocess data");var n=1<<e.maxZoom,o=u(t,e.tolerance/(n*e.extent));this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(o=p(o,e.buffer/e.extent,r)).length&&this.splitTile(o,0,0,0),i&&(o.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e,i){return 32*((1<<t)*i+e)+t}function r(t,e,i){return[i,(i-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function a(t,e,i){return[(i-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],i,1]}function s(t,e){for(var i in e)t[i]=e[i];return t}function l(t,e,i){var n=t.source;if(1!==n.length)return!1;var o=n[0];if(3!==o.type||o.geometry.length>1)return!1;var r=o.geometry[0].length;if(5!==r)return!1;for(var a=0;a<r;a++){var s=c.point(o.geometry[0][a],e,t.z2,t.x,t.y);if(s[0]!==-i&&s[0]!==e+i||s[1]!==-i&&s[1]!==e+i)return!1}return!0}e.exports=function(t,e){return new n(t,e)};var u=t("./convert"),c=t("./transform"),h=t("./clip"),p=t("./wrap"),f=t("./tile");n.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},n.prototype.splitTile=function(t,e,i,n,s,u,c){for(var p=[t,e,i,n],d=this.options,m=d.debug,g=null;p.length;){n=p.pop(),i=p.pop(),e=p.pop(),t=p.pop();var y=1<<e,v=o(e,i,n),_=this.tiles[v],x=e===d.maxZoom?0:d.tolerance/(y*d.extent);if(!_&&(m>1&&console.time("creation"),_=this.tiles[v]=f(t,y,i,n,x,e===d.maxZoom),this.tileCoords.push({z:e,x:i,y:n}),m)){m>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,_.numFeatures,_.numPoints,_.numSimplified),console.timeEnd("creation"));var b="z"+e;this.stats[b]=(this.stats[b]||0)+1,this.total++}if(_.source=t,s){if(e===d.maxZoom||e===s)continue;var w=1<<s-e;if(i!==Math.floor(u/w)||n!==Math.floor(c/w))continue}else if(e===d.indexMaxZoom||_.numPoints<=d.indexMaxPoints)continue;if(d.solidChildren||!l(_,d.extent,d.buffer)){_.source=null,m>1&&console.time("clipping");var T,E,C,S,A,k,I=.5*d.buffer/d.extent,L=.5-I,D=.5+I,P=1+I;T=E=C=S=null,A=h(t,y,i-I,i+D,0,r,_.min[0],_.max[0]),k=h(t,y,i+L,i+P,0,r,_.min[0],_.max[0]),A&&(T=h(A,y,n-I,n+D,1,a,_.min[1],_.max[1]),E=h(A,y,n+L,n+P,1,a,_.min[1],_.max[1])),k&&(C=h(k,y,n-I,n+D,1,a,_.min[1],_.max[1]),S=h(k,y,n+L,n+P,1,a,_.min[1],_.max[1])),m>1&&console.timeEnd("clipping"),t.length&&(p.push(T||[],e+1,2*i,2*n),p.push(E||[],e+1,2*i,2*n+1),p.push(C||[],e+1,2*i+1,2*n),p.push(S||[],e+1,2*i+1,2*n+1))}else s&&(g=e)}return g},n.prototype.getTile=function(t,e,i){var n=this.options,r=n.extent,a=n.debug,s=1<<t,u=o(t,e=(e%s+s)%s,i);if(this.tiles[u])return c.tile(this.tiles[u],r);a>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var h,p=t,f=e,d=i;!h&&p>0;)p--,f=Math.floor(f/2),d=Math.floor(d/2),h=this.tiles[o(p,f,d)];if(!h||!h.source)return null;if(a>1&&console.log("found parent tile z%d-%d-%d",p,f,d),l(h,r,n.buffer))return c.tile(h,r);a>1&&console.time("drilling down");var m=this.splitTile(h.source,p,f,d,t,e,i);if(a>1&&console.timeEnd("drilling down"),null!==m){var g=1<<t-m;u=o(m,Math.floor(e/g),Math.floor(i/g))}return this.tiles[u]?c.tile(this.tiles[u],r):null}},{"./clip":12,"./convert":13,"./tile":17,"./transform":18,"./wrap":19}],16:[function(t,e,i){"use strict";function n(t,e,i){var n=e[0],o=e[1],r=i[0],a=i[1],s=t[0],l=t[1],u=r-n,c=a-o;if(0!==u||0!==c){var h=((s-n)*u+(l-o)*c)/(u*u+c*c);h>1?(n=r,o=a):h>0&&(n+=u*h,o+=c*h)}return u=s-n,c=l-o,u*u+c*c}e.exports=function(t,e){var i,o,r,a,s=e*e,l=0,u=t.length-1,c=[];for(t[l][2]=1,t[u][2]=1;u;){for(o=0,i=l+1;i<u;i++)(r=n(t[i],t[l],t[u]))>o&&(a=i,o=r);o>s?(t[a][2]=o,c.push(l),c.push(a),l=a):(u=c.pop(),l=c.pop())}}},{}],17:[function(t,e,i){"use strict";function n(t,e,i,n){var r,a,s,l,u=e.geometry,c=e.type,h=[],p=i*i;if(1===c)for(r=0;r<u.length;r++)h.push(u[r]),t.numPoints++,t.numSimplified++;else for(r=0;r<u.length;r++)if(s=u[r],n||!(2===c&&s.dist<i||3===c&&s.area<p)){var f=[];for(a=0;a<s.length;a++)l=s[a],(n||l[2]>p)&&(f.push(l),t.numSimplified++),t.numPoints++;3===c&&o(f,s.outer),h.push(f)}else t.numPoints+=s.length;if(h.length){var d={geometry:h,type:c,tags:e.tags||null};null!==e.id&&(d.id=e.id),t.features.push(d)}}function o(t,e){r(t)<0===e&&t.reverse()}function r(t){for(var e,i,n=0,o=0,r=t.length,a=r-1;o<r;a=o++)e=t[o],n+=((i=t[a])[0]-e[0])*(e[1]+i[1]);return n}e.exports=function(t,e,i,o,r,a){for(var s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:o,z2:e,transformed:!1,min:[2,1],max:[-1,0]},l=0;l<t.length;l++){s.numFeatures++,n(s,t[l],r,a);var u=t[l].min,c=t[l].max;u[0]<s.min[0]&&(s.min[0]=u[0]),u[1]<s.min[1]&&(s.min[1]=u[1]),c[0]>s.max[0]&&(s.max[0]=c[0]),c[1]>s.max[1]&&(s.max[1]=c[1])}return s}},{}],18:[function(t,e,i){"use strict";function n(t,e,i,n,o){return[Math.round(e*(t[0]*i-n)),Math.round(e*(t[1]*i-o))]}i.tile=function(t,e){if(t.transformed)return t;var i,o,r,a=t.z2,s=t.x,l=t.y;for(i=0;i<t.features.length;i++){var u=t.features[i],c=u.geometry;if(1===u.type)for(o=0;o<c.length;o++)c[o]=n(c[o],e,a,s,l);else for(o=0;o<c.length;o++){var h=c[o];for(r=0;r<h.length;r++)h[r]=n(h[r],e,a,s,l)}}return t.transformed=!0,t},i.point=n},{}],19:[function(t,e,i){"use strict";function n(t,e){for(var i=[],n=0;n<t.length;n++){var r,s=t[n],l=s.type;if(1===l)r=o(s.geometry,e);else{r=[];for(var u=0;u<s.geometry.length;u++)r.push(o(s.geometry[u],e))}i.push(a(s.tags,l,r,s.id))}return i}function o(t,e){var i=[];i.area=t.area,i.dist=t.dist;for(var n=0;n<t.length;n++)i.push([t[n][0]+e,t[n][1],t[n][2]]);return i}var r=t("./clip"),a=t("./feature");e.exports=function(t,e,i){var o=t,a=r(t,1,-1-e,e,0,i,-1,2),s=r(t,1,1-e,2+e,0,i,-1,2);return(a||s)&&(o=r(t,1,-e,1+e,0,i,-1,2)||[],a&&(o=n(a,1).concat(o)),s&&(o=o.concat(n(s,-1)))),o}},{"./clip":12,"./feature":14}],20:[function(t,e,i){"use strict";function n(t,e,i){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],e=r[1],i=r[2],this.d=e+2*i;for(var a=0;a<this.d*this.d;a++){var s=r[o+a],l=r[o+a+1];n.push(s===l?null:r.subarray(s,l))}var u=r[o+n.length],c=r[o+n.length+1];this.keys=r.subarray(u,c),this.bboxes=r.subarray(c),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var h=0;h<this.d*this.d;h++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var p=i/e*t;this.min=-p,this.max=t+p}e.exports=n;var o=3;n.prototype.insert=function(t,e,i,n,o){this._forEachCell(e,i,n,o,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(o)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(t,e,i,n,o,r){this.cells[o].push(r)},n.prototype.query=function(t,e,i,n){var o=this.min,r=this.max;if(t<=o&&e<=o&&r<=i&&r<=n)return Array.prototype.slice.call(this.keys);var a=[],s={};return this._forEachCell(t,e,i,n,this._queryCell,a,s),a},n.prototype._queryCell=function(t,e,i,n,o,r,a){var s=this.cells[o];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var h=s[c];if(void 0===a[h]){var p=4*h;t<=u[p+2]&&e<=u[p+3]&&i>=u[p+0]&&n>=u[p+1]?(a[h]=!0,r.push(l[h])):a[h]=!1}}},n.prototype._forEachCell=function(t,e,i,n,o,r,a){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(i),c=this._convertToCellCoord(n),h=s;h<=u;h++)for(var p=l;p<=c;p++){var f=this.d*p+h;if(o.call(this,t,e,i,n,f,r,a))return}},n.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=o+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var r=new Int32Array(e+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var a=e,s=0;s<t.length;s++){var l=t[s];r[o+s]=a,r.set(l,a),a+=l.length}return r[o+t.length]=a,r.set(this.keys,a),a+=this.keys.length,r[o+t.length+1]=a,r.set(this.bboxes,a),a+=this.bboxes.length,r.buffer}},{}],21:[function(t,e,i){i.read=function(t,e,i,n,o){var r,a,s=8*o-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?o-1:0,p=i?-1:1,f=t[e+h];for(h+=p,r=f&(1<<-c)-1,f>>=-c,c+=s;c>0;r=256*r+t[e+h],h+=p,c-=8);for(a=r&(1<<-c)-1,r>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===r)r=1-u;else{if(r===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),r-=u}return(f?-1:1)*a*Math.pow(2,r-n)},i.write=function(t,e,i,n,o,r){var a,s,l,u=8*r-o-1,c=(1<<u)-1,h=c>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:r-1,d=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;t[i+f]=255&s,f+=d,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[i+f]=255&a,f+=d,a/=256,u-=8);t[i+f-d]|=128*m}},{}],22:[function(t,e,i){"use strict";function n(t,e,i,n,s){e=e||o,i=i||r,s=s||Array,this.nodeSize=n||64,this.points=t,this.ids=new s(t.length),this.coords=new s(2*t.length);for(var l=0;l<t.length;l++)this.ids[l]=l,this.coords[2*l]=e(t[l]),this.coords[2*l+1]=i(t[l]);a(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function o(t){return t[0]}function r(t){return t[1]}var a=t("./sort"),s=t("./range"),l=t("./within");e.exports=function(t,e,i,o,r){return new n(t,e,i,o,r)},n.prototype={range:function(t,e,i,n){return s(this.ids,this.coords,t,e,i,n,this.nodeSize)},within:function(t,e,i){return l(this.ids,this.coords,t,e,i,this.nodeSize)}}},{"./range":23,"./sort":24,"./within":25}],23:[function(t,e,i){"use strict";e.exports=function(t,e,i,n,o,r,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),f=u.pop();if(p-f<=a)for(var d=f;d<=p;d++)s=e[2*d],l=e[2*d+1],s>=i&&s<=o&&l>=n&&l<=r&&c.push(t[d]);else{var m=Math.floor((f+p)/2);s=e[2*m],l=e[2*m+1],s>=i&&s<=o&&l>=n&&l<=r&&c.push(t[m]);var g=(h+1)%2;(0===h?i<=s:n<=l)&&(u.push(f),u.push(m-1),u.push(g)),(0===h?o>=s:r>=l)&&(u.push(m+1),u.push(p),u.push(g))}}return c}},{}],24:[function(t,e,i){"use strict";function n(t,e,i,r,a,s){if(!(a-r<=i)){var l=Math.floor((r+a)/2);o(t,e,l,r,a,s%2),n(t,e,i,r,l-1,s+1),n(t,e,i,l+1,a,s+1)}}function o(t,e,i,n,a,s){for(;a>n;){if(a-n>600){var l=a-n+1,u=i-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1);o(t,e,i,Math.max(n,Math.floor(i-u*h/l+p)),Math.min(a,Math.floor(i+(l-u)*h/l+p)),s)}var f=e[2*i+s],d=n,m=a;for(r(t,e,n,i),e[2*a+s]>f&&r(t,e,n,a);d<m;){for(r(t,e,d,m),d++,m--;e[2*d+s]<f;)d++;for(;e[2*m+s]>f;)m--}e[2*n+s]===f?r(t,e,n,m):r(t,e,++m,a),m<=i&&(n=m+1),i<=m&&(a=m-1)}}function r(t,e,i,n){a(t,i,n),a(e,2*i,2*n),a(e,2*i+1,2*n+1)}function a(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}e.exports=n},{}],25:[function(t,e,i){"use strict";function n(t,e,i,n){var o=t-i,r=e-n;return o*o+r*r}e.exports=function(t,e,i,o,r,a){for(var s=[0,t.length-1,0],l=[],u=r*r;s.length;){var c=s.pop(),h=s.pop(),p=s.pop();if(h-p<=a)for(var f=p;f<=h;f++)n(e[2*f],e[2*f+1],i,o)<=u&&l.push(t[f]);else{var d=Math.floor((p+h)/2),m=e[2*d],g=e[2*d+1];n(m,g,i,o)<=u&&l.push(t[d]);var y=(c+1)%2;(0===c?i-r<=m:o-r<=g)&&(s.push(p),s.push(d-1),s.push(y)),(0===c?i+r>=m:o+r>=g)&&(s.push(d+1),s.push(h),s.push(y))}}return l}},{}],26:[function(t,e,i){function n(t){return!!t&&"object"==typeof t}function o(t,e){for(var i=-1,n=t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function r(t,e,i,o,s,l){return t===e||(null==t||null==e||!c(t)&&!n(e)?t!==t&&e!==e:a(t,e,r,i,o,s,l))}function a(t,e,i,n,o,r,a){var c=h(t),f=h(e),g=m,y=m;c||((g=C.call(t))==d?g=x:g!=x&&(c=p(t))),f||((y=C.call(e))==d?y=x:y!=x&&(f=p(e)));var v=g==x,_=y==x,b=g==y;if(b&&!c&&!v)return l(t,e,g);if(!o){var w=v&&E.call(t,"__wrapped__"),T=_&&E.call(e,"__wrapped__");if(w||T)return i(w?t.value():t,T?e.value():e,n,o,r,a)}if(!b)return!1;r||(r=[]),a||(a=[]);for(var S=r.length;S--;)if(r[S]==t)return a[S]==e;r.push(t),a.push(e);var A=(c?s:u)(t,e,i,n,o,r,a);return r.pop(),a.pop(),A}function s(t,e,i,n,r,a,s){var l=-1,u=t.length,c=e.length;if(u!=c&&!(r&&c>u))return!1;for(;++l<u;){var h=t[l],p=e[l],f=n?n(r?p:h,r?h:p,l):void 0;if(void 0!==f){if(f)continue;return!1}if(r){if(!o(e,function(t){return h===t||i(h,t,n,r,a,s)}))return!1}else if(h!==p&&!i(h,p,n,r,a,s))return!1}return!0}function l(t,e,i){switch(i){case g:case y:return+t==+e;case v:return t.name==e.name&&t.message==e.message;case _:return t!=+t?e!=+e:t==+e;case b:case w:return t==e+""}return!1}function u(t,e,i,n,o,r,a){var s=f(t),l=s.length;if(l!=f(e).length&&!o)return!1;for(var u=l;u--;){var c=s[u];if(!(o?c in e:E.call(e,c)))return!1}for(var h=o;++u<l;){var p=t[c=s[u]],d=e[c],m=n?n(o?d:p,o?p:d,c):void 0;if(!(void 0===m?i(p,d,n,o,r,a):m))return!1;h||(h="constructor"==c)}if(!h){var g=t.constructor,y=e.constructor;if(g!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y))return!1}return!0}function c(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var h=t("lodash.isarray"),p=t("lodash.istypedarray"),f=t("lodash.keys"),d="[object Arguments]",m="[object Array]",g="[object Boolean]",y="[object Date]",v="[object Error]",_="[object Number]",x="[object Object]",b="[object RegExp]",w="[object String]",T=Object.prototype,E=T.hasOwnProperty,C=T.toString;e.exports=r},{"lodash.isarray":30,"lodash.istypedarray":32,"lodash.keys":33}],27:[function(t,e,i){function n(t){return t}e.exports=function(t,e,i){if("function"!=typeof t)return n;if(void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,r){return t.call(e,i,n,o,r)};case 5:return function(i,n,o,r,a){return t.call(e,i,n,o,r,a)}}return function(){return t.apply(e,arguments)}}},{}],28:[function(t,e,i){function n(t){return!!t&&"object"==typeof t}function o(t){return r(t)&&p.call(t)==s}function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return null!=t&&(o(t)?f.test(c.call(t)):n(t)&&l.test(t))}var s="[object Function]",l=/^\[object .+?Constructor\]$/,u=Object.prototype,c=Function.prototype.toString,h=u.hasOwnProperty,p=u.toString,f=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t,e){var i=null==t?void 0:t[e];return a(i)?i:void 0}},{}],29:[function(t,e,i){function n(t){return null!=t&&a(t.length)&&!r(t)}function o(t){return l(t)&&n(t)}function r(t){var e=s(t)?m.call(t):"";return e==h||e==p}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function l(t){return!!t&&"object"==typeof t}var u=9007199254740991,c="[object Arguments]",h="[object Function]",p="[object GeneratorFunction]",f=Object.prototype,d=f.hasOwnProperty,m=f.toString,g=f.propertyIsEnumerable;e.exports=function(t){return o(t)&&d.call(t,"callee")&&(!g.call(t,"callee")||m.call(t)==c)}},{}],30:[function(t,e,i){function n(t){return!!t&&"object"==typeof t}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=m}function r(t){return a(t)&&f.call(t)==l}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return null!=t&&(r(t)?d.test(h.call(t)):n(t)&&u.test(t))}var l="[object Function]",u=/^\[object .+?Constructor\]$/,c=Object.prototype,h=Function.prototype.toString,p=c.hasOwnProperty,f=c.toString,d=RegExp("^"+h.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),m=9007199254740991,g=function(t,e){var i=null==t?void 0:t[e];return s(i)?i:void 0}(Array,"isArray")||function(t){return n(t)&&o(t.length)&&"[object Array]"==f.call(t)};e.exports=g},{}],31:[function(t,e,i){var n=t("lodash._baseisequal"),o=t("lodash._bindcallback");e.exports=function(t,e,i,r){var a=(i="function"==typeof i?o(i,r,3):void 0)?i(t,e):void 0;return void 0===a?n(t,e,i):!!a}},{"lodash._baseisequal":26,"lodash._bindcallback":27}],32:[function(t,e,i){function n(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}function o(t){return!!t&&"object"==typeof t}var r=9007199254740991,a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=Object.prototype.toString;e.exports=function(t){return o(t)&&n(t.length)&&!!a[s.call(t)]}},{}],33:[function(t,e,i){function n(t){return null!=t&&r(g(t))}function o(t,e){return t="number"==typeof t||p.test(t)?+t:-1,e=null==e?m:e,t>-1&&t%1==0&&t<e}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=m}function a(t){for(var e=l(t),i=e.length,n=i&&t.length,a=!!n&&r(n)&&(h(t)||c(t)),s=-1,u=[];++s<i;){var p=e[s];(a&&o(p,n)||f.call(t,p))&&u.push(p)}return u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function l(t){if(null==t)return[];s(t)||(t=Object(t));var e=t.length;e=e&&r(e)&&(h(t)||c(t))&&e||0;for(var i=t.constructor,n=-1,a="function"==typeof i&&i.prototype===t,l=Array(e),u=e>0;++n<e;)l[n]=n+"";for(var p in t)u&&o(p,e)||"constructor"==p&&(a||!f.call(t,p))||l.push(p);return l}var u=t("lodash._getnative"),c=t("lodash.isarguments"),h=t("lodash.isarray"),p=/^\d+$/,f=Object.prototype.hasOwnProperty,d=u(Object,"keys"),m=9007199254740991,g=function(t){return function(e){return null==e?void 0:e[t]}}("length"),y=d?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&n(t)?a(t):s(t)?d(t):[]}:a;e.exports=y},{"lodash._getnative":28,"lodash.isarguments":29,"lodash.isarray":30}],34:[function(t,e,i){"use strict";function n(t){return!!(o()&&r()&&a()&&s()&&l()&&u()&&c()&&h(t&&t.failIfMajorPerformanceCaveat))}function o(){return"undefined"!=typeof window&&"undefined"!=typeof document}function r(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function a(){return Function.prototype&&Function.prototype.bind}function s(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function l(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function u(){return"Worker"in window}function c(){return"Uint8ClampedArray"in window}function h(t){return void 0===f[t]&&(f[t]=p(t)),f[t]}function p(t){var e=document.createElement("canvas"),i=Object.create(n.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,e.probablySupportsContext?e.probablySupportsContext("webgl",i)||e.probablySupportsContext("experimental-webgl",i):e.supportsContext?e.supportsContext("webgl",i)||e.supportsContext("experimental-webgl",i):e.getContext("webgl",i)||e.getContext("experimental-webgl",i)}void 0!==e&&e.exports?e.exports=n:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=n);var f={};n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],35:[function(t,e,i){"use strict";function n(t){var e;t&&t.length&&(t=(e=t).length);var i=new Uint8Array(t||0);return e&&i.set(e),i.readUInt32LE=r.readUInt32LE,i.writeUInt32LE=r.writeUInt32LE,i.readInt32LE=r.readInt32LE,i.writeInt32LE=r.writeInt32LE,i.readFloatLE=r.readFloatLE,i.writeFloatLE=r.writeFloatLE,i.readDoubleLE=r.readDoubleLE,i.writeDoubleLE=r.writeDoubleLE,i.toString=r.toString,i.write=r.write,i.slice=r.slice,i.copy=r.copy,i._isBuffer=!0,i}function o(t){for(var e,i,n=t.length,o=[],r=0;r<n;r++){if((e=t.charCodeAt(r))>55295&&e<57344){if(!i){e>56319||r+1===n?o.push(239,191,189):i=e;continue}if(e<56320){o.push(239,191,189),i=e;continue}e=i-55296<<10|e-56320|65536,i=null}else i&&(o.push(239,191,189),i=null);e<128?o.push(e):e<2048?o.push(e>>6|192,63&e|128):e<65536?o.push(e>>12|224,e>>6&63|128,63&e|128):o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}return o}e.exports=n;var r,a,s,l=t("ieee754");(r={readUInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},writeUInt32LE:function(t,e){this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24},readInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+(this[t+3]<<24)},readFloatLE:function(t){return l.read(this,t,!0,23,4)},readDoubleLE:function(t){return l.read(this,t,!0,52,8)},writeFloatLE:function(t,e){return l.write(this,t,e,!0,23,4)},writeDoubleLE:function(t,e){return l.write(this,t,e,!0,52,8)},toString:function(t,e,i){var n="",o="";e=e||0,i=Math.min(this.length,i||this.length);for(var r=e;r<i;r++){var a=this[r];a<=127?(n+=decodeURIComponent(o)+String.fromCharCode(a),o=""):o+="%"+a.toString(16)}return n+=decodeURIComponent(o)},write:function(t,e){for(var i=t===a?s:o(t),n=0;n<i.length;n++)this[e+n]=i[n]},slice:function(t,e){return this.subarray(t,e)},copy:function(t,e){e=e||0;for(var i=0;i<this.length;i++)t[e+i]=this[i]}}).writeInt32LE=r.writeUInt32LE,n.byteLength=function(t){return a=t,(s=o(t)).length},n.isBuffer=function(t){return!(!t||!t._isBuffer)}},{ieee754:21}],36:[function(t,e,i){(function(i){"use strict";function n(t){this.buf=g.isBuffer(t)?t:new g(t||0),this.pos=0,this.length=this.buf.length}function o(t,e){var i,n=e.buf;if(i=n[e.pos++],t+=268435456*(127&i),i<128)return t;if(i=n[e.pos++],t+=34359738368*(127&i),i<128)return t;if(i=n[e.pos++],t+=4398046511104*(127&i),i<128)return t;if(i=n[e.pos++],t+=562949953421312*(127&i),i<128)return t;if(i=n[e.pos++],t+=72057594037927940*(127&i),i<128)return t;if(i=n[e.pos++],t+=0x8000000000000000*(127&i),i<128)return t;throw new Error("Expected varint not more than 10 bytes")}function r(t,e){e.realloc(10);for(var i=e.pos+10;t>=1;){if(e.pos>=i)throw new Error("Given varint doesn't fit into 10 bytes");var n=255&t;e.buf[e.pos++]=n|(t>=128?128:0),t/=128}}function a(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var o=i.pos-1;o>=t;o--)i.buf[o+n]=i.buf[o]}function s(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function u(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}e.exports=n;var g=i.Buffer||t("./buffer");n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var y=Math.pow(2,63);n.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),o=n>>3,r=this.pos;t(o,e,this),this.pos===r&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=this.buf.readUInt32LE(this.pos);return this.pos+=4,t},readSFixed32:function(){var t=this.buf.readInt32LE(this.pos);return this.pos+=4,t},readFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readUInt32LE(this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readInt32LE(this.pos+4);return this.pos+=8,t},readFloat:function(){var t=this.buf.readFloatLE(this.pos);return this.pos+=4,t},readDouble:function(){var t=this.buf.readDoubleLE(this.pos);return this.pos+=8,t},readVarint:function(){var t,e,i=this.buf;return e=i[this.pos++],t=127&e,e<128?t:(e=i[this.pos++],t|=(127&e)<<7,e<128?t:(e=i[this.pos++],t|=(127&e)<<14,e<128?t:(e=i[this.pos++],t|=(127&e)<<21,e<128?t:o(t,this))))},readVarint64:function(){var t=this.pos,e=this.readVarint();if(e<y)return e;for(var i=this.pos-2;255===this.buf[i];)i--;i<t&&(i=t),e=0;for(var n=0;n<i-t+1;n++){var o=127&~this.buf[t+n];e+=n<4?o<<7*n:o*Math.pow(2,7*n)}return-e-1},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.buf.toString("utf8",this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.slice(this.pos,t);return this.pos=t,e},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readVarint());return e},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(t){var e=7&t;if(e===n.Varint)for(;this.buf[this.pos++]>127;);else if(e===n.Bytes)this.pos=this.readVarint()+this.pos;else if(e===n.Fixed32)this.pos+=4;else{if(e!==n.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new g(e);this.buf.copy(i),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(t){this.realloc(4),this.buf.writeUInt32LE(t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),this.buf.writeInt32LE(t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeUInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t)>268435455?r(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t);var e=g.byteLength(t);this.writeVarint(e),this.realloc(e),this.buf.write(t,this.pos),this.pos+=e},writeFloat:function(t){this.realloc(4),this.buf.writeFloatLE(t,this.pos),this.pos+=4},writeDouble:function(t){this.realloc(8),this.buf.writeDoubleLE(t,this.pos),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){var i=++this.pos;t(e,this);var n=this.pos-i;n>=128&&a(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,n.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,s,e)},writePackedSVarint:function(t,e){this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){this.writeMessage(t,h,e)},writePackedFloat:function(t,e){this.writeMessage(t,u,e)},writePackedDouble:function(t,e){this.writeMessage(t,c,e)},writePackedFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,f,e)},writePackedFixed64:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,m,e)},writeBytesField:function(t,e){this.writeTag(t,n.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,n.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,n.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,n.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":35}],37:[function(t,e,i){"use strict";function n(t,e){this.x=t,this.y=e}e.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y,o=i*this.x+e*this.y;return this.x=n,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},{}],38:[function(t,e,i){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(h===setTimeout)return setTimeout(t,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function a(t){if(p===clearTimeout)return clearTimeout(t);if((p===o||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function s(){g&&d&&(g=!1,d.length?m=d.concat(m):y=-1,m.length&&l())}function l(){if(!g){var t=r(s);g=!0;for(var e=m.length;e;){for(d=m,m=[];++y<e;)d&&d[y].run();y=-1,e=m.length}d=null,g=!1,a(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var h,p,f=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(t){h=n}try{p="function"==typeof clearTimeout?clearTimeout:o}catch(t){p=o}}();var d,m=[],g=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];m.push(new u(t,e)),1!==m.length||g||r(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],39:[function(t,e,i){"use strict";function n(t,e,i,a,s){for(i=i||0,a=a||t.length-1,s=s||r;a>i;){if(a-i>600){var l=a-i+1,u=e-i+1,c=Math.log(l),h=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1);n(t,e,Math.max(i,Math.floor(e-u*h/l+p)),Math.min(a,Math.floor(e+(l-u)*h/l+p)),s)}var f=t[e],d=i,m=a;for(o(t,i,e),s(t[a],f)>0&&o(t,i,a);d<m;){for(o(t,d,m),d++,m--;s(t[d],f)<0;)d++;for(;s(t[m],f)>0;)m--}0===s(t[i],f)?o(t,i,m):o(t,++m,a),m<=e&&(i=m+1),e<=m&&(a=m-1)}}function o(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function r(t,e){return t<e?-1:t>e?1:0}e.exports=n},{}],40:[function(t,e,i){"use strict";function n(t){this.options=p(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function o(t,e,i,n,o){return{x:t,y:e,zoom:1/0,id:n,properties:o,parentId:-1,numPoints:i}}function r(t,e){var i=t.geometry.coordinates;return{x:l(i[0]),y:u(i[1]),zoom:1/0,id:e,parentId:-1}}function a(t){return{type:"Feature",properties:s(t),geometry:{type:"Point",coordinates:[c(t.x),h(t.y)]}}}function s(t){var e=t.numPoints,i=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return p(p({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:i})}function l(t){return t/360+.5}function u(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function c(t){return 360*(t-.5)}function h(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function p(t,e){for(var i in e)t[i]=e[i];return t}function f(t){return t.x}function d(t){return t.y}var m=t("kdbush");e.exports=function(t){return new n(t)},n.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var i="prepare "+t.length+" points";e&&console.time(i),this.points=t;var n=t.map(r);e&&console.timeEnd(i);for(var o=this.options.maxZoom;o>=this.options.minZoom;o--){var a=+Date.now();this.trees[o+1]=m(n,f,d,this.options.nodeSize,Float32Array),n=this._cluster(n,o),e&&console.log("z%d: %d clusters in %dms",o,n.length,+Date.now()-a)}return this.trees[this.options.minZoom]=m(n,f,d,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var i=this.trees[this._limitZoom(e)],n=i.range(l(t[0]),u(t[3]),l(t[2]),u(t[1])),o=[],r=0;r<n.length;r++){var s=i.points[n[r]];o.push(s.numPoints?a(s):this.points[s.id])}return o},getChildren:function(t,e){for(var i=this.trees[e+1].points[t],n=this.options.radius/(this.options.extent*Math.pow(2,e)),o=this.trees[e+1].within(i.x,i.y,n),r=[],s=0;s<o.length;s++){var l=this.trees[e+1].points[o[s]];l.parentId===t&&r.push(l.numPoints?a(l):this.points[l.id])}return r},getLeaves:function(t,e,i,n){i=i||10,n=n||0;var o=[];return this._appendLeaves(o,t,e,i,n,0),o},getTile:function(t,e,i){var n=this.trees[this._limitZoom(t)],o=Math.pow(2,t),r=this.options.extent,a=this.options.radius/r,s=(i-a)/o,l=(i+1+a)/o,u={features:[]};return this._addTileFeatures(n.range((e-a)/o,s,(e+1+a)/o,l),n.points,e,i,o,u),0===e&&this._addTileFeatures(n.range(1-a/o,s,1,l),n.points,o,i,o,u),e===o-1&&this._addTileFeatures(n.range(0,s,a/o,l),n.points,-1,i,o,u),u.features.length?u:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var i=this.getChildren(t,e);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e},_appendLeaves:function(t,e,i,n,o,r){for(var a=this.getChildren(e,i),s=0;s<a.length;s++){var l=a[s].properties;if(l.cluster?r+l.point_count<=o?r+=l.point_count:r=this._appendLeaves(t,l.cluster_id,i+1,n,o,r):r<o?r++:t.push(a[s]),t.length===n)break}return r},_addTileFeatures:function(t,e,i,n,o,r){for(var a=0;a<t.length;a++){var l=e[t[a]];r.features.push({type:1,geometry:[[Math.round(this.options.extent*(l.x*o-i)),Math.round(this.options.extent*(l.y*o-n))]],tags:l.numPoints?s(l):this.points[l.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var i=[],n=this.options.radius/(this.options.extent*Math.pow(2,e)),r=0;r<t.length;r++){var a=t[r];if(!(a.zoom<=e)){a.zoom=e;var s=this.trees[e+1],l=s.within(a.x,a.y,n),u=a.numPoints||1,c=a.x*u,h=a.y*u,p=null;this.options.reduce&&(p=this.options.initial(),this._accumulate(p,a));for(var f=0;f<l.length;f++){var d=s.points[l[f]];if(e<d.zoom){var m=d.numPoints||1;d.zoom=e,c+=d.x*m,h+=d.y*m,u+=m,d.parentId=r,this.options.reduce&&this._accumulate(p,d)}}1===u?i.push(a):(a.parentId=r,i.push(o(c/u,h/u,u,r,p)))}}return i},_accumulate:function(t,e){var i=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,i)}}},{kdbush:22}],41:[function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||o,this.length>0)for(var i=this.length>>1;i>=0;i--)this._down(i)}function o(t,e){return t<e?-1:t>e?1:0}e.exports=n,n.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return--this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var o=t-1>>1,r=e[o];if(i(n,r)>=0)break;e[t]=r,t=o}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length,o=n>>1,r=e[t];t<o;){var a=1+(t<<1),s=a+1,l=e[a];if(s<n&&i(e[s],l)<0&&(a=s,l=e[s]),i(l,r)>=0)break;e[t]=l,t=a}e[t]=r}}},{}],42:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],43:[function(t,e,i){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],44:[function(t,e,i){(function(e,n){function o(t,e){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&i._extend(n,e),_(n.showHidden)&&(n.showHidden=!1),_(n.depth)&&(n.depth=2),_(n.colors)&&(n.colors=!1),_(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=r),l(n,t,n.depth)}function r(t,e){var i=o.styles[e];return i?"["+o.colors[i][0]+"m"+t+"["+o.colors[i][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}function l(t,e,n){if(t.customInspect&&e&&E(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(n,t);return v(o)||(o=l(t,o,n)),o}var r=u(t,e);if(r)return r;var a=Object.keys(e),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),T(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(e);if(0===a.length){if(E(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(w(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return c(e)}var y="",_=!1,b=["{","}"];if(d(e)&&(_=!0,b=["[","]"]),E(e)&&(y=" [Function"+(e.name?": "+e.name:"")+"]"),x(e)&&(y=" "+RegExp.prototype.toString.call(e)),w(e)&&(y=" "+Date.prototype.toUTCString.call(e)),T(e)&&(y=" "+c(e)),0===a.length&&(!_||0==e.length))return b[0]+y+b[1];if(n<0)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var C;return C=_?h(t,e,n,m,a):a.map(function(i){return p(t,e,n,m,i,_)}),t.seen.pop(),f(C,y,b)}function u(t,e){if(_(e))return t.stylize("undefined","undefined");if(v(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,i,n,o){for(var r=[],a=0,s=e.length;a<s;++a)k(e,String(a))?r.push(p(t,e,i,n,String(a),!0)):r.push("");return o.forEach(function(o){o.match(/^\d+$/)||r.push(p(t,e,i,n,o,!0))}),r}function p(t,e,i,n,o,r){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),k(n,o)||(a="["+o+"]"),s||(t.seen.indexOf(u.value)<0?(s=g(i)?l(t,u.value,null):l(t,u.value,i-1)).indexOf("\n")>-1&&(s=r?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),_(a)){if(r&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t,e,i){var n=0;return t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function v(t){return"string"==typeof t}function _(t){return void 0===t}function x(t){return b(t)&&"[object RegExp]"===C(t)}function b(t){return"object"==typeof t&&null!==t}function w(t){return b(t)&&"[object Date]"===C(t)}function T(t){return b(t)&&("[object Error]"===C(t)||t instanceof Error)}function E(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var I=/%[sdj%]/g;i.format=function(t){if(!v(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(o(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,r=n.length,a=String(t).replace(I,function(t){if("%%"===t)return"%";if(i>=r)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}}),s=n[i];i<r;s=n[++i])g(s)||!b(s)?a+=" "+s:a+=" "+o(s);return a},i.deprecate=function(t,o){if(_(n.process))return function(){return i.deprecate(t,o).apply(this,arguments)};if(!0===e.noDeprecation)return t;var r=!1;return function(){if(!r){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),r=!0}return t.apply(this,arguments)}};var L,D={};i.debuglog=function(t){if(_(L)&&(L=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(L)){var n=e.pid;D[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,n,e)}}else D[t]=function(){};return D[t]},i.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=d,i.isBoolean=m,i.isNull=g,i.isNullOrUndefined=function(t){return null==t},i.isNumber=y,i.isString=v,i.isSymbol=function(t){return"symbol"==typeof t},i.isUndefined=_,i.isRegExp=x,i.isObject=b,i.isDate=w,i.isError=T,i.isFunction=E,i.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},i.isBuffer=t("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",A(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(t,e){if(!e||!b(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":43,_process:38,inherits:42}],45:[function(t,e,i){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":46,"./lib/vectortilefeature.js":47,"./lib/vectortilelayer.js":48}],46:[function(t,e,i){"use strict";function n(t,e,i){if(3===t){var n=new o(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}var o=t("./vectortilelayer");e.exports=function(t,e){this.layers=t.readFields(n,{},e)}},{"./vectortilelayer":48}],47:[function(t,e,i){"use strict";function n(t,e,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=r,t.readFields(o,this,e)}function o(t,e,i){1==t?e.id=i.readVarint():2==t?r(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function r(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var n=e._keys[t.readVarint()],o=e._values[t.readVarint()];e.properties[n]=o}}function a(t){var e=t.length;if(e<=1)return[t];for(var i,n,o=[],r=0;r<e;r++){var a=s(t[r]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(i&&o.push(i),i=[t[r]]):i.push(t[r]))}return i&&o.push(i),o}function s(t){for(var e,i,n=0,o=0,r=t.length,a=r-1;o<r;a=o++)e=t[o],n+=((i=t[a]).x-e.x)*(e.y+i.y);return n}var l=t("point-geometry");e.exports=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,n=1,o=0,r=0,a=0,s=[];t.pos<i;){if(!o){var u=t.readVarint();n=7&u,o=u>>3}if(o--,1===n||2===n)r+=t.readSVarint(),a+=t.readSVarint(),1===n&&(e&&s.push(e),e=[]),e.push(new l(r,a));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&s.push(e),s},n.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,o=0,r=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(!n){var c=t.readVarint();i=7&c,n=c>>3}if(n--,1===i||2===i)o+=t.readSVarint(),r+=t.readSVarint(),o<a&&(a=o),o>s&&(s=o),r<l&&(l=r),r>u&&(u=r);else if(7!==i)throw new Error("unknown command "+i)}return[a,l,s,u]},n.prototype.toGeoJSON=function(t,e,i){function o(t){for(var e=0;e<t.length;e++){var i=t[e],n=180-360*(i.y+c)/l;t[e]=[360*(i.x+u)/l-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}var r,s,l=this.extent*Math.pow(2,i),u=this.extent*t,c=this.extent*e,h=this.loadGeometry(),p=n.types[this.type];switch(this.type){case 1:var f=[];for(r=0;r<h.length;r++)f[r]=h[r][0];o(h=f);break;case 2:for(r=0;r<h.length;r++)o(h[r]);break;case 3:for(h=a(h),r=0;r<h.length;r++)for(s=0;s<h[r].length;s++)o(h[r][s])}1===h.length?h=h[0]:p="Multi"+p;var d={type:"Feature",geometry:{type:p,coordinates:h},properties:this.properties};return"id"in this&&(d.id=this.id),d}},{"point-geometry":37}],48:[function(t,e,i){"use strict";function n(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(o,this,e),this.length=this._features.length}function o(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(r(i))}function r(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}var a=t("./vectortilefeature.js");e.exports=n,n.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":47}],49:[function(t,e,i){function n(t){var e=[];for(var i in t.layers)e.push(o(t.layers[i]));var n=new u;return c.tile.write({layers:e},n),n.finish()}function o(t){for(var e={name:t.name||"",version:t.version||1,extent:t.extent||4096,keys:[],values:[],features:[]},i={},n={},o=0;o<t.length;o++){var r=t.feature(o);r.geometry=s(r.loadGeometry());var a=[];for(var u in r.properties){var c=i[u];void 0===c&&(e.keys.push(u),c=e.keys.length-1,i[u]=c);var h=l(r.properties[u]),p=n[h.key];void 0===p&&(e.values.push(h),p=e.values.length-1,n[h.key]=p),a.push(c),a.push(p)}r.tags=a,e.features.push(r)}return e}function r(t,e){return(e<<3)+(7&t)}function a(t){return t<<1^t>>31}function s(t){for(var e=[],i=0,n=0,o=t.length,s=0;s<o;s++){var l=t[s];e.push(r(1,1));for(var u=0;u<l.length;u++){1===u&&e.push(r(2,l.length-1));var c=l[u].x-i,h=l[u].y-n;e.push(a(c),a(h)),i+=c,n+=h}}return e}function l(t){var e,i=typeof t;return e="string"===i?{string_value:t}:"boolean"===i?{bool_value:t}:"number"===i?t%1!=0?{double_value:t}:t<0?{sint_value:t}:{uint_value:t}:{string_value:t=JSON.stringify(t)},e.key=i+":"+t,e}var u=t("pbf"),c=t("./vector-tile-pb"),h=t("./lib/geojson_wrapper");e.exports=n,e.exports.fromVectorTileJs=n,e.exports.fromGeojsonVt=function(t){var e={};for(var i in t)e[i]=new h(t[i].features),e[i].name=i;return n({layers:e})},e.exports.GeoJSONWrapper=h},{"./lib/geojson_wrapper":50,"./vector-tile-pb":51,pbf:36}],50:[function(t,e,i){"use strict";function n(t){this.features=t,this.length=t.length}function o(t){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=4096}var r=t("point-geometry"),a=t("vector-tile").VectorTileFeature;e.exports=n,n.prototype.feature=function(t){return new o(this.features[t])},o.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],n=[],o=0;o<i.length;o++)n.push(new r(i[o][0],i[o][1]));this.geometry.push(n)}return this.geometry},o.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,n=1/0,o=-1/0,r=0;r<t.length;r++)for(var a=t[r],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),o=Math.max(o,l.y)}return[e,n,i,o]},o.prototype.toGeoJSON=a.prototype.toGeoJSON},{"point-geometry":37,"vector-tile":45}],51:[function(t,e,i){"use strict";function n(t,e,i){3===t&&e.layers.push(c(i,i.readVarint()+i.pos))}function o(t,e){return t.readFields(r,{},e)}function r(t,e,i){1===t?e.string_value=i.readString():2===t?e.float_value=i.readFloat():3===t?e.double_value=i.readDouble():4===t?e.int_value=i.readVarint():5===t?e.uint_value=i.readVarint():6===t?e.sint_value=i.readSVarint():7===t&&(e.bool_value=i.readBoolean())}function a(t,e){void 0!==t.string_value&&e.writeStringField(1,t.string_value),void 0!==t.float_value&&e.writeFloatField(2,t.float_value),void 0!==t.double_value&&e.writeDoubleField(3,t.double_value),void 0!==t.int_value&&e.writeVarintField(4,t.int_value),void 0!==t.uint_value&&e.writeVarintField(5,t.uint_value),void 0!==t.sint_value&&e.writeSVarintField(6,t.sint_value),void 0!==t.bool_value&&e.writeBooleanField(7,t.bool_value)}function s(t,e){var i=t.readFields(l,{},e);return void 0===i.type&&(i.type="Unknown"),i}function l(t,e,i){1===t?e.id=i.readVarint():2===t?e.tags=i.readPackedVarint():3===t?e.type=i.readVarint():4===t&&(e.geometry=i.readPackedVarint())}function u(t,e){void 0!==t.id&&e.writeVarintField(1,t.id),void 0!==t.tags&&e.writePackedVarint(2,t.tags),void 0!==t.type&&e.writeVarintField(3,t.type),void 0!==t.geometry&&e.writePackedVarint(4,t.geometry)}function c(t,e){return t.readFields(h,{features:[],keys:[],values:[]},e)}function h(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():2===t?e.features.push(s(i,i.readVarint()+i.pos)):3===t?e.keys.push(i.readString()):4===t?e.values.push(o(i,i.readVarint()+i.pos)):5===t&&(e.extent=i.readVarint())}function p(t,e){void 0!==t.version&&e.writeVarintField(15,t.version),void 0!==t.name&&e.writeStringField(1,t.name);var i;if(void 0!==t.features)for(i=0;i<t.features.length;i++)e.writeMessage(2,u,t.features[i]);if(void 0!==t.keys)for(i=0;i<t.keys.length;i++)e.writeStringField(3,t.keys[i]);if(void 0!==t.values)for(i=0;i<t.values.length;i++)e.writeMessage(4,a,t.values[i]);void 0!==t.extent&&e.writeVarintField(5,t.extent)}var f=i.tile={read:function(t,e){return t.readFields(n,{layers:[]},e)},write:function(t,e){var i;if(void 0!==t.layers)for(i=0;i<t.layers.length;i++)e.writeMessage(3,p,t.layers[i])}};f.GeomType={Unknown:0,Point:1,LineString:2,Polygon:3},f.value={read:o,write:a},f.feature={read:s,write:u},f.layer={read:c,write:p}},{}],52:[function(t,e,i){var n=arguments[3],o=arguments[4],r=arguments[5],a=JSON.stringify;e.exports=function(t,e){function i(t){g[t]=!0;for(var e in o[t][1]){var n=o[t][1][e];g[n]||i(n)}}for(var s,l=Object.keys(r),u=0,c=l.length;u<c;u++){var h=l[u],p=r[h].exports;if(p===t||p&&p.default===t){s=h;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var f={},u=0,c=l.length;u<c;u++)f[h=l[u]]=h;o[s]=[Function(["require","module","exports"],"("+t+")(self)"),f]}var d=Math.floor(Math.pow(16,8)*Math.random()).toString(16),m={};m[s]=s,o[d]=[Function(["require"],"var f = require("+a(s)+");(f.default ? f.default : f)(self);"),m];var g={};i(d);var y="("+n+")({"+Object.keys(g).map(function(t){return a(t)+":["+o[t][0]+","+a(o[t][1])+"]"}).join(",")+"},{},["+a(d)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([y],{type:"text/javascript"});if(e&&e.bare)return _;var x=v.createObjectURL(_),b=new Worker(x);return b.objectURL=x,b}},{}],53:[function(t,e,i){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},{}],54:[function(t,e,i){e.exports={version:"0.39.1"}},{}],55:[function(t,e,i){"use strict";function n(t,e){var i={};for(var n in t){var o=t[n].paintVertexArray;if(0!==o.length){var r=o.serialize(e),a=o.constructor.serialize();i[n]={array:r,type:a}}}return i}var o=t("./program_configuration"),r=t("./vertex_array_type"),a=function(t,e){this.vertexOffset=t,this.primitiveOffset=e,this.vertexLength=0,this.primitiveLength=0},s=function(t,e,i){var n=this;this.globalProperties={zoom:i};var a=r(t.layoutAttributes);if(this.layoutVertexArray=new a,t.dynamicLayoutAttributes){var s=r(t.dynamicLayoutAttributes);this.dynamicLayoutVertexArray=new s}var l=t.elementArrayType;l&&(this.elementArray=new l);var u=t.elementArrayType2;u&&(this.elementArray2=new u),this.layerData={};for(var c=0,h=e;c<h.length;c+=1){var p=h[c],f=o.createDynamic(t,p,i);n.layerData[p.id]={layer:p,programConfiguration:f,paintVertexArray:new f.PaintVertexArray,paintPropertyStatistics:f.createPaintPropertyStatistics()}}this.segments=[],this.segments2=[]};s.prototype.prepareSegment=function(t){var e=this.segments[this.segments.length-1];return(!e||e.vertexLength+t>s.MAX_VERTEX_ARRAY_LENGTH)&&(e=new a(this.layoutVertexArray.length,this.elementArray.length),this.segments.push(e)),e},s.prototype.prepareSegment2=function(t){var e=this.segments2[this.segments2.length-1];return(!e||e.vertexLength+t>s.MAX_VERTEX_ARRAY_LENGTH)&&(e=new a(this.layoutVertexArray.length,this.elementArray2.length),this.segments2.push(e)),e},s.prototype.populatePaintArrays=function(t){var e=this;for(var i in e.layerData){var n=e.layerData[i];0!==n.paintVertexArray.bytesPerElement&&n.programConfiguration.populatePaintArray(n.layer,n.paintVertexArray,n.paintPropertyStatistics,e.layoutVertexArray.length,t)}},s.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},s.prototype.serialize=function(t){return{layoutVertexArray:this.layoutVertexArray.serialize(t),dynamicLayoutVertexArray:this.dynamicLayoutVertexArray&&this.dynamicLayoutVertexArray.serialize(t),elementArray:this.elementArray&&this.elementArray.serialize(t),elementArray2:this.elementArray2&&this.elementArray2.serialize(t),paintVertexArrays:n(this.layerData,t),segments:this.segments,segments2:this.segments2}},s.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,e.exports=s},{"./program_configuration":69,"./vertex_array_type":71}],56:[function(t,e,i){"use strict";var n=t("./array_group"),o=t("./buffer_group"),r=t("../util/util"),a=function(t,e){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,t.arrays?this.buffers=new o(e,t.layers,t.zoom,t.arrays):this.arrays=new n(e,t.layers,t.zoom)};a.deserialize=function(t,e){var i={};if(!e)return i;for(var n=0,o=t;n<o.length;n+=1){var a=o[n],s=a.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==s.length)for(var l=s[0].createBucket(r.extend({layers:s},a)),u=0,c=s;u<c.length;u+=1)i[c[u].id]=l}return i},a.prototype.populate=function(t,e){for(var i=this,n=0,o=t;n<o.length;n+=1){var r=o[n],a=r.feature,s=r.index,l=r.sourceLayerIndex;i.layers[0].filter(a)&&(i.addFeature(a),e.featureIndex.insert(a,s,l,i.index))}},a.prototype.getPaintPropertyStatistics=function(){return r.mapObject(this.arrays.layerData,function(t){return t.paintPropertyStatistics})},a.prototype.isEmpty=function(){return this.arrays.isEmpty()},a.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),arrays:this.arrays.serialize(t)}},a.prototype.destroy=function(){this.buffers&&(this.buffers.destroy(),this.buffers=null)},e.exports=a},{"../util/util":219,"./array_group":55,"./buffer_group":63}],57:[function(t,e,i){"use strict";function n(t,e,i,n,o){t.emplaceBack(2*e+(n+1)/2,2*i+(o+1)/2)}var o=t("../bucket"),r=t("../element_array_type"),a=t("../load_geometry"),s=t("../extent"),l={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:r(),paintAttributes:[{property:"circle-color"},{property:"circle-radius"},{property:"circle-blur"},{property:"circle-opacity"},{property:"circle-stroke-color"},{property:"circle-stroke-width"},{property:"circle-stroke-opacity"}]},u=function(t){function e(e){t.call(this,e,l)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){for(var e=this.arrays,i=0,o=a(t);i<o.length;i+=1)for(var r=0,l=o[i];r<l.length;r+=1){var u=l[r],c=u.x,h=u.y;if(!(c<0||c>=s||h<0||h>=s)){var p=e.prepareSegment(4),f=p.vertexLength;n(e.layoutVertexArray,c,h,-1,-1),n(e.layoutVertexArray,c,h,1,-1),n(e.layoutVertexArray,c,h,1,1),n(e.layoutVertexArray,c,h,-1,1),e.elementArray.emplaceBack(f,f+1,f+2),e.elementArray.emplaceBack(f,f+3,f+2),p.vertexLength+=4,p.primitiveLength+=2}}e.populatePaintArrays(t.properties)},e}(o);u.programInterface=l,e.exports=u},{"../bucket":56,"../element_array_type":64,"../extent":65,"../load_geometry":67}],58:[function(t,e,i){"use strict";var n=t("../bucket"),o=t("../element_array_type"),r=t("../load_geometry"),a=t("earcut"),s=t("../../util/classify_rings"),l=t("assert"),u={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:o(3),elementArrayType2:o(2),paintAttributes:[{property:"fill-color"},{property:"fill-outline-color"},{property:"fill-opacity"}]},c=function(t){function e(e){t.call(this,e,u)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){for(var e=this.arrays,i=0,n=s(r(t),500);i<n.length;i+=1){for(var o=n[i],u=0,c=0,h=o;c<h.length;c+=1)u+=h[c].length;for(var p=e.prepareSegment(u),f=p.vertexLength,d=[],m=[],g=0,y=o;g<y.length;g+=1){var v=y[g];if(0!==v.length){v!==o[0]&&m.push(d.length/2);var _=e.prepareSegment2(v.length),x=_.vertexLength;e.layoutVertexArray.emplaceBack(v[0].x,v[0].y),e.elementArray2.emplaceBack(x+v.length-1,x),d.push(v[0].x),d.push(v[0].y);for(var b=1;b<v.length;b++)e.layoutVertexArray.emplaceBack(v[b].x,v[b].y),e.elementArray2.emplaceBack(x+b-1,x+b),d.push(v[b].x),d.push(v[b].y);_.vertexLength+=v.length,_.primitiveLength+=v.length}}var w=a(d,m);l(w.length%3==0);for(var T=0;T<w.length;T+=3)e.elementArray.emplaceBack(f+w[T],f+w[T+1],f+w[T+2]);p.vertexLength+=u,p.primitiveLength+=w.length/3}e.populatePaintArrays(t.properties)},e}(n);c.programInterface=u,e.exports=c},{"../../util/classify_rings":201,"../bucket":56,"../element_array_type":64,"../load_geometry":67,assert:6,earcut:8}],59:[function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){t.emplaceBack(e,i,2*Math.floor(n*f)+a,o*f*2,r*f*2,Math.round(s))}function o(t,e){return t.x===e.x&&(t.x<0||t.x>l)||t.y===e.y&&(t.y<0||t.y>l)}var r=t("../bucket"),a=t("../element_array_type"),s=t("../load_geometry"),l=t("../extent"),u=t("earcut"),c=t("../../util/classify_rings"),h=t("assert"),p={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_normal",components:3,type:"Int16"},{name:"a_edgedistance",components:1,type:"Int16"}],elementArrayType:a(3),paintAttributes:[{property:"fill-extrusion-base"},{property:"fill-extrusion-height"},{property:"fill-extrusion-color"}]},f=Math.pow(2,13),d=function(t){function e(e){t.call(this,e,p)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){for(var e=this.arrays,i=0,r=c(s(t),500);i<r.length;i+=1){for(var a=r[i],l=0,p=0,f=a;p<f.length;p+=1)l+=f[p].length;for(var d=e.prepareSegment(5*l),m=[],g=[],y=[],v=0,_=a;v<_.length;v+=1){var x=_[v];if(0!==x.length){x!==a[0]&&g.push(m.length/2);for(var b=0,w=0;w<x.length;w++){var T=x[w];if(n(e.layoutVertexArray,T.x,T.y,0,0,1,1,0),y.push(d.vertexLength++),w>=1){var E=x[w-1];if(!o(T,E)){var C=T.sub(E)._perp()._unit();n(e.layoutVertexArray,T.x,T.y,C.x,C.y,0,0,b),n(e.layoutVertexArray,T.x,T.y,C.x,C.y,0,1,b),b+=E.dist(T),n(e.layoutVertexArray,E.x,E.y,C.x,C.y,0,0,b),n(e.layoutVertexArray,E.x,E.y,C.x,C.y,0,1,b);var S=d.vertexLength;e.elementArray.emplaceBack(S,S+1,S+2),e.elementArray.emplaceBack(S+1,S+2,S+3),d.vertexLength+=4,d.primitiveLength+=2}}m.push(T.x),m.push(T.y)}}}var A=u(m,g);h(A.length%3==0);for(var k=0;k<A.length;k+=3)e.elementArray.emplaceBack(y[A[k]],y[A[k+1]],y[A[k+2]]);d.primitiveLength+=A.length/3}e.populatePaintArrays(t.properties)},e}(r);d.programInterface=p,e.exports=d},{"../../util/classify_rings":201,"../bucket":56,"../element_array_type":64,"../extent":65,"../load_geometry":67,assert:6,earcut:8}],60:[function(t,e,i){"use strict";function n(t,e,i,n,o,r,a){t.emplaceBack(e.x<<1|n,e.y<<1|o,Math.round(u*i.x)+128,Math.round(u*i.y)+128,1+(0===r?0:r<0?-1:1)|(a*h&63)<<2,a*h>>6)}var o=t("../bucket"),r=t("../element_array_type"),a=t("../load_geometry"),s=t("../extent"),l=t("vector-tile").VectorTileFeature.types,u=63,c=Math.cos(Math.PI/180*37.5),h=.5,p=Math.pow(2,14)/h,f={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],paintAttributes:[{property:"line-color"},{property:"line-blur"},{property:"line-opacity"},{property:"line-gap-width",name:"gapwidth"},{property:"line-offset"},{property:"line-width"},{property:"line-width",name:"floorwidth",useIntegerZoom:!0}],elementArrayType:r()},d=function(t){function e(e){t.call(this,e,f)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){for(var e=this,i=this.layers[0].layout,n=i["line-join"],o=i["line-cap"],r=i["line-miter-limit"],s=i["line-round-limit"],l=0,u=a(t,15);l<u.length;l+=1){var c=u[l];e.addLine(c,t,n,o,r,s)}},e.prototype.addLine=function(t,e,i,n,o,r){for(var a=this,u=e.properties,h="Polygon"===l[e.type],p=t.length;p>=2&&t[p-1].equals(t[p-2]);)p--;for(var f=0;f<p-1&&t[f].equals(t[f+1]);)f++;if(!(p<(h?3:2))){"bevel"===i&&(o=1.05);var d=s/(512*this.overscaling)*15,m=t[f],g=this.arrays,y=g.prepareSegment(10*p);this.distance=0;var v,_,x,b=n,w=h?"butt":n,T=!0,E=void 0,C=void 0,S=void 0,A=void 0;this.e1=this.e2=this.e3=-1,h&&(v=t[p-2],A=m.sub(v)._unit()._perp());for(var k=f;k<p;k++)if(!(C=h&&k===p-1?t[f+1]:t[k+1])||!t[k].equals(C)){A&&(S=A),v&&(E=v),v=t[k],A=C?C.sub(v)._unit()._perp():S;var I=(S=S||A).add(A);0===I.x&&0===I.y||I._unit();var L=I.x*A.x+I.y*A.y,D=0!==L?1/L:1/0,P=L<c&&E&&C;if(P&&k>f){var z=v.dist(E);if(z>2*d){var M=v.sub(v.sub(E)._mult(d/z)._round());a.distance+=M.dist(E),a.addCurrentVertex(M,a.distance,S.mult(1),0,0,!1,y),E=M}}var O=E&&C,R=O?i:C?b:w;if(O&&"round"===R&&(D<r?R="miter":D<=2&&(R="fakeround")),"miter"===R&&D>o&&(R="bevel"),"bevel"===R&&(D>2&&(R="flipbevel"),D<o&&(R="miter")),E&&(a.distance+=v.dist(E)),"miter"===R)I._mult(D),a.addCurrentVertex(v,a.distance,I,0,0,!1,y);else if("flipbevel"===R){if(D>100)I=A.clone().mult(-1);else{var N=S.x*A.y-S.y*A.x>0?-1:1,j=D*S.add(A).mag()/S.sub(A).mag();I._perp()._mult(j*N)}a.addCurrentVertex(v,a.distance,I,0,0,!1,y),a.addCurrentVertex(v,a.distance,I.mult(-1),0,0,!1,y)}else if("bevel"===R||"fakeround"===R){var F=S.x*A.y-S.y*A.x>0,B=-Math.sqrt(D*D-1);if(F?(x=0,_=B):(_=0,x=B),T||a.addCurrentVertex(v,a.distance,S,_,x,!1,y),"fakeround"===R){for(var V=Math.floor(8*(.5-(L-.5))),U=void 0,H=0;H<V;H++)U=A.mult((H+1)/(V+1))._add(S)._unit(),a.addPieSliceVertex(v,a.distance,U,F,y);a.addPieSliceVertex(v,a.distance,I,F,y);for(var q=V-1;q>=0;q--)U=S.mult((q+1)/(V+1))._add(A)._unit(),a.addPieSliceVertex(v,a.distance,U,F,y)}C&&a.addCurrentVertex(v,a.distance,A,-_,-x,!1,y)}else"butt"===R?(T||a.addCurrentVertex(v,a.distance,S,0,0,!1,y),C&&a.addCurrentVertex(v,a.distance,A,0,0,!1,y)):"square"===R?(T||(a.addCurrentVertex(v,a.distance,S,1,1,!1,y),a.e1=a.e2=-1),C&&a.addCurrentVertex(v,a.distance,A,-1,-1,!1,y)):"round"===R&&(T||(a.addCurrentVertex(v,a.distance,S,0,0,!1,y),a.addCurrentVertex(v,a.distance,S,1,1,!0,y),a.e1=a.e2=-1),C&&(a.addCurrentVertex(v,a.distance,A,-1,-1,!0,y),a.addCurrentVertex(v,a.distance,A,0,0,!1,y)));if(P&&k<p-1){var W=v.dist(C);if(W>2*d){var $=v.add(C.sub(v)._mult(d/W)._round());a.distance+=$.dist(v),a.addCurrentVertex($,a.distance,A.mult(1),0,0,!1,y),v=$}}T=!1}g.populatePaintArrays(u)}},e.prototype.addCurrentVertex=function(t,e,i,o,r,a,s){var l,u=a?1:0,c=this.arrays,h=c.layoutVertexArray,f=c.elementArray;l=i.clone(),o&&l._sub(i.perp()._mult(o)),n(h,t,l,u,0,o,e),this.e3=s.vertexLength++,this.e1>=0&&this.e2>=0&&(f.emplaceBack(this.e1,this.e2,this.e3),s.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=i.mult(-1),r&&l._sub(i.perp()._mult(r)),n(h,t,l,u,1,-r,e),this.e3=s.vertexLength++,this.e1>=0&&this.e2>=0&&(f.emplaceBack(this.e1,this.e2,this.e3),s.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>p/2&&(this.distance=0,this.addCurrentVertex(t,this.distance,i,o,r,a,s))},e.prototype.addPieSliceVertex=function(t,e,i,o,r){var a=o?1:0;i=i.mult(o?-1:1);var s=this.arrays,l=s.layoutVertexArray,u=s.elementArray;n(l,t,i,0,a,0,e),this.e3=r.vertexLength++,this.e1>=0&&this.e2>=0&&(u.emplaceBack(this.e1,this.e2,this.e3),r.primitiveLength++),o?this.e2=this.e3:this.e1=this.e3},e}(o);d.programInterface=f,e.exports=d},{"../bucket":56,"../element_array_type":64,"../extent":65,"../load_geometry":67,"vector-tile":45}],61:[function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){t.emplaceBack(e,i,Math.round(64*n),Math.round(64*o),r,a,s?s[0]:void 0,s?s[1]:void 0)}function o(t,e,i,n){var o=2*Math.PI,r=f((i+o)%o/o*255,10*n);t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function r(t,e,i,n,o,r){return t.emplaceBack(e.x,e.y,i.x,i.y,Math.round(n.x),Math.round(n.y),10*o,10*r)}function a(t,e,i){var n={};if(n.isFeatureConstant=e.isLayoutValueFeatureConstant(i),n.isZoomConstant=e.isLayoutValueZoomConstant(i),n.isFeatureConstant&&(n.layoutSize=e.getLayoutValue(i,{zoom:t+1})),!n.isZoomConstant){for(var o=e.getLayoutValueStopZoomLevels(i),r=0;r<o.length&&o[r]<=t;)r++;for(var a=r=Math.max(0,r-1);a<o.length&&o[a]<t+1;)a++;a=Math.min(o.length-1,a),n.coveringZoomRange=[o[r],o[a]],e.isLayoutValueFeatureConstant(i)&&(n.coveringStopValues=[e.getLayoutValue(i,{zoom:o[r]}),e.getLayoutValue(i,{zoom:o[a]})]),n.functionBase=e.getLayoutProperty(i).base,void 0===n.functionBase&&(n.functionBase=1),n.functionType=e.getLayoutProperty(i).type||"exponential"}return n}function s(t,e,i,n,o){return t.isLayoutValueZoomConstant(n)&&!t.isLayoutValueFeatureConstant(n)?[10*t.getLayoutValue(n,{},o)]:t.isLayoutValueZoomConstant(n)||t.isLayoutValueFeatureConstant(n)?null:[10*t.getLayoutValue(n,{zoom:i[0]},o),10*t.getLayoutValue(n,{zoom:i[1]},o)]}var l=t("point-geometry"),u=t("../array_group"),c=t("../buffer_group"),h=t("../element_array_type"),p=t("../extent"),f=t("../../shaders/encode_attribute").packUint8ToFloat,d=t("../../symbol/anchor"),m=t("../../symbol/get_anchors"),g=t("../../util/token"),y=t("../../symbol/quads"),v=t("../../symbol/shaping"),_=t("../../symbol/transform_text"),x=t("../../symbol/mergelines"),b=t("../../symbol/clip_line"),w=t("../../util/util"),T=t("../../util/script_detection"),E=t("../load_geometry"),C=t("../../symbol/collision_feature"),S=t("../../util/find_pole_of_inaccessibility"),A=t("../../util/classify_rings"),k=t("vector-tile").VectorTileFeature.types,I=t("../../util/struct_array"),L=t("../../util/verticalize_punctuation"),D=v.shapeText,P=v.shapeIcon,z=v.WritingMode,M=y.getGlyphQuads,O=y.getIconQuads,R=I({members:[{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Float32",name:"placementZoom"},{type:"Uint8",name:"vertical"}]}),N=I({members:[{type:"Float32",name:"offsetX"}]}),j=I({members:[{type:"Int16",name:"x"},{type:"Int16",name:"y"}]}),F=h(),B=[{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}],V=[{name:"a_projected_pos",components:3,type:"Float32"}],U={glyph:{layoutAttributes:B,dynamicLayoutAttributes:V,elementArrayType:F,paintAttributes:[{property:"text-color",name:"fill_color"},{property:"text-halo-color",name:"halo_color"},{property:"text-halo-width",name:"halo_width"},{property:"text-halo-blur",name:"halo_blur"},{property:"text-opacity",name:"opacity"}]},icon:{layoutAttributes:B,dynamicLayoutAttributes:V,elementArrayType:F,paintAttributes:[{property:"icon-color",name:"fill_color"},{property:"icon-halo-color",name:"halo_color"},{property:"icon-halo-width",name:"halo_width"},{property:"icon-halo-blur",name:"halo_blur"},{property:"icon-opacity",name:"opacity"}]},collisionBox:{layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}],elementArrayType:h(2)}},H=function(t){var e=this;this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.sdfIcons=t.sdfIcons,this.iconsNeedLinear=t.iconsNeedLinear,this.fontstack=t.fontstack;var i=this.layers[0];if(this.symbolInterfaces=U,t.arrays){this.buffers={};for(var n in t.arrays)t.arrays[n]&&(e.buffers[n]=new c(e.symbolInterfaces[n],t.layers,t.zoom,t.arrays[n]));this.textSizeData=t.textSizeData,this.iconSizeData=t.iconSizeData,this.placedGlyphArray=new R(t.placedGlyphArray),this.placedIconArray=new R(t.placedIconArray),this.glyphOffsetArray=new N(t.glyphOffsetArray),this.lineVertexArray=new j(t.lineVertexArray)}else this.textSizeData=a(this.zoom,i,"text-size"),this.iconSizeData=a(this.zoom,i,"icon-size")};H.prototype.populate=function(t,e){var i=this,n=this.layers[0],o=n.layout,r=o["text-font"],a=(!n.isLayoutValueFeatureConstant("text-field")||o["text-field"])&&r,s=!n.isLayoutValueFeatureConstant("icon-image")||o["icon-image"];if(this.features=[],a||s){for(var l=e.iconDependencies,u=e.glyphDependencies,c=u[r]=u[r]||{},h={zoom:this.zoom},p=0,f=t;p<f.length;p+=1){var d=f[p],m=d.feature,y=d.index,v=d.sourceLayerIndex;if(n.filter(m)){var b=void 0;a&&(b=n.getLayoutValue("text-field",h,m.properties),n.isLayoutValueFeatureConstant("text-field")&&(b=g(m.properties,b)),b=_(b,n,h,m.properties));var w=void 0;if(s&&(w=n.getLayoutValue("icon-image",h,m.properties),n.isLayoutValueFeatureConstant("icon-image")&&(w=g(m.properties,w))),(b||w)&&(i.features.push({text:b,icon:w,index:y,sourceLayerIndex:v,geometry:E(m),properties:m.properties,type:k[m.type]}),w&&(l[w]=!0),b))for(var C="map"===o["text-rotation-alignment"]&&"line"===o["symbol-placement"],S=T.allowsVerticalWritingMode(b),A=0;A<b.length;A++)if(c[b.charCodeAt(A)]=!0,C&&S){var I=L.lookup[b.charAt(A)];I&&(c[I.charCodeAt(0)]=!0)}}}"line"===o["symbol-placement"]&&(this.features=x(this.features))}},H.prototype.isEmpty=function(){return this.arrays.icon.isEmpty()&&this.arrays.glyph.isEmpty()&&this.arrays.collisionBox.isEmpty()},H.prototype.getPaintPropertyStatistics=function(){for(var t=this,e={},i=0,n=t.layers;i<n.length;i+=1){var o=n[i];e[o.id]=w.extend({},t.arrays.icon.layerData[o.id].paintPropertyStatistics,t.arrays.glyph.layerData[o.id].paintPropertyStatistics)}return e},H.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear,textSizeData:this.textSizeData,iconSizeData:this.iconSizeData,fontstack:this.fontstack,placedGlyphArray:this.placedGlyphArray.serialize(t),placedIconArray:this.placedIconArray.serialize(t),glyphOffsetArray:this.glyphOffsetArray.serialize(t),lineVertexArray:this.lineVertexArray.serialize(t),arrays:w.mapObject(this.arrays,function(e){return e.isEmpty()?null:e.serialize(t)})}},H.prototype.destroy=function(){this.buffers&&(this.buffers.icon&&this.buffers.icon.destroy(),this.buffers.glyph&&this.buffers.glyph.destroy(),this.buffers.collisionBox&&this.buffers.collisionBox.destroy(),this.buffers=null)},H.prototype.createArrays=function(){var t=this;this.arrays=w.mapObject(this.symbolInterfaces,function(e){return new u(e,t.layers,t.zoom)})},H.prototype.prepare=function(t,e){var i=this;this.symbolInstances=[];var n=512*this.overscaling;this.tilePixelRatio=p/n,this.compareText={},this.iconsNeedLinear=!1;for(var o=this.layers[0].layout,r=24*o["text-line-height"],a="line"!==o["symbol-placement"]?24*o["text-max-width"]:0,s=24*o["text-letter-spacing"],l=this.fontstack=o["text-font"].join(","),u="map"===o["text-rotation-alignment"]&&"line"===o["symbol-placement"],c=0,h=i.features;c<h.length;c+=1){var f=h[c],d=void 0;if(f.text){var m=T.allowsVerticalWritingMode(f.text),g=i.layers[0].getLayoutValue("text-offset",{zoom:i.zoom},f.properties).map(function(t){return 24*t}),y=T.allowsLetterSpacing(f.text)?s:0,v=i.layers[0].getLayoutValue("text-anchor",{zoom:i.zoom},f.properties),_=i.layers[0].getLayoutValue("text-justify",{zoom:i.zoom},f.properties);(d={})[z.horizontal]=D(f.text,t[l],a,r,v,_,y,g,24,z.horizontal),d[z.vertical]=m&&u&&D(f.text,t[l],a,r,v,_,y,g,24,z.vertical)}else d={};var x=void 0;if(f.icon){var b=e[f.icon];b&&(x=P(b,i.layers[0].getLayoutValue("icon-offset",{zoom:i.zoom},f.properties)),void 0===i.sdfIcons?i.sdfIcons=b.sdf:i.sdfIcons!==b.sdf&&w.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),b.isNativePixelRatio?0===o["icon-rotate"]&&i.layers[0].isLayoutValueFeatureConstant("icon-rotate")||(i.iconsNeedLinear=!0):i.iconsNeedLinear=!0)}(d[z.horizontal]||x)&&i.addFeature(f,d,x)}},H.prototype.addFeature=function(t,e,i){var n=this,o=this.layers[0].getLayoutValue("text-size",{zoom:this.zoom+1},t.properties),r=this.layers[0].getLayoutValue("icon-size",{zoom:this.zoom+1},t.properties),a=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},t.properties),s=this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},t.properties),l=this.layers[0].getLayoutValue("text-size",{zoom:18},t.properties);void 0===l&&(l=o);var u=this.layers[0].layout,c=o/24,h=this.tilePixelRatio*c,f=this.tilePixelRatio*l/24,g=this.tilePixelRatio*r,y=this.tilePixelRatio*u["symbol-spacing"],v=u["symbol-avoid-edges"],_=u["text-padding"]*this.tilePixelRatio,x=u["icon-padding"]*this.tilePixelRatio,w=u["text-max-angle"]/180*Math.PI,T="map"===u["text-rotation-alignment"]&&"line"===u["symbol-placement"],E="map"===u["icon-rotation-alignment"]&&"line"===u["symbol-placement"],C=u["text-allow-overlap"]||u["icon-allow-overlap"]||u["text-ignore-placement"]||u["icon-ignore-placement"],k=y/2,I=function(o,r){var l=!(r.x<0||r.x>p||r.y<0||r.y>p);if(!v||l){var u=l||C;n.addSymbolInstance(r,o,e,i,n.layers[0],u,n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,h,_,T,a,g,x,E,s,{zoom:n.zoom},t.properties)}};if("line"===u["symbol-placement"])for(var L=0,D=b(t.geometry,0,0,p,p);L<D.length;L+=1)for(var P=D[L],M=0,O=m(P,y,w,e[z.vertical]||e[z.horizontal],i,24,f,n.overscaling,p);M<O.length;M+=1){var R=O[M],N=e[z.horizontal];N&&n.anchorIsTooClose(N.text,k,R)||I(P,R)}else if("Polygon"===t.type)for(var j=0,F=A(t.geometry,0);j<F.length;j+=1){var B=F[j],V=S(B,16);I(B[0],new d(V.x,V.y,0))}else if("LineString"===t.type)for(var U=0,H=t.geometry;U<H.length;U+=1){var q=H[U];I(q,new d(q[0].x,q[0].y,0))}else if("Point"===t.type)for(var W=0,$=t.geometry;W<$.length;W+=1)for(var G=0,Z=$[W];G<Z.length;G+=1){var X=Z[G];I([X],new d(X.x,X.y,0))}},H.prototype.anchorIsTooClose=function(t,e,i){var n=this.compareText;if(t in n){for(var o=n[t],r=o.length-1;r>=0;r--)if(i.dist(o[r])<e)return!0}else n[t]=[];return n[t].push(i),!1},H.prototype.place=function(t,e){var i=this;this.createArrays(),this.placedGlyphArray=new R,this.placedIconArray=new R,this.glyphOffsetArray=new N,this.lineVertexArray=new j;var n=this.layers[0],o=n.layout,r=t.maxScale,a="map"===o["text-rotation-alignment"]&&"line"===o["symbol-placement"],l="map"===o["icon-rotation-alignment"]&&"line"===o["symbol-placement"];if(o["text-allow-overlap"]||o["icon-allow-overlap"]||o["text-ignore-placement"]||o["icon-ignore-placement"]){var u=t.angle,c=Math.sin(u),h=Math.cos(u);this.symbolInstances.sort(function(t,e){return(c*t.anchor.x+h*t.anchor.y|0)-(c*e.anchor.x+h*e.anchor.y|0)||e.featureIndex-t.featureIndex})}for(var p=0,f=i.symbolInstances;p<f.length;p+=1){var d=f[p],m={boxStartIndex:d.textBoxStartIndex,boxEndIndex:d.textBoxEndIndex},g={boxStartIndex:d.iconBoxStartIndex,boxEndIndex:d.iconBoxEndIndex},y=!(d.textBoxStartIndex===d.textBoxEndIndex),v=!(d.iconBoxStartIndex===d.iconBoxEndIndex),_=o["text-optional"]||!y,x=o["icon-optional"]||!v,b=y?t.placeCollisionFeature(m,o["text-allow-overlap"],o["symbol-avoid-edges"]):t.minScale,w=v?t.placeCollisionFeature(g,o["icon-allow-overlap"],o["symbol-avoid-edges"]):t.minScale;if(_||x?!x&&b?b=Math.max(w,b):!_&&w&&(w=Math.max(w,b)):w=b=Math.max(w,b),y||v){for(var T=d.line,E=i.lineVertexArray.length,C=0;C<T.length;C++)i.lineVertexArray.emplaceBack(T[C].x,T[C].y);var S=i.lineVertexArray.length-E;if(y&&(t.insertCollisionFeature(m,b,o["text-ignore-placement"]),b<=r)){var A=s(n,i.zoom,i.textSizeData.coveringZoomRange,"text-size",d.featureProperties);i.addSymbols(i.arrays.glyph,d.glyphQuads,b,A,o["text-keep-upright"],d.textOffset,a,t.angle,d.featureProperties,d.writingModes,d.anchor,E,S,i.placedGlyphArray)}if(v&&(t.insertCollisionFeature(g,w,o["icon-ignore-placement"]),w<=r)){var k=s(n,i.zoom,i.iconSizeData.coveringZoomRange,"icon-size",d.featureProperties);i.addSymbols(i.arrays.icon,d.iconQuads,w,k,o["icon-keep-upright"],d.iconOffset,l,t.angle,d.featureProperties,null,d.anchor,E,S,i.placedIconArray)}}}e&&this.addToDebugBuffers(t)},H.prototype.addSymbols=function(t,e,i,r,a,s,l,u,c,h,p,f,d,m){for(var g=this,y=t.elementArray,v=t.layoutVertexArray,_=t.dynamicLayoutVertexArray,x=this.zoom,b=Math.max(Math.log(i)/Math.LN2+x,0),w=this.glyphOffsetArray.length,T=(p.angle+u+2*Math.PI)%(2*Math.PI),E=T>1*Math.PI/4&&T<=3*Math.PI/4||T>5*Math.PI/4&&T<=7*Math.PI/4,C=Boolean(h&z.vertical)&&E,S=0,A=e;S<A.length;S+=1){var k=A[S];if(!l||!a||k.writingMode===z.vertical===C){var I=k.tl,L=k.tr,D=k.bl,P=k.br,M=k.tex,O=t.prepareSegment(4),R=O.vertexLength,N=k.glyphOffset[1];n(v,p.x,p.y,I.x,N+I.y,M.x,M.y,r),n(v,p.x,p.y,L.x,N+L.y,M.x+M.w,M.y,r),n(v,p.x,p.y,D.x,N+D.y,M.x,M.y+M.h,r),n(v,p.x,p.y,P.x,N+P.y,M.x+M.w,M.y+M.h,r),o(_,p,0,b),y.emplaceBack(R,R+1,R+2),y.emplaceBack(R+1,R+2,R+3),O.vertexLength+=4,O.primitiveLength+=2,g.glyphOffsetArray.emplaceBack(k.glyphOffset[0])}}m.emplaceBack(p.x,p.y,w,this.glyphOffsetArray.length-w,f,d,p.segment,r?r[0]:0,r?r[1]:0,s[0],s[1],b,C),t.populatePaintArrays(c)},H.prototype.addToDebugBuffers=function(t){for(var e=this,i=this.arrays.collisionBox,n=i.layoutVertexArray,o=i.elementArray,a=-t.angle,s=t.yStretch,u=0,c=e.symbolInstances;u<c.length;u+=1){var h=c[u];h.textCollisionFeature={boxStartIndex:h.textBoxStartIndex,boxEndIndex:h.textBoxEndIndex},h.iconCollisionFeature={boxStartIndex:h.iconBoxStartIndex,boxEndIndex:h.iconBoxEndIndex};for(var p=0;p<2;p++){var f=h[0===p?"textCollisionFeature":"iconCollisionFeature"];if(f)for(var d=f.boxStartIndex;d<f.boxEndIndex;d++){var m=e.collisionBoxArray.get(d);if(!(1===t.perspectiveRatio&&m.maxScale<1)){var g=m.anchorPoint,y=new l(m.x1,m.y1*s)._rotate(a),v=new l(m.x2,m.y1*s)._rotate(a),_=new l(m.x1,m.y2*s)._rotate(a),x=new l(m.x2,m.y2*s)._rotate(a),b=Math.max(0,Math.min(25,e.zoom+Math.log(m.maxScale)/Math.LN2)),w=Math.max(0,Math.min(25,e.zoom+Math.log(m.placementScale)/Math.LN2)),T=i.prepareSegment(4),E=T.vertexLength;r(n,g,h.anchor,y,b,w),r(n,g,h.anchor,v,b,w),r(n,g,h.anchor,x,b,w),r(n,g,h.anchor,_,b,w),o.emplaceBack(E,E+1),o.emplaceBack(E+1,E+2),o.emplaceBack(E+2,E+3),o.emplaceBack(E+3,E),T.vertexLength+=4,T.primitiveLength+=4}}}}},H.prototype.addSymbolInstance=function(t,e,i,n,o,r,a,s,l,u,c,h,p,f,d,m,g,y,v,_){var x,b,T=[],E=[];for(var S in i){var A=parseInt(S,10);i[A]&&(E=E.concat(r?M(t,i[A],o,p,v,_):[]),x=new C(a,e,t,s,l,u,i[A],c,h,p,!1))}var k=x?x.boxStartIndex:this.collisionBoxArray.length,I=x?x.boxEndIndex:this.collisionBoxArray.length;n&&(T=r?O(t,n,o,g,i[z.horizontal],v,_):[],b=new C(a,e,t,s,l,u,n,d,m,g,!0));var L=b?b.boxStartIndex:this.collisionBoxArray.length,D=b?b.boxEndIndex:this.collisionBoxArray.length;I>H.MAX_INSTANCES&&w.warnOnce("Too many symbols being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),D>H.MAX_INSTANCES&&w.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var P=(i[z.vertical]?z.vertical:0)|(i[z.horizontal]?z.horizontal:0);this.symbolInstances.push({textBoxStartIndex:k,textBoxEndIndex:I,iconBoxStartIndex:L,iconBoxEndIndex:D,glyphQuads:E,iconQuads:T,textOffset:f,iconOffset:y,anchor:t,line:e,featureIndex:s,featureProperties:_,writingModes:P})},H.programInterfaces=U,H.MAX_INSTANCES=65535,H.addDynamicAttributes=o,e.exports=H},{"../../shaders/encode_attribute":91,"../../symbol/anchor":161,"../../symbol/clip_line":163,"../../symbol/collision_feature":165,"../../symbol/get_anchors":167,"../../symbol/mergelines":170,"../../symbol/quads":172,"../../symbol/shaping":173,"../../symbol/transform_text":176,"../../util/classify_rings":201,"../../util/find_pole_of_inaccessibility":207,"../../util/script_detection":214,"../../util/struct_array":216,"../../util/token":218,"../../util/util":219,"../../util/verticalize_punctuation":221,"../array_group":55,"../buffer_group":63,"../element_array_type":64,"../extent":65,"../load_geometry":67,"point-geometry":37,"vector-tile":45}],62:[function(t,e,i){"use strict";var n={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},o=function(t,e,i,n){this.arrayBuffer=t.arrayBuffer,this.length=t.length,this.attributes=e.members,this.itemSize=e.bytesPerElement,this.type=i,this.arrayType=e,this.dynamicDraw=n};o.fromStructArray=function(t,e){return new o(t.serialize(),t.constructor.serialize(),e)},o.prototype.bind=function(t){var e=t[this.type];this.buffer?(t.bindBuffer(e,this.buffer),this.dynamicDraw&&this.arrayBuffer&&(t.bufferSubData(e,0,this.arrayBuffer),this.arrayBuffer=null)):(this.gl=t,this.buffer=t.createBuffer(),t.bindBuffer(e,this.buffer),t.bufferData(e,this.arrayBuffer,this.dynamicDraw?t.DYNAMIC_DRAW:t.STATIC_DRAW),this.arrayBuffer=null)},o.prototype.updateData=function(t){this.arrayBuffer=t.arrayBuffer},o.prototype.enableAttributes=function(t,e){for(var i=this,n=0;n<this.attributes.length;n++){var o=e[i.attributes[n].name];void 0!==o&&t.enableVertexAttribArray(o)}},o.prototype.setVertexAttribPointers=function(t,e,i){for(var o=this,r=0;r<this.attributes.length;r++){var a=o.attributes[r],s=e[a.name];void 0!==s&&t.vertexAttribPointer(s,a.components,t[n[a.type]],!1,o.arrayType.bytesPerElement,a.offset+(o.arrayType.bytesPerElement*i||0))}},o.prototype.destroy=function(){this.buffer&&this.gl.deleteBuffer(this.buffer)},o.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"},e.exports=o},{}],63:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("./buffer"),r=t("./program_configuration"),a=t("./vertex_array_type"),s=t("../render/vertex_array_object"),l=function(t,e,i,l){var u=this,c=a(t.layoutAttributes);if(this.layoutVertexBuffer=new o(l.layoutVertexArray,c.serialize(),o.BufferType.VERTEX),l.dynamicLayoutVertexArray&&t.dynamicLayoutAttributes){var h=a(t.dynamicLayoutAttributes);this.dynamicLayoutVertexArray=new h(l.dynamicLayoutVertexArray),this.dynamicLayoutVertexBuffer=new o(l.dynamicLayoutVertexArray,h.serialize(),o.BufferType.VERTEX,!0)}l.elementArray&&t.elementArrayType&&(this.elementBuffer=new o(l.elementArray,t.elementArrayType.serialize(),o.BufferType.ELEMENT)),l.elementArray2&&t.elementArrayType2&&(this.elementBuffer2=new o(l.elementArray2,t.elementArrayType2.serialize(),o.BufferType.ELEMENT)),this.layerData={};for(var p=0,f=e;p<f.length;p+=1){var d=f[p],m=l.paintVertexArrays&&l.paintVertexArrays[d.id],g=r.createDynamic(t,d,i),y=m?new o(m.array,m.type,o.BufferType.VERTEX):null;u.layerData[d.id]={programConfiguration:g,paintVertexBuffer:y}}this.segments=l.segments,this.segments2=l.segments2;for(var v=0,_=[u.segments,u.segments2];v<_.length;v+=1)for(var x=0,b=_[v]||[];x<b.length;x+=1)b[x].vaos=n.mapObject(u.layerData,function(){return new s})};l.prototype.destroy=function(){var t=this;this.layoutVertexBuffer.destroy(),this.dynamicLayoutVertexBuffer&&this.dynamicLayoutVertexBuffer.destroy(),this.elementBuffer&&this.elementBuffer.destroy(),this.elementBuffer2&&this.elementBuffer2.destroy();for(var e in t.layerData){var i=t.layerData[e].paintVertexBuffer;i&&i.destroy()}for(var n=0,o=[t.segments,t.segments2];n<o.length;n+=1)for(var r=0,a=o[n]||[];r<a.length;r+=1){var s=a[r];for(var l in s.vaos)s.vaos[l].destroy()}},e.exports=l},{"../render/vertex_array_object":90,"../util/util":219,"./buffer":62,"./program_configuration":69,"./vertex_array_type":71}],64:[function(t,e,i){"use strict";var n=t("../util/struct_array");e.exports=function(t){return n({members:[{type:"Uint16",name:"vertices",components:t||3}]})}},{"../util/struct_array":216}],65:[function(t,e,i){"use strict";e.exports=8192},{}],66:[function(t,e,i){"use strict";function n(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function o(t,e){return e-t}function r(t,e){return e>0?e+2*t:t}function a(t,e,i,n,o){if(!e[0]&&!e[1])return t;e=u.convert(e),"viewport"===i&&e._rotate(-n);for(var r=[],a=0;a<t.length;a++){for(var s=t[a],l=[],c=0;c<s.length;c++)l.push(s[c].sub(e._mult(o)));r.push(l)}return r}function s(t,e){for(var i=[],n=new u(0,0),o=0;o<t.length;o++){for(var r=t[o],a=[],s=0;s<r.length;s++){var l=r[s-1],c=r[s],h=r[s+1],p=0===s?n:c.sub(l)._unit()._perp(),f=s===r.length-1?n:h.sub(c)._unit()._perp(),d=p._add(f)._unit(),m=d.x*f.x+d.y*f.y;d._mult(1/m),a.push(d._mult(e)._add(c))}i.push(a)}return i}var l=t("assert"),u=t("point-geometry"),c=t("./load_geometry"),h=t("./extent"),p=t("../style-spec/feature_filter"),f=t("../util/struct_array"),d=t("grid-index"),m=t("../util/dictionary_coder"),g=t("vector-tile"),y=t("pbf"),v=t("../util/vectortile_to_geojson"),_=t("../util/util").arraysIntersect,x=t("../util/intersection_tests"),b=x.multiPolygonIntersectsBufferedMultiPoint,w=x.multiPolygonIntersectsMultiPolygon,T=x.multiPolygonIntersectsBufferedMultiLine,E=f({members:[{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]}),C=function(t,e,i,n){this.coord=t,this.overscaling=e,this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.grid=i||new d(h,16,0),this.featureIndexArray=n||new E};C.deserialize=function(t,e,i){var n=new C(t.coord,t.overscaling,new d(t.grid),new E(t.featureIndexArray));return n.rawTileData=e,n.bucketLayerIDs=t.bucketLayerIDs,n.paintPropertyStatistics=t.paintPropertyStatistics,n.setCollisionTile(i),n},C.prototype.insert=function(t,e,i,n){var o=this,r=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(e,i,n);for(var a=c(t),s=0;s<a.length;s++){for(var l=a[s],u=[1/0,1/0,-1/0,-1/0],h=0;h<l.length;h++){var p=l[h];u[0]=Math.min(u[0],p.x),u[1]=Math.min(u[1],p.y),u[2]=Math.max(u[2],p.x),u[3]=Math.max(u[3],p.y)}o.grid.insert(r,u[0],u[1],u[2],u[3])}},C.prototype.setCollisionTile=function(t){this.collisionTile=t},C.prototype.serialize=function(t){var e=this.grid.toArrayBuffer();return t&&t.push(e),{coord:this.coord,overscaling:this.overscaling,grid:e,featureIndexArray:this.featureIndexArray.serialize(t),bucketLayerIDs:this.bucketLayerIDs,paintPropertyStatistics:this.paintPropertyStatistics}},C.prototype.query=function(t,e){var i=this;this.vtLayers||(this.vtLayers=new g.VectorTile(new y(this.rawTileData)).layers,this.sourceLayerCoder=new m(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));var a={},s=t.params||{},l=h/t.tileSize/t.scale,c=p(s.filter),f=0;for(var d in e)if(i.hasLayer(d)){var v=e[d],_=0;if("line"===v.type){var x=r(i.getPaintValue("line-width",v),i.getPaintValue("line-gap-width",v)),b=i.getPaintValue("line-offset",v),w=i.getPaintValue("line-translate",v);_=x/2+Math.abs(b)+n(w)}else"fill"===v.type?_=n(i.getPaintValue("fill-translate",v)):"fill-extrusion"===v.type?_=n(i.getPaintValue("fill-extrusion-translate",v)):"circle"===v.type&&(_=i.getPaintValue("circle-radius",v)+n(i.getPaintValue("circle-translate",v)));f=Math.max(f,_*l)}for(var T=t.queryGeometry.map(function(t){return t.map(function(t){return new u(t.x,t.y)})}),E=1/0,C=1/0,S=-1/0,A=-1/0,k=0;k<T.length;k++)for(var I=T[k],L=0;L<I.length;L++){var D=I[L];E=Math.min(E,D.x),C=Math.min(C,D.y),S=Math.max(S,D.x),A=Math.max(A,D.y)}var P=this.grid.query(E-f,C-f,S+f,A+f);P.sort(o),this.filterMatching(a,P,this.featureIndexArray,T,c,s.layers,e,t.bearing,l);var z=this.collisionTile.queryRenderedSymbols(T,t.scale);return z.sort(),this.filterMatching(a,z,this.collisionTile.collisionBoxArray,T,c,s.layers,e,t.bearing,l),a},C.prototype.filterMatching=function(t,e,i,n,o,l,u,h,p){for(var f,d=this,m=0;m<e.length;m++){var g=e[m];if(g!==f){f=g;var y=i.get(g),x=d.bucketLayerIDs[y.bucketIndex];if(!l||_(l,x)){var E=d.sourceLayerCoder.decode(y.sourceLayerIndex),C=d.vtLayers[E].feature(y.featureIndex);if(o(C))for(var S=null,A=0;A<x.length;A++){var k=x[A];if(!(l&&l.indexOf(k)<0)){var I=u[k];if(I){var L=void 0;if("symbol"!==I.type)if(S||(S=c(C)),"line"===I.type){L=a(n,d.getPaintValue("line-translate",I,C),d.getPaintValue("line-translate-anchor",I,C),h,p);var D=p/2*r(d.getPaintValue("line-width",I,C),d.getPaintValue("line-gap-width",I,C)),P=d.getPaintValue("line-offset",I,C);if(P&&(S=s(S,P*p)),!T(L,S,D))continue}else if("fill"===I.type||"fill-extrusion"===I.type){var z=I.type;if(L=a(n,d.getPaintValue(z+"-translate",I,C),d.getPaintValue(z+"-translate-anchor",I,C),h,p),!w(L,S))continue}else if("circle"===I.type){L=a(n,d.getPaintValue("circle-translate",I,C),d.getPaintValue("circle-translate-anchor",I,C),h,p);var M=d.getPaintValue("circle-radius",I,C)*p;if(!b(L,S,M))continue}var O=new v(C,d.z,d.x,d.y);O.layer=I.serialize();var R=t[k];void 0===R&&(R=t[k]=[]),R.push({featureIndex:g,feature:O})}}}}}}},C.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var n=0,o=i[e];n<o.length;n+=1)if(t===o[n])return!0;return!1},C.prototype.getPaintValue=function(t,e,i){if(e.isPaintValueFeatureConstant(t)||i){var n=i?i.properties:{};return e.getPaintValue(t,{zoom:this.z},n)}return l(t in this.paintPropertyStatistics[e.id]),this.paintPropertyStatistics[e.id][t].max},e.exports=C},{"../style-spec/feature_filter":116,"../util/dictionary_coder":203,"../util/intersection_tests":210,"../util/struct_array":216,"../util/util":219,"../util/vectortile_to_geojson":220,"./extent":65,"./load_geometry":67,assert:6,"grid-index":20,pbf:36,"point-geometry":37,"vector-tile":45}],67:[function(t,e,i){"use strict";function n(t){return{min:-1*Math.pow(2,t-1),max:Math.pow(2,t-1)-1}}var o=t("../util/util"),r=t("./extent"),a=t("assert"),s={15:n(15),16:n(16)};e.exports=function(t,e){var i=s[e||16];a(i);for(var n=r/t.extent,l=t.loadGeometry(),u=0;u<l.length;u++)for(var c=l[u],h=0;h<c.length;h++){var p=c[h];p.x=Math.round(p.x*n),p.y=Math.round(p.y*n),(p.x<i.min||p.x>i.max||p.y<i.min||p.y>i.max)&&o.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return l}},{"../util/util":219,"./extent":65,assert:6}],68:[function(t,e,i){"use strict";var n=t("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2}]});e.exports=n},{"../util/struct_array":216}],69:[function(t,e,i){"use strict";function n(t){return[a(255*t[0],255*t[1]),a(255*t[2],255*t[3])]}var o=t("./vertex_array_type"),r=t("../style-spec/function").interpolationFactor,a=t("../shaders/encode_attribute").packUint8ToFloat,s=function(t,e,i,n){this.name=t,this.type=e,this.property=i,this.useIntegerZoom=n};s.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},s.prototype.populatePaintArray=function(){},s.prototype.setUniforms=function(t,e,i,n){var o=n.zoom,r=i.getPaintValue(this.property,{zoom:this.useIntegerZoom?Math.floor(o):o});"color"===this.type?t.uniform4fv(e["u_"+this.name],r):t.uniform1f(e["u_"+this.name],r)};var l=function(t,e,i){this.name=t,this.type=e,this.property=i};l.prototype.defines=function(){return[]},l.prototype.populatePaintArray=function(t,e,i,o,r,a){var s=this,l=t.getPaintValue(this.property,void 0,a);if("color"===this.type)for(var u=n(l),c=o;c<r;c++){var h=e.get(c);h["a_"+s.name+"0"]=u[0],h["a_"+s.name+"1"]=u[1]}else{for(var p=o;p<r;p++)e.get(p)["a_"+s.name]=l;var f=i[this.property];f.max=Math.max(f.max,l)}},l.prototype.setUniforms=function(t,e){t.uniform1f(e["a_"+this.name+"_t"],0)};var u=function(t,e,i,n,o){this.name=t,this.type=e,this.property=i,this.useIntegerZoom=n,this.zoom=o};u.prototype.defines=function(){return[]},u.prototype.populatePaintArray=function(t,e,i,o,r,a){var s=this,l=t.getPaintValue(this.property,{zoom:this.zoom},a),u=t.getPaintValue(this.property,{zoom:this.zoom+1},a);if("color"===this.type)for(var c=n(l),h=n(u),p=o;p<r;p++){var f=e.get(p);f["a_"+s.name+"0"]=c[0],f["a_"+s.name+"1"]=c[1],f["a_"+s.name+"2"]=h[0],f["a_"+s.name+"3"]=h[1]}else{for(var d=o;d<r;d++){var m=e.get(d);m["a_"+s.name+"0"]=l,m["a_"+s.name+"1"]=u}var g=i[this.property];g.max=Math.max(g.max,l,u)}},u.prototype.setUniforms=function(t,e,i,n){var o=n.zoom,a=r(this.useIntegerZoom?Math.floor(o):o,1,this.zoom,this.zoom+1);t.uniform1f(e["a_"+this.name+"_t"],a)};var c=function(){this.binders={},this.cacheKey=""};c.createDynamic=function(t,e,i){for(var n=new c,r=[],a=0,h=t.paintAttributes||[];a<h.length;a+=1){var p=h[a],f=p.property,d=p.useIntegerZoom||!1,m=p.name||f.replace(e.type+"-","").replace(/-/g,"_"),g=e._paintSpecifications[f].type;e.isPaintValueFeatureConstant(f)?(n.binders[m]=new s(m,g,f,d),n.cacheKey+="/u_"+m):e.isPaintValueZoomConstant(f)?(n.binders[m]=new l(m,g,f),n.cacheKey+="/a_"+m,r.push({name:"a_"+m,type:"Float32",components:"color"===g?2:1})):(n.binders[m]=new u(m,g,f,d,i),n.cacheKey+="/z_"+m,r.push({name:"a_"+m,type:"Float32",components:"color"===g?4:2}))}return n.PaintVertexArray=o(r),n.interface=t,n},c.createBasicFill=function(){var t=new c;return t.binders.color=new s("color","color","fill-color",!1),t.cacheKey+="/u_color",t.binders.opacity=new s("opacity","number","fill-opacity",!1),t.cacheKey+="/u_opacity",t},c.prototype.createPaintPropertyStatistics=function(){var t=this,e={};for(var i in t.binders)e[t.binders[i].property]={max:-1/0};return e},c.prototype.populatePaintArray=function(t,e,i,n,o){var r=this,a=e.length;e.resize(n);for(var s in r.binders)r.binders[s].populatePaintArray(t,e,i,a,n,o)},c.prototype.defines=function(){var t=this,e=[];for(var i in t.binders)e.push.apply(e,t.binders[i].defines());return e},c.prototype.setUniforms=function(t,e,i,n){var o=this;for(var r in o.binders)o.binders[r].setUniforms(t,e,i,n)},e.exports=c},{"../shaders/encode_attribute":91,"../style-spec/function":118,"./vertex_array_type":71}],70:[function(t,e,i){"use strict";var n=t("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]});e.exports=n},{"../util/struct_array":216}],71:[function(t,e,i){"use strict";var n=t("../util/struct_array");e.exports=function(t){return n({members:t,alignment:4})}},{"../util/struct_array":216}],72:[function(t,e,i){"use strict";var n=function(t,e,i){this.column=t,this.row=e,this.zoom=i};n.prototype.clone=function(){return new n(this.column,this.row,this.zoom)},n.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},n.prototype.sub=function(t){return this.clone()._sub(t)},n.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},n.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this},e.exports=n},{}],73:[function(t,e,i){"use strict";var n=t("../util/util").wrap,o=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};o.prototype.wrap=function(){return new o(n(this.lng,-180,180),this.lat)},o.prototype.toArray=function(){return[this.lng,this.lat]},o.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},o.prototype.toBounds=function(e){var i=360*e/40075017,n=i/Math.cos(Math.PI/180*this.lat);return new(t("./lng_lat_bounds"))(new o(this.lng-n,this.lat-i),new o(this.lng+n,this.lat+i))},o.convert=function(t){if(t instanceof o)return t;if(Array.isArray(t)&&2===t.length)return new o(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new o(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")},e.exports=o},{"../util/util":219,"./lng_lat_bounds":74}],74:[function(t,e,i){"use strict";var n=t("./lng_lat"),o=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};o.prototype.setNorthEast=function(t){return this._ne=t instanceof n?new n(t.lng,t.lat):n.convert(t),this},o.prototype.setSouthWest=function(t){return this._sw=t instanceof n?new n(t.lng,t.lat):n.convert(t),this},o.prototype.extend=function(t){var e,i,r=this._sw,a=this._ne;if(t instanceof n)e=t,i=t;else{if(!(t instanceof o))return Array.isArray(t)?t.every(Array.isArray)?this.extend(o.convert(t)):this.extend(n.convert(t)):this;if(e=t._sw,i=t._ne,!e||!i)return this}return r||a?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),a.lng=Math.max(i.lng,a.lng),a.lat=Math.max(i.lat,a.lat)):(this._sw=new n(e.lng,e.lat),this._ne=new n(i.lng,i.lat)),this},o.prototype.getCenter=function(){return new n((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},o.prototype.getSouthWest=function(){return this._sw},o.prototype.getNorthEast=function(){return this._ne},o.prototype.getNorthWest=function(){return new n(this.getWest(),this.getNorth())},o.prototype.getSouthEast=function(){return new n(this.getEast(),this.getSouth())},o.prototype.getWest=function(){return this._sw.lng},o.prototype.getSouth=function(){return this._sw.lat},o.prototype.getEast=function(){return this._ne.lng},o.prototype.getNorth=function(){return this._ne.lat},o.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},o.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},o.convert=function(t){return!t||t instanceof o?t:new o(t)},e.exports=o},{"./lng_lat":73}],75:[function(t,e,i){"use strict";var n=t("./lng_lat"),o=t("point-geometry"),r=t("./coordinate"),a=t("../util/util"),s=t("../style-spec/util/interpolate"),l=t("../source/tile_coord"),u=t("../data/extent"),c=t("@mapbox/gl-matrix"),h=c.vec4,p=c.mat4,f=c.mat2,d=function(t,e,i){this.tileSize=512,this._renderWorldCopies=void 0===i||i,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new n(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0},m={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};m.minZoom.get=function(){return this._minZoom},m.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},m.maxZoom.get=function(){return this._maxZoom},m.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},m.renderWorldCopies.get=function(){return this._renderWorldCopies},m.worldSize.get=function(){return this.tileSize*this.scale},m.centerPoint.get=function(){return this.size._div(2)},m.size.get=function(){return new o(this.width,this.height)},m.bearing.get=function(){return-this.angle/Math.PI*180},m.bearing.set=function(t){var e=-a.wrap(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=f.create(),f.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},m.pitch.get=function(){return this._pitch/Math.PI*180},m.pitch.set=function(t){var e=a.clamp(t,0,60)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},m.fov.get=function(){return this._fov/Math.PI*180},m.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},m.zoom.get=function(){return this._zoom},m.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},m.center.get=function(){return this._center},m.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},d.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},d.prototype.getVisibleWrappedCoordinates=function(t){for(var e=this.pointCoordinate(new o(0,0),0),i=this.pointCoordinate(new o(this.width,0),0),n=Math.floor(e.column),r=Math.floor(i.column),a=[t],s=n;s<=r;s++)0!==s&&a.push(new l(t.z,t.x,t.y,s));return a},d.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),i=e;if(e<t.minzoom)return[];e>t.maxzoom&&(e=t.maxzoom);var n=this.pointCoordinate(this.centerPoint,e),r=new o(n.column-.5,n.row-.5),a=[this.pointCoordinate(new o(0,0),e),this.pointCoordinate(new o(this.width,0),e),this.pointCoordinate(new o(this.width,this.height),e),this.pointCoordinate(new o(0,this.height),e)];return l.cover(e,a,t.reparseOverscaled?i:e,this._renderWorldCopies).sort(function(t,e){return r.dist(t)-r.dist(e)})},d.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},m.unmodified.get=function(){return this._unmodified},d.prototype.zoomScale=function(t){return Math.pow(2,t)},d.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},d.prototype.project=function(t){return new o(this.lngX(t.lng),this.latY(t.lat))},d.prototype.unproject=function(t){return new n(this.xLng(t.x),this.yLat(t.y))},m.x.get=function(){return this.lngX(this.center.lng)},m.y.get=function(){return this.latY(this.center.lat)},m.point.get=function(){return new o(this.x,this.y)},d.prototype.lngX=function(t){return(180+t)*this.worldSize/360},d.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},d.prototype.xLng=function(t){return 360*t/this.worldSize-180},d.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},d.prototype.setLocationAtPoint=function(t,e){var i=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(i)),this._renderWorldCopies&&(this.center=this.center.wrap())},d.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},d.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},d.prototype.locationCoordinate=function(t){return new r(this.lngX(t.lng)/this.tileSize,this.latY(t.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},d.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new n(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},d.prototype.pointCoordinate=function(t,e){void 0===e&&(e=this.tileZoom);var i=[t.x,t.y,0,1],n=[t.x,t.y,1,1];h.transformMat4(i,i,this.pixelMatrixInverse),h.transformMat4(n,n,this.pixelMatrixInverse);var o=i[3],a=n[3],l=i[0]/o,u=n[0]/a,c=i[1]/o,p=n[1]/a,f=i[2]/o,d=n[2]/a,m=f===d?0:(0-f)/(d-f);return new r(s(l,u,m)/this.tileSize,s(c,p,m)/this.tileSize,this.zoom)._zoomTo(e)},d.prototype.coordinatePoint=function(t){var e=t.zoomTo(this.zoom),i=[e.column*this.tileSize,e.row*this.tileSize,0,1];return h.transformMat4(i,i,this.pixelMatrix),new o(i[0]/i[3],i[1]/i[3])},d.prototype.calculatePosMatrix=function(t,e){var i=t.toCoordinate(e),n=this.worldSize/this.zoomScale(i.zoom),o=p.identity(new Float64Array(16));return p.translate(o,o,[i.column*n,i.row*n,0]),p.scale(o,o,[n/u,n/u,1]),p.multiply(o,this.projMatrix,o),new Float32Array(o)},d.prototype.cameraToTileDistance=function(t){var e=this.calculatePosMatrix(t.coord,t.sourceMaxZoom),i=[t.tileSize/2,t.tileSize/2,0,1];return h.transformMat4(i,i,e),i[3]},d.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,i,n,r=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;r=this.latY(h[1]),t=(a=this.latY(h[0]))-r<u.y?u.y/(a-r):0}if(this.lngRange){var p=this.lngRange;s=this.lngX(p[0]),e=(l=this.lngX(p[1]))-s<u.x?u.x/(l-s):0}var f=Math.max(e||0,t||0);if(f)return this.center=this.unproject(new o(e?(l+s)/2:this.x,t?(a+r)/2:this.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,m=u.y/2;d-m<r&&(n=r+m),d+m>a&&(n=a-m)}if(this.lngRange){var g=this.x,y=u.x/2;g-y<s&&(i=s+y),g+y>l&&(i=l-y)}void 0===i&&void 0===n||(this.center=this.unproject(new o(void 0!==i?i:this.x,void 0!==n?n:this.y))),this._unmodified=c,this._constraining=!1}},d.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,e=Math.PI/2+this._pitch,i=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-e-t),n=1.01*(Math.cos(Math.PI/2-this._pitch)*i+this.cameraToCenterDistance),o=new Float64Array(16);p.perspective(o,this._fov,this.width/this.height,1,n),p.scale(o,o,[1,-1,1]),p.translate(o,o,[0,0,-this.cameraToCenterDistance]),p.rotateX(o,o,this._pitch),p.rotateZ(o,o,this.angle),p.translate(o,o,[-this.x,-this.y,0]);var r=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));if(p.scale(o,o,[1,1,r,1]),this.projMatrix=o,o=p.create(),p.scale(o,o,[this.width/2,-this.height/2,1]),p.translate(o,o,[1,-1,0]),this.pixelMatrix=p.multiply(new Float64Array(16),o,this.projMatrix),!(o=p.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=o}},Object.defineProperties(d.prototype,m),e.exports=d},{"../data/extent":65,"../source/tile_coord":107,"../style-spec/util/interpolate":124,"../util/util":219,"./coordinate":72,"./lng_lat":73,"@mapbox/gl-matrix":1,"point-geometry":37}],76:[function(t,e,i){"use strict";var n=t("mapbox-gl-supported"),o=t("./util/browser"),r=t("../package.json").version,a=t("./ui/map"),s=t("./ui/control/navigation_control"),l=t("./ui/control/geolocate_control"),u=t("./ui/control/attribution_control"),c=t("./ui/control/scale_control"),h=t("./ui/control/fullscreen_control"),p=t("./ui/popup"),f=t("./ui/marker"),d=t("./style/style"),m=t("./geo/lng_lat"),g=t("./geo/lng_lat_bounds"),y=t("point-geometry"),v=t("./util/evented"),_=t("./util/config"),x=t("./source/rtl_text_plugin");e.exports={version:r,supported:n,workerCount:Math.max(Math.floor(o.hardwareConcurrency/2),1),setRTLTextPlugin:x.setRTLTextPlugin,Map:a,NavigationControl:s,GeolocateControl:l,AttributionControl:u,ScaleControl:c,FullscreenControl:h,Popup:p,Marker:f,Style:d,LngLat:m,LngLatBounds:g,Point:y,Evented:v,config:_,get accessToken(){return _.ACCESS_TOKEN},set accessToken(t){_.ACCESS_TOKEN=t}}},{"../package.json":54,"./geo/lng_lat":73,"./geo/lng_lat_bounds":74,"./source/rtl_text_plugin":102,"./style/style":150,"./ui/control/attribution_control":179,"./ui/control/fullscreen_control":180,"./ui/control/geolocate_control":181,"./ui/control/navigation_control":183,"./ui/control/scale_control":184,"./ui/map":193,"./ui/marker":194,"./ui/popup":195,"./util/browser":198,"./util/config":202,"./util/evented":206,"mapbox-gl-supported":34,"point-geometry":37}],77:[function(t,e,i){"use strict";var n=t("./pattern");e.exports=function(t,e,i){var o=t.gl,r=t.transform,a=r.tileSize,s=i.paint["background-color"],l=i.paint["background-pattern"],u=i.paint["background-opacity"],c=!l&&1===s[3]&&1===u;if(t.isOpaquePass===c){o.disable(o.STENCIL_TEST),t.setDepthSublayer(0);var h;if(l){if(n.isPatternMissing(l,t))return;h=t.useProgram("fillPattern",t.basicFillProgramConfiguration),n.prepare(l,t,h),t.tileExtentPatternVAO.bind(o,h,t.tileExtentBuffer)}else h=t.useProgram("fill",t.basicFillProgramConfiguration),o.uniform4fv(h.u_color,s),t.tileExtentVAO.bind(o,h,t.tileExtentBuffer);o.uniform1f(h.u_opacity,u);for(var p=0,f=r.coveringTiles({tileSize:a});p<f.length;p+=1){var d=f[p];l&&n.setTile({coord:d,tileSize:a},t,h),o.uniformMatrix4fv(h.u_matrix,!1,t.transform.calculatePosMatrix(d)),o.drawArrays(o.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}},{"./pattern":89}],78:[function(t,e,i){"use strict";var n=t("../util/browser"),o=t("../source/pixels_to_tile_units");e.exports=function(t,e,i,r){if(!t.isOpaquePass){var a=t.gl;t.setDepthSublayer(0),t.depthMask(!1),a.disable(a.STENCIL_TEST);for(var s=0;s<r.length;s++){var l=r[s],u=e.getTile(l),c=u.getBucket(i);if(c){var h=c.buffers,p=h.layerData[i.id],f=p.programConfiguration,d=t.useProgram("circle",f);if(f.setUniforms(a,d,i,{zoom:t.transform.zoom}),a.uniform1f(d.u_camera_to_center_distance,t.transform.cameraToCenterDistance),a.uniform1i(d.u_scale_with_map,"map"===i.paint["circle-pitch-scale"]),"map"===i.paint["circle-pitch-alignment"]){a.uniform1i(d.u_pitch_with_map,!0);var m=o(u,1,t.transform.zoom);a.uniform2f(d.u_extrude_scale,m,m)}else a.uniform1i(d.u_pitch_with_map,!1),a.uniform2fv(d.u_extrude_scale,t.transform.pixelsToGLUnits);a.uniform1f(d.u_devicepixelratio,n.devicePixelRatio),a.uniformMatrix4fv(d.u_matrix,!1,t.translatePosMatrix(l.posMatrix,u,i.paint["circle-translate"],i.paint["circle-translate-anchor"]));for(var g=0,y=h.segments;g<y.length;g+=1){var v=y[g];v.vaos[i.id].bind(a,d,h.layoutVertexBuffer,h.elementBuffer,p.paintVertexBuffer,v.vertexOffset),a.drawElements(a.TRIANGLES,3*v.primitiveLength,a.UNSIGNED_SHORT,3*v.primitiveOffset*2)}}}}}},{"../source/pixels_to_tile_units":99,"../util/browser":198}],79:[function(t,e,i){"use strict";e.exports=function(t,e,i,n){var o=t.gl;o.enable(o.STENCIL_TEST);var r=t.useProgram("collisionBox");o.activeTexture(o.TEXTURE1),t.frameHistory.bind(o),o.uniform1i(r.u_fadetexture,1);for(var a=0;a<n.length;a++){var s=n[a],l=e.getTile(s),u=l.getBucket(i);if(u){var c=u.buffers.collisionBox;if(c){o.uniformMatrix4fv(r.u_matrix,!1,s.posMatrix),t.enableTileClippingMask(s),t.lineWidth(1),o.uniform1f(r.u_scale,Math.pow(2,t.transform.zoom-l.coord.z)),o.uniform1f(r.u_zoom,10*t.transform.zoom);var h=Math.max(0,Math.min(25,l.coord.z+Math.log(l.collisionTile.maxScale)/Math.LN2));o.uniform1f(r.u_maxzoom,10*h),o.uniform1f(r.u_collision_y_stretch,l.collisionTile.yStretch),o.uniform1f(r.u_pitch,t.transform.pitch/360*2*Math.PI),o.uniform1f(r.u_camera_to_center_distance,t.transform.cameraToCenterDistance);for(var p=0,f=c.segments;p<f.length;p+=1){var d=f[p];d.vaos[i.id].bind(o,r,c.layoutVertexBuffer,c.elementBuffer,null,d.vertexOffset),o.drawElements(o.LINES,2*d.primitiveLength,o.UNSIGNED_SHORT,2*d.primitiveOffset*2)}}}}}},{}],80:[function(t,e,i){"use strict";function n(t,e,i){var n=t.gl;n.disable(n.STENCIL_TEST),t.lineWidth(1*r.devicePixelRatio);var h=i.posMatrix,p=t.useProgram("debug");n.uniformMatrix4fv(p.u_matrix,!1,h),n.uniform4f(p.u_color,1,0,0,1),t.debugVAO.bind(n,p,t.debugBuffer),n.drawArrays(n.LINE_STRIP,0,t.debugBuffer.length);for(var f=o(i.toString(),50,200,5),d=new c,m=0;m<f.length;m+=2)d.emplaceBack(f[m],f[m+1]);var g=l.fromStructArray(d,l.BufferType.VERTEX);(new u).bind(n,p,g),n.uniform4f(p.u_color,1,1,1,1);for(var y=e.getTile(i).tileSize,v=s/(Math.pow(2,t.transform.zoom-i.z)*y),_=[[-1,-1],[-1,1],[1,-1],[1,1]],x=0;x<_.length;x++){var b=_[x];n.uniformMatrix4fv(p.u_matrix,!1,a.translate([],h,[v*b[0],v*b[1],0])),n.drawArrays(n.LINES,0,g.length)}n.uniform4f(p.u_color,0,0,0,1),n.uniformMatrix4fv(p.u_matrix,!1,h),n.drawArrays(n.LINES,0,g.length)}function o(t,e,i,n){n=n||1;var o,r,a,s,l,u,c,p,f=[];for(o=0,r=t.length;o<r;o++)if(l=h[t[o]]){for(p=null,a=0,s=l[1].length;a<s;a+=2)-1===l[1][a]&&-1===l[1][a+1]?p=null:(u=e+l[1][a]*n,c=i-l[1][a+1]*n,p&&f.push(p.x,p.y,u,c),p={x:u,y:c});e+=l[0]*n}return f}var r=t("../util/browser"),a=t("@mapbox/gl-matrix").mat4,s=t("../data/extent"),l=t("../data/buffer"),u=t("./vertex_array_object"),c=t("../data/pos_array");e.exports=function(t,e,i){for(var o=0;o<i.length;o++)n(t,e,i[o])};var h={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]}},{"../data/buffer":62,"../data/extent":65,"../data/pos_array":68,"../util/browser":198,"./vertex_array_object":90,"@mapbox/gl-matrix":1}],81:[function(t,e,i){"use strict";function n(t,e,i,n,o){if(!s.isPatternMissing(i.paint["fill-pattern"],t))for(var r=!0,a=0,l=n;a<l.length;a+=1){var u=l[a],c=e.getTile(u),h=c.getBucket(i);h&&(t.enableTileClippingMask(u),o(t,e,i,c,u,h.buffers,r),r=!1)}}function o(t,e,i,n,o,r,s){for(var l=t.gl,u=r.layerData[i.id],c=a("fill",i.paint["fill-pattern"],t,u,i,n,o,s),h=0,p=r.segments;h<p.length;h+=1){var f=p[h];f.vaos[i.id].bind(l,c,r.layoutVertexBuffer,r.elementBuffer,u.paintVertexBuffer,f.vertexOffset),l.drawElements(l.TRIANGLES,3*f.primitiveLength,l.UNSIGNED_SHORT,3*f.primitiveOffset*2)}}function r(t,e,i,n,o,r,s){var l=t.gl,u=r.layerData[i.id],c=a("fillOutline",i.paint["fill-pattern"]&&!i.getPaintProperty("fill-outline-color"),t,u,i,n,o,s);l.uniform2f(c.u_world,l.drawingBufferWidth,l.drawingBufferHeight);for(var h=0,p=r.segments2;h<p.length;h+=1){var f=p[h];f.vaos[i.id].bind(l,c,r.layoutVertexBuffer,r.elementBuffer2,u.paintVertexBuffer,f.vertexOffset),l.drawElements(l.LINES,2*f.primitiveLength,l.UNSIGNED_SHORT,2*f.primitiveOffset*2)}}function a(t,e,i,n,o,r,a,l){var u,c=i.currentProgram;return e?(u=i.useProgram(t+"Pattern",n.programConfiguration),(l||u!==c)&&(n.programConfiguration.setUniforms(i.gl,u,o,{zoom:i.transform.zoom}),s.prepare(o.paint["fill-pattern"],i,u)),s.setTile(r,i,u)):(u=i.useProgram(t,n.programConfiguration),(l||u!==c)&&n.programConfiguration.setUniforms(i.gl,u,o,{zoom:i.transform.zoom})),i.gl.uniformMatrix4fv(u.u_matrix,!1,i.translatePosMatrix(a.posMatrix,r,o.paint["fill-translate"],o.paint["fill-translate-anchor"])),u}var s=t("./pattern");e.exports=function(t,e,i,a){var s=t.gl;s.enable(s.STENCIL_TEST);var l=!i.paint["fill-pattern"]&&i.isPaintValueFeatureConstant("fill-color")&&i.isPaintValueFeatureConstant("fill-opacity")&&1===i.paint["fill-color"][3]&&1===i.paint["fill-opacity"];t.isOpaquePass===l&&(t.setDepthSublayer(1),n(t,e,i,a,o)),!t.isOpaquePass&&i.paint["fill-antialias"]&&(t.lineWidth(2),t.depthMask(!1),t.setDepthSublayer(i.getPaintProperty("fill-outline-color")?2:0),n(t,e,i,a,r))}},{"./pattern":89}],82:[function(t,e,i){"use strict";function n(t,e){t.activeTexture(t.TEXTURE1);var i=e.viewportTexture;i?t.bindTexture(t.TEXTURE_2D,i):(i=t.createTexture(),t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,null),e.viewportTexture=i);var n=e.viewportFbo;if(n)t.bindFramebuffer(t.FRAMEBUFFER,n);else{n=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,n);var o=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,o),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,o),e.viewportFbo=n}return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),i}function o(t,e,i,n){var o=e.useProgram("extrusionTexture");t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n),t.uniform1f(o.u_opacity,i.paint["fill-extrusion-opacity"]),t.uniform1i(o.u_image,1);var r=f.create();f.ortho(r,0,e.width,e.height,0,0,1),t.uniformMatrix4fv(o.u_matrix,!1,r),t.disable(t.DEPTH_TEST),t.uniform2f(o.u_world,t.drawingBufferWidth,t.drawingBufferHeight);var a=new c;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1);var s=l.fromStructArray(a,l.BufferType.VERTEX);(new u).bind(t,o,s),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.enable(t.DEPTH_TEST)}function r(t,e,i,n){var o=e.getTile(n),r=o.getBucket(i);if(r){var s=r.buffers,l=t.gl,u=i.paint["fill-extrusion-pattern"],c=s.layerData[i.id],p=c.programConfiguration,f=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",p);if(p.setUniforms(l,f,i,{zoom:t.transform.zoom}),u){if(h.isPatternMissing(u,t))return;h.prepare(u,t,f),h.setTile(o,t,f),l.uniform1f(f.u_height_factor,-Math.pow(2,n.z)/o.tileSize/8)}t.gl.uniformMatrix4fv(f.u_matrix,!1,t.translatePosMatrix(n.posMatrix,o,i.paint["fill-extrusion-translate"],i.paint["fill-extrusion-translate-anchor"])),a(f,t);for(var d=0,m=s.segments;d<m.length;d+=1){var g=m[d];g.vaos[i.id].bind(l,f,s.layoutVertexBuffer,s.elementBuffer,c.paintVertexBuffer,g.vertexOffset),l.drawElements(l.TRIANGLES,3*g.primitiveLength,l.UNSIGNED_SHORT,3*g.primitiveOffset*2)}}}function a(t,e){var i=e.gl,n=e.style.light,o=n.calculated.position,r=[o.x,o.y,o.z],a=p.create();"viewport"===n.calculated.anchor&&p.fromRotation(a,-e.transform.angle),d.transformMat3(r,r,a),i.uniform3fv(t.u_lightpos,r),i.uniform1f(t.u_lightintensity,n.calculated.intensity),i.uniform3fv(t.u_lightcolor,n.calculated.color.slice(0,3))}var s=t("@mapbox/gl-matrix"),l=t("../data/buffer"),u=t("./vertex_array_object"),c=t("../data/pos_array"),h=t("./pattern"),p=s.mat3,f=s.mat4,d=s.vec3;e.exports=function(t,e,i,a){if(!t.isOpaquePass&&0!==i.paint["fill-extrusion-opacity"]){var s=t.gl;s.disable(s.STENCIL_TEST),s.enable(s.DEPTH_TEST),t.depthMask(!0);var l=n(s,t);s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);for(var u=0;u<a.length;u++)r(t,e,i,a[u]);s.bindFramebuffer(s.FRAMEBUFFER,null),o(s,t,i,l)}}},{"../data/buffer":62,"../data/pos_array":68,"./pattern":89,"./vertex_array_object":90,"@mapbox/gl-matrix":1}],83:[function(t,e,i){"use strict";function n(t,e,i,n,a,s,l,u,c){var h,p,f,d,m=e.gl,g=a.paint["line-dasharray"],y=a.paint["line-pattern"];if(u||c){var v=1/r(i,1,e.transform.tileZoom);if(g){h=e.lineAtlas.getDash(g.from,"round"===a.layout["line-cap"]),p=e.lineAtlas.getDash(g.to,"round"===a.layout["line-cap"]);var _=h.width*g.fromScale,x=p.width*g.toScale;m.uniform2f(t.u_patternscale_a,v/_,-h.height/2),m.uniform2f(t.u_patternscale_b,v/x,-p.height/2),m.uniform1f(t.u_sdfgamma,e.lineAtlas.width/(256*Math.min(_,x)*o.devicePixelRatio)/2)}else if(y){if(f=e.spriteAtlas.getPattern(y.from),d=e.spriteAtlas.getPattern(y.to),!f||!d)return;m.uniform2f(t.u_pattern_size_a,f.displaySize[0]*y.fromScale/v,d.displaySize[1]),m.uniform2f(t.u_pattern_size_b,d.displaySize[0]*y.toScale/v,d.displaySize[1]),m.uniform2fv(t.u_texsize,e.spriteAtlas.getPixelSize())}m.uniform2f(t.u_gl_units_to_pixels,1/e.transform.pixelsToGLUnits[0],1/e.transform.pixelsToGLUnits[1])}u&&(g?(m.uniform1i(t.u_image,0),m.activeTexture(m.TEXTURE0),e.lineAtlas.bind(m),m.uniform1f(t.u_tex_y_a,h.y),m.uniform1f(t.u_tex_y_b,p.y),m.uniform1f(t.u_mix,g.t)):y&&(m.uniform1i(t.u_image,0),m.activeTexture(m.TEXTURE0),e.spriteAtlas.bind(m,!0),m.uniform2fv(t.u_pattern_tl_a,f.tl),m.uniform2fv(t.u_pattern_br_a,f.br),m.uniform2fv(t.u_pattern_tl_b,d.tl),m.uniform2fv(t.u_pattern_br_b,d.br),m.uniform1f(t.u_fade,y.t))),e.enableTileClippingMask(s);var b=e.translatePosMatrix(s.posMatrix,i,a.paint["line-translate"],a.paint["line-translate-anchor"]);m.uniformMatrix4fv(t.u_matrix,!1,b),m.uniform1f(t.u_ratio,1/r(i,1,e.transform.zoom));for(var w=0,T=n.segments;w<T.length;w+=1){var E=T[w];E.vaos[a.id].bind(m,t,n.layoutVertexBuffer,n.elementBuffer,l.paintVertexBuffer,E.vertexOffset),m.drawElements(m.TRIANGLES,3*E.primitiveLength,m.UNSIGNED_SHORT,3*E.primitiveOffset*2)}}var o=t("../util/browser"),r=t("../source/pixels_to_tile_units");e.exports=function(t,e,i,o){if(!t.isOpaquePass){t.setDepthSublayer(0),t.depthMask(!1);var r=t.gl;if(r.enable(r.STENCIL_TEST),!(i.paint["line-width"]<=0))for(var a,s=i.paint["line-dasharray"]?"lineSDF":i.paint["line-pattern"]?"linePattern":"line",l=!0,u=0,c=o;u<c.length;u+=1){var h=c[u],p=e.getTile(h),f=p.getBucket(i);if(f){var d=f.buffers.layerData[i.id],m=t.currentProgram,g=t.useProgram(s,d.programConfiguration),y=l||g!==m,v=a!==p.coord.z;y&&d.programConfiguration.setUniforms(t.gl,g,i,{zoom:t.transform.zoom}),n(g,t,p,f.buffers,i,h,d,y,v),a=p.coord.z,l=!1}}}}},{"../source/pixels_to_tile_units":99,"../util/browser":198}],84:[function(t,e,i){"use strict";function n(t,e,i,n){var l=t.gl;l.disable(l.STENCIL_TEST);var u=e.getTile(n),c=t.transform.calculatePosMatrix(n,e.getSource().maxzoom);u.registerFadeDuration(t.style.animationLoop,i.paint["raster-fade-duration"]);var h=t.useProgram("raster");l.uniformMatrix4fv(h.u_matrix,!1,c),l.uniform1f(h.u_brightness_low,i.paint["raster-brightness-min"]),l.uniform1f(h.u_brightness_high,i.paint["raster-brightness-max"]),l.uniform1f(h.u_saturation_factor,a(i.paint["raster-saturation"])),l.uniform1f(h.u_contrast_factor,r(i.paint["raster-contrast"])),l.uniform3fv(h.u_spin_weights,o(i.paint["raster-hue-rotate"]));var p,f,d=u.sourceCache&&u.sourceCache.findLoadedParent(n,0,{}),m=s(u,d,i,t.transform);l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.texture),l.activeTexture(l.TEXTURE1),d?(l.bindTexture(l.TEXTURE_2D,d.texture),p=Math.pow(2,d.coord.z-u.coord.z),f=[u.coord.x*p%1,u.coord.y*p%1]):l.bindTexture(l.TEXTURE_2D,u.texture),l.uniform2fv(h.u_tl_parent,f||[0,0]),l.uniform1f(h.u_scale_parent,p||1),l.uniform1f(h.u_buffer_scale,1),l.uniform1f(h.u_fade_t,m.mix),l.uniform1f(h.u_opacity,m.opacity*i.paint["raster-opacity"]),l.uniform1i(h.u_image0,0),l.uniform1i(h.u_image1,1);var g=u.boundsBuffer||t.rasterBoundsBuffer;(u.boundsVAO||t.rasterBoundsVAO).bind(l,h,g),l.drawArrays(l.TRIANGLE_STRIP,0,g.length)}function o(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}function r(t){return t>0?1/(1-t):1+t}function a(t){return t>0?1-1/(1.001-t):-t}function s(t,e,i,n){var o=i.paint["raster-fade-duration"];if(t.sourceCache&&o>0){var r=Date.now(),a=(r-t.timeAdded)/o,s=e?(r-e.timeAdded)/o:-1,u=t.sourceCache.getSource(),c=n.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!e||Math.abs(e.coord.z-c)>Math.abs(t.coord.z-c),p=h&&t.refreshedUponExpiration?1:l.clamp(h?a:1-s,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var l=t("../util/util");e.exports=function(t,e,i,o){if(!t.isOpaquePass){var r=t.gl;r.enable(r.DEPTH_TEST),t.depthMask(!0),r.depthFunc(r.LESS);for(var a=o.length&&o[0].z,s=0;s<o.length;s++){var l=o[s];t.setDepthSublayer(l.z-a),n(t,e,i,l)}r.depthFunc(r.LEQUAL)}}},{"../util/util":219}],85:[function(t,e,i){"use strict";function n(t,e,i,n,a,s,c,p,f,d){if(a||!t.style.sprite||t.style.sprite.loaded()){var m=t.gl,g="map"===p,y="map"===f,v=g&&"line"===i.layout["symbol-placement"],_=g&&!y&&!v,x=y;x?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST);for(var b,w,T=0,E=n;T<E.length;T+=1){var C=E[T],S=e.getTile(C),A=S.getBucket(i);if(A){var k=a?A.buffers.glyph:A.buffers.icon;if(k&&k.segments.length){var I=k.layerData[i.id].programConfiguration,L=a||A.sdfIcons,D=a?A.textSizeData:A.iconSizeData;b&&A.fontstack===w||(b=t.useProgram(L?"symbolSDF":"symbolIcon",I),I.setUniforms(m,b,i,{zoom:t.transform.zoom}),o(b,t,i,C.z,a,L,_,y,A.fontstack,A.iconsNeedLinear,D)),t.enableTileClippingMask(C),m.uniformMatrix4fv(b.u_matrix,!1,t.translatePosMatrix(C.posMatrix,S,s,c));var P=l(S,1,t.transform.zoom),z=u.getLabelPlaneMatrix(C.posMatrix,y,g,t.transform,P),M=u.getGlCoordMatrix(C.posMatrix,y,g,t.transform,P);m.uniformMatrix4fv(b.u_gl_coord_matrix,!1,t.translatePosMatrix(M,S,s,c,!0)),v?(m.uniformMatrix4fv(b.u_label_plane_matrix,!1,h),u.updateLineLabels(A,C.posMatrix,t,a,z,M,y,d,P,i)):m.uniformMatrix4fv(b.u_label_plane_matrix,!1,z),m.uniform1f(b.u_collision_y_stretch,S.collisionTile.yStretch),r(b,I,t,i,S,k,a,L,y),w=A.fontstack}}}x||m.enable(m.DEPTH_TEST)}}function o(t,e,i,n,o,r,a,s,l,u,h){var p=e.gl,f=e.transform;if(p.uniform1i(t.u_pitch_with_map,s),p.activeTexture(p.TEXTURE0),p.uniform1i(t.u_texture,0),p.uniform1f(t.u_is_text,o?1:0),o){var d=l&&e.glyphSource.getGlyphAtlas(l);if(!d)return;d.updateTexture(p),p.uniform2f(t.u_texsize,d.width,d.height)}else{var m=e.options.rotating||e.options.zooming,g=!i.isLayoutValueFeatureConstant("icon-size")||!i.isLayoutValueZoomConstant("icon-size")||1!==i.getLayoutValue("icon-size",{zoom:f.zoom})||u,y=s||f.pitch;e.spriteAtlas.bind(p,r||m||g||y),p.uniform2fv(t.u_texsize,e.spriteAtlas.getPixelSize())}p.activeTexture(p.TEXTURE1),e.frameHistory.bind(p),p.uniform1i(t.u_fadetexture,1),p.uniform1f(t.u_pitch,f.pitch/360*2*Math.PI),p.uniform1i(t.u_is_size_zoom_constant,h.isZoomConstant?1:0),p.uniform1i(t.u_is_size_feature_constant,h.isFeatureConstant?1:0),p.uniform1f(t.u_camera_to_center_distance,f.cameraToCenterDistance);var v=c.evaluateSizeForZoom(h,f,i,o);void 0!==v.uSizeT&&p.uniform1f(t.u_size_t,v.uSizeT),void 0!==v.uSize&&p.uniform1f(t.u_size,v.uSize),p.uniform1f(t.u_aspect_ratio,f.width/f.height),p.uniform1i(t.u_rotate_symbol,a)}function r(t,e,i,n,o,r,s,l,u){var c=i.gl,h=i.transform;if(l){var p=(s?"text":"icon")+"-halo-width",f=!n.isPaintValueFeatureConstant(p)||n.paint[p],d=u?Math.cos(h._pitch)*h.cameraToCenterDistance:1;c.uniform1f(t.u_gamma_scale,d),f&&(c.uniform1f(t.u_is_halo,1),a(r,n,c,t)),c.uniform1f(t.u_is_halo,0)}a(r,n,c,t)}function a(t,e,i,n){for(var o=t.layerData[e.id],r=o&&o.paintVertexBuffer,a=0,s=t.segments;a<s.length;a+=1){var l=s[a];l.vaos[e.id].bind(i,n,t.layoutVertexBuffer,t.elementBuffer,r,l.vertexOffset,t.dynamicLayoutVertexBuffer),i.drawElements(i.TRIANGLES,3*l.primitiveLength,i.UNSIGNED_SHORT,3*l.primitiveOffset*2)}}var s=t("./draw_collision_debug"),l=t("../source/pixels_to_tile_units"),u=t("../symbol/projection"),c=t("../symbol/symbol_size"),h=t("@mapbox/gl-matrix").mat4.identity(new Float32Array(16));e.exports=function(t,e,i,o){if(!t.isOpaquePass){var r=!(i.layout["text-allow-overlap"]||i.layout["icon-allow-overlap"]||i.layout["text-ignore-placement"]||i.layout["icon-ignore-placement"]),a=t.gl;r?a.disable(a.STENCIL_TEST):a.enable(a.STENCIL_TEST),t.setDepthSublayer(0),t.depthMask(!1),n(t,e,i,o,!1,i.paint["icon-translate"],i.paint["icon-translate-anchor"],i.layout["icon-rotation-alignment"],i.layout["icon-pitch-alignment"],i.layout["icon-keep-upright"]),n(t,e,i,o,!0,i.paint["text-translate"],i.paint["text-translate-anchor"],i.layout["text-rotation-alignment"],i.layout["text-pitch-alignment"],i.layout["text-keep-upright"]),e.map.showCollisionBoxes&&s(t,e,i,o)}}},{"../source/pixels_to_tile_units":99,"../symbol/projection":171,"../symbol/symbol_size":175,"./draw_collision_debug":79,"@mapbox/gl-matrix":1}],86:[function(t,e,i){"use strict";var n=function(){this.changeTimes=new Float64Array(256),this.changeOpacities=new Uint8Array(256),this.opacities=new Uint8ClampedArray(256),this.array=new Uint8Array(this.opacities.buffer),this.previousZoom=0,this.firstFrame=!0};n.prototype.record=function(t,e,i){var n=this;this.firstFrame&&(t=0,this.firstFrame=!1);var o;if((e=Math.floor(10*e))<this.previousZoom)for(o=e+1;o<=this.previousZoom;o++)n.changeTimes[o]=t,n.changeOpacities[o]=n.opacities[o];else for(o=e;o>this.previousZoom;o--)n.changeTimes[o]=t,n.changeOpacities[o]=n.opacities[o];for(o=0;o<256;o++){var r=t-n.changeTimes[o],a=255*(i?r/i:1);n.opacities[o]=o<=e?n.changeOpacities[o]+a:n.changeOpacities[o]-a}this.changed=!0,this.previousZoom=e},n.prototype.isVisible=function(t){return 0!==this.opacities[Math.floor(10*t)]},n.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.changed&&(t.texSubImage2D(t.TEXTURE_2D,0,0,0,256,1,t.ALPHA,t.UNSIGNED_BYTE,this.array),this.changed=!1)):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,256,1,0,t.ALPHA,t.UNSIGNED_BYTE,this.array))},e.exports=n},{}],87:[function(t,e,i){"use strict";var n=t("../util/util"),o=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};o.prototype.setSprite=function(t){this.sprite=t},o.prototype.getDash=function(t,e){var i=t.join(",")+e;return this.positions[i]||(this.positions[i]=this.addDash(t,e)),this.positions[i]},o.prototype.addDash=function(t,e){var i=this,o=e?7:0,r=2*o+1;if(this.nextRow+r>this.height)return n.warnOnce("LineAtlas out of space"),null;for(var a=0,s=0;s<t.length;s++)a+=t[s];for(var l=this.width/a,u=l/2,c=t.length%2==1,h=-o;h<=o;h++)for(var p=i.nextRow+o+h,f=i.width*p,d=c?-t[t.length-1]:0,m=t[0],g=1,y=0;y<this.width;y++){for(;m<y/l;)d=m,m+=t[g],c&&g===t.length-1&&(m+=t[0]),g++;var v=Math.abs(y-d*l),_=Math.abs(y-m*l),x=Math.min(v,_),b=g%2==1,w=void 0;if(e){var T=o?h/o*(u+1):0;if(b){var E=u-Math.abs(T);w=Math.sqrt(x*x+E*E)}else w=u-Math.sqrt(x*x+T*T)}else w=(b?1:-1)*x;i.data[3+4*(f+y)]=Math.max(0,Math.min(255,w+128))}var C={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:a};return this.nextRow+=r,this.dirty=!0,C},o.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))},e.exports=o},{"../util/util":219}],88:[function(t,e,i){"use strict";var n=t("../util/browser"),o=t("@mapbox/gl-matrix").mat4,r=t("./frame_history"),a=t("../source/source_cache"),s=t("../data/extent"),l=t("../source/pixels_to_tile_units"),u=t("../util/util"),c=t("../data/buffer"),h=t("./vertex_array_object"),p=t("../data/raster_bounds_array"),f=t("../data/pos_array"),d=t("../data/program_configuration"),m=t("../shaders"),g=t("assert"),y={symbol:t("./draw_symbol"),circle:t("./draw_circle"),line:t("./draw_line"),fill:t("./draw_fill"),"fill-extrusion":t("./draw_fill_extrusion"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug")},v=function(t,e){this.gl=t,this.transform=e,this._tileTextures={},this.frameHistory=new r,this.setup(),this.numSublayers=a.maxUnderzooming+a.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.lineWidthRange=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE),this.basicFillProgramConfiguration=d.createBasicFill(),this.emptyProgramConfiguration=new d};v.prototype.resize=function(t,e){var i=this.gl;this.width=t*n.devicePixelRatio,this.height=e*n.devicePixelRatio,i.viewport(0,0,this.width,this.height),this.viewportTexture&&(this.gl.deleteTexture(this.viewportTexture),this.viewportTexture=null),this.viewportFbo&&(this.gl.deleteFramebuffer(this.viewportFbo),this.viewportFbo=null)},v.prototype.setup=function(){var t=this.gl;t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.STENCIL_TEST),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),this._depthMask=!1,t.depthMask(!1);var e=new f;e.emplaceBack(0,0),e.emplaceBack(s,0),e.emplaceBack(0,s),e.emplaceBack(s,s),this.tileExtentBuffer=c.fromStructArray(e,c.BufferType.VERTEX),this.tileExtentVAO=new h,this.tileExtentPatternVAO=new h;var i=new f;i.emplaceBack(0,0),i.emplaceBack(s,0),i.emplaceBack(s,s),i.emplaceBack(0,s),i.emplaceBack(0,0),this.debugBuffer=c.fromStructArray(i,c.BufferType.VERTEX),this.debugVAO=new h;var n=new p;n.emplaceBack(0,0,0,0),n.emplaceBack(s,0,32767,0),n.emplaceBack(0,s,0,32767),n.emplaceBack(s,s,32767,32767),this.rasterBoundsBuffer=c.fromStructArray(n,c.BufferType.VERTEX),this.rasterBoundsVAO=new h,this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))},v.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},v.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},v.prototype.clearDepth=function(){var t=this.gl;t.clearDepth(1),this.depthMask(!0),t.clear(t.DEPTH_BUFFER_BIT)},v.prototype._renderTileClippingMasks=function(t){var e=this,i=this.gl;i.colorMask(!1,!1,!1,!1),this.depthMask(!1),i.disable(i.DEPTH_TEST),i.enable(i.STENCIL_TEST),i.stencilMask(255),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE);var n=1;this._tileClippingMaskIDs={};for(var o=0,r=t;o<r.length;o+=1){var a=r[o],s=e._tileClippingMaskIDs[a.id]=n++;i.stencilFunc(i.ALWAYS,s,255);var l=e.useProgram("fill",e.basicFillProgramConfiguration);i.uniformMatrix4fv(l.u_matrix,!1,a.posMatrix),e.tileExtentVAO.bind(i,l,e.tileExtentBuffer),i.drawArrays(i.TRIANGLE_STRIP,0,e.tileExtentBuffer.length)}i.stencilMask(0),i.colorMask(!0,!0,!0,!0),this.depthMask(!0),i.enable(i.DEPTH_TEST)},v.prototype.enableTileClippingMask=function(t){var e=this.gl;e.stencilFunc(e.EQUAL,this._tileClippingMaskIDs[t.id],255)},v.prototype.prepareBuffers=function(){},v.prototype.render=function(t,e){if(this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.spriteAtlas=t.spriteAtlas,this.spriteAtlas.setSprite(t.sprite),this.glyphSource=t.glyphSource,this.frameHistory.record(Date.now(),this.transform.zoom,t.getTransition().duration),this.prepareBuffers(),this.clearColor(),this.clearDepth(),this.showOverdrawInspector(e.showOverdrawInspector),this.depthRange=(t._order.length+2)*this.numSublayers*this.depthEpsilon,this.isOpaquePass=!0,this.renderPass(),this.isOpaquePass=!1,this.renderPass(),this.options.showTileBoundaries){var i=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];i&&y.debug(this,i,i.getVisibleCoordinates())}},v.prototype.renderPass=function(){var t,e=this,i=this.style._order,n=[];this.currentLayer=this.isOpaquePass?i.length-1:0,this.isOpaquePass?this._showOverdrawInspector||this.gl.disable(this.gl.BLEND):this.gl.enable(this.gl.BLEND);for(var o=0;o<i.length;o++){var r=e.style._layers[i[e.currentLayer]];r.source!==(t&&t.id)&&(n=[],(t=e.style.sourceCaches[r.source])&&(t.prepare&&t.prepare(),e.clearStencil(),n=t.getVisibleCoordinates(),t.getSource().isTileClipped&&e._renderTileClippingMasks(n)),e.isOpaquePass||n.reverse()),e.renderLayer(e,t,r,n),e.currentLayer+=e.isOpaquePass?-1:1}},v.prototype.depthMask=function(t){t!==this._depthMask&&(this._depthMask=t,this.gl.depthMask(t))},v.prototype.renderLayer=function(t,e,i,n){i.isHidden(this.transform.zoom)||("background"===i.type||n.length)&&(this.id=i.id,y[i.type](t,e,i,n))},v.prototype.setDepthSublayer=function(t){var e=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,i=e-1+this.depthRange;this.gl.depthRange(i,e)},v.prototype.translatePosMatrix=function(t,e,i,n,r){if(!i[0]&&!i[1])return t;var a=r?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);i=[i[0]*u-i[1]*s,i[0]*s+i[1]*u]}var c=[r?i[0]:l(e,i[0],this.transform.zoom),r?i[1]:l(e,i[1],this.transform.zoom),0],h=new Float32Array(16);return o.translate(h,t,c),h},v.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size];e?e.push(t):this._tileTextures[t.size]=[t]},v.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},v.prototype.lineWidth=function(t){this.gl.lineWidth(u.clamp(t,this.lineWidthRange[0],this.lineWidthRange[1]))},v.prototype.showOverdrawInspector=function(t){if(t||this._showOverdrawInspector){this._showOverdrawInspector=t;var e=this.gl;if(t){e.blendFunc(e.CONSTANT_COLOR,e.ONE);e.blendColor(1/8,1/8,1/8,0),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)}else e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}},v.prototype.createProgram=function(t,e){var i=this.gl,o=i.createProgram(),r=e.defines().concat("#define DEVICE_PIXEL_RATIO "+n.devicePixelRatio.toFixed(1));this._showOverdrawInspector&&r.push("#define OVERDRAW_INSPECTOR;");var a=r.concat(m.prelude.fragmentSource,m[t].fragmentSource).join("\n"),s=r.concat(m.prelude.vertexSource,m[t].vertexSource).join("\n"),l=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(l,a),i.compileShader(l),g(i.getShaderParameter(l,i.COMPILE_STATUS),i.getShaderInfoLog(l)),i.attachShader(o,l);var u=i.createShader(i.VERTEX_SHADER);i.shaderSource(u,s),i.compileShader(u),g(i.getShaderParameter(u,i.COMPILE_STATUS),i.getShaderInfoLog(u)),i.attachShader(o,u);for(var c=e.interface?e.interface.layoutAttributes:[],h=0;h<c.length;h++)i.bindAttribLocation(o,h,c[h].name);i.linkProgram(o),g(i.getProgramParameter(o,i.LINK_STATUS),i.getProgramInfoLog(o));for(var p=i.getProgramParameter(o,i.ACTIVE_ATTRIBUTES),f={program:o,numAttributes:p},d=0;d<p;d++){var y=i.getActiveAttrib(o,d);y&&(f[y.name]=i.getAttribLocation(o,y.name))}for(var v=i.getProgramParameter(o,i.ACTIVE_UNIFORMS),_=0;_<v;_++){var x=i.getActiveUniform(o,_);x&&(f[x.name]=i.getUniformLocation(o,x.name))}return f},v.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var i=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=this.createProgram(t,e)),this.cache[i]},v.prototype.useProgram=function(t,e){var i=this.gl,n=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.currentProgram!==n&&(i.useProgram(n.program),this.currentProgram=n),n},e.exports=v},{"../data/buffer":62,"../data/extent":65,"../data/pos_array":68,"../data/program_configuration":69,"../data/raster_bounds_array":70,"../shaders":92,"../source/pixels_to_tile_units":99,"../source/source_cache":104,"../util/browser":198,"../util/util":219,"./draw_background":77,"./draw_circle":78,"./draw_debug":80,"./draw_fill":81,"./draw_fill_extrusion":82,"./draw_line":83,"./draw_raster":84,"./draw_symbol":85,"./frame_history":86,"./vertex_array_object":90,"@mapbox/gl-matrix":1,assert:6}],89:[function(t,e,i){"use strict";var n=t("assert"),o=t("../source/pixels_to_tile_units");i.isPatternMissing=function(t,e){if(!t)return!1;var i=e.spriteAtlas.getPattern(t.from),n=e.spriteAtlas.getPattern(t.to);return!i||!n},i.prepare=function(t,e,i){var o=e.gl,r=e.spriteAtlas.getPattern(t.from),a=e.spriteAtlas.getPattern(t.to);n(r&&a),o.uniform1i(i.u_image,0),o.uniform2fv(i.u_pattern_tl_a,r.tl),o.uniform2fv(i.u_pattern_br_a,r.br),o.uniform2fv(i.u_pattern_tl_b,a.tl),o.uniform2fv(i.u_pattern_br_b,a.br),o.uniform2fv(i.u_texsize,e.spriteAtlas.getPixelSize()),o.uniform1f(i.u_mix,t.t),o.uniform2fv(i.u_pattern_size_a,r.displaySize),o.uniform2fv(i.u_pattern_size_b,a.displaySize),o.uniform1f(i.u_scale_a,t.fromScale),o.uniform1f(i.u_scale_b,t.toScale),o.activeTexture(o.TEXTURE0),e.spriteAtlas.bind(o,!0)},i.setTile=function(t,e,i){var n=e.gl;n.uniform1f(i.u_tile_units_to_pixels,1/o(t,1,e.transform.tileZoom));var r=Math.pow(2,t.coord.z),a=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,s=a*(t.coord.x+t.coord.w*r),l=a*t.coord.y;n.uniform2f(i.u_pixel_coord_upper,s>>16,l>>16),n.uniform2f(i.u_pixel_coord_lower,65535&s,65535&l)}},{"../source/pixels_to_tile_units":99,assert:6}],90:[function(t,e,i){"use strict";var n=t("assert"),o=function(){this.boundProgram=null,this.boundVertexBuffer=null,this.boundVertexBuffer2=null,this.boundElementBuffer=null,this.boundVertexOffset=null,this.vao=null};o.prototype.bind=function(t,e,i,n,o,r,a){void 0===t.extVertexArrayObject&&(t.extVertexArrayObject=t.getExtension("OES_vertex_array_object"));var s=!this.vao||this.boundProgram!==e||this.boundVertexBuffer!==i||this.boundVertexBuffer2!==o||this.boundElementBuffer!==n||this.boundVertexOffset!==r||this.boundDynamicVertexBuffer!==a;!t.extVertexArrayObject||s?(this.freshBind(t,e,i,n,o,r,a),this.gl=t):(t.extVertexArrayObject.bindVertexArrayOES(this.vao),a&&a.bind(t))},o.prototype.freshBind=function(t,e,i,o,r,a,s){var l,u=e.numAttributes;if(t.extVertexArrayObject)this.vao&&this.destroy(),this.vao=t.extVertexArrayObject.createVertexArrayOES(),t.extVertexArrayObject.bindVertexArrayOES(this.vao),l=0,this.boundProgram=e,this.boundVertexBuffer=i,this.boundVertexBuffer2=r,this.boundElementBuffer=o,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=s;else{l=t.currentNumAttributes||0;for(var c=u;c<l;c++)n(0!==c),t.disableVertexAttribArray(c)}i.enableAttributes(t,e),r&&r.enableAttributes(t,e),s&&s.enableAttributes(t,e),i.bind(t),i.setVertexAttribPointers(t,e,a),r&&(r.bind(t),r.setVertexAttribPointers(t,e,a)),s&&(s.bind(t),s.setVertexAttribPointers(t,e,a)),o&&o.bind(t),t.currentNumAttributes=u},o.prototype.destroy=function(){this.vao&&(this.gl.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},e.exports=o},{assert:6}],91:[function(t,e,i){"use strict";var n=t("../util/util");i.packUint8ToFloat=function(t,e){return t=n.clamp(Math.floor(t),0,255),e=n.clamp(Math.floor(e),0,255),256*t+e}},{"../util/util":219}],92:[function(t,e,i){"use strict";e.exports={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},collisionBox:{fragmentSource:"uniform float u_zoom;\n// u_maxzoom is derived from the maximum scale considered by the CollisionTile\n// Labels with placement zoom greater than this value will not be placed,\n// regardless of perspective effects.\nuniform float u_maxzoom;\nuniform sampler2D u_fadetexture;\n\n// v_max_zoom is a collision-box-specific value that controls when line-following\n// collision boxes are used.\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Green = no collisions, label is showing\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\n\n    // Red = collision, label hidden\n    if (texture2D(u_fadetexture, v_fade_tex).a < 1.0) {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n    }\n\n    // Faded black = this collision box is not used at this zoom (for curved labels)\n    if (u_zoom >= v_max_zoom + v_perspective_zoom_adjust) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\n    }\n\n    // Faded blue = the placement scale for this label is beyond the CollisionTile\n    // max scale, so it's impossible for this label to show without collision detection\n    // being run again (the label's glyphs haven't even been added to the symbol bucket)\n    if (v_placement_zoom >= u_maxzoom) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\n    }\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_scale;\nuniform float u_pitch;\nuniform float u_collision_y_stretch;\nuniform float u_camera_to_center_distance;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = 1.0 + 0.5 * ((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    gl_Position = u_matrix * vec4(a_pos + a_extrude * collision_perspective_ratio * collision_adjustment / u_scale, 0.0, 1.0);\n\n    v_max_zoom = a_data.x;\n    v_placement_zoom = a_data.y;\n\n    v_perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((v_placement_zoom + v_perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float ed = a_edgedistance; // use each attrib in order to not trip a VAO assert\n    float t = mod(a_normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(a_normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(a_normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = a_normal.x == 1.0 && a_normal.y == 0.0 && a_normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(a_edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(a_normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset; \n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset; \n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n \n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_collision_y_stretch;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    // See comments in symbol_sdf.vertex\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    vec2 fade_tex = v_data0.zw;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    lowp float fade_alpha = texture2D(u_fadetexture, fade_tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist) * fade_alpha;\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_collision_y_stretch;\n\nuniform vec2 u_texsize;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    // incidence_stretch is the ratio of how much y space a label takes up on a tile while drawn perpendicular to the viewport vs\n    //  how much space it would take up if it were drawn flat on the tile\n    // Using law of sines, camera_to_anchor/sin(ground_angle) = camera_to_center/sin(incidence_angle)\n    // sin(incidence_angle) = 1/incidence_stretch\n    // Incidence angle 90 -> head on, sin(incidence_angle) = 1, no incidence stretch\n    // Incidence angle 1 -> very oblique, sin(incidence_angle) =~ 0, lots of incidence stretch\n    // ground_angle = u_pitch + PI/2 -> sin(ground_angle) = cos(u_pitch)\n    // This 2D calculation is only exactly correct when gl_Position.x is in the center of the viewport,\n    //  but it's a close enough approximation for our purposes\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    // incidence_stretch only applies to the y-axis, but without re-calculating the collision tile, we can't\n    // adjust the size of only one axis. So, we do a crude approximation at placement time to get the aspect ratio\n    // about right, and then do the rest of the adjustment here: there will be some extra padding on the x-axis,\n    // but hopefully not too much.\n    // Never make the adjustment less than 1.0: instead of allowing collisions on the x-axis, be conservative on\n    // the y-axis.\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    // Floor to 1/10th zoom to dodge precision issues that can cause partially hidden labels\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    vec2 fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n\n    v_data0 = vec4(tex.x, tex.y, fade_tex.x, fade_tex.y);\n    v_data1 = vec2(gamma_scale, size);\n}\n"}};var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;for(var o in e.exports)!function(t){var i=e.exports[t],o={};i.fragmentSource=i.fragmentSource.replace(n,function(t,e,i,n,r){return o[r]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nvarying "+i+" "+n+" "+r+";\n#else\nuniform "+i+" "+n+" u_"+r+";\n#endif\n":"initialize"===e?"\n#ifdef HAS_UNIFORM_u_"+r+"\n    "+i+" "+n+" "+r+" = u_"+r+";\n#endif\n":void 0}),i.vertexSource=i.vertexSource.replace(n,function(t,e,i,n,r){var a="float"===n?"vec2":"vec4";if(o[r]){if("define"===e)return"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float a_"+r+"_t;\nattribute "+i+" "+a+" a_"+r+";\nvarying "+i+" "+n+" "+r+";\n#else\nuniform "+i+" "+n+" u_"+r+";\n#endif\n";if("initialize"===e)return"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = unpack_mix_"+a+"(a_"+r+", a_"+r+"_t);\n#else\n    "+i+" "+n+" "+r+" = u_"+r+";\n#endif\n"}else{if("define"===e)return"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float a_"+r+"_t;\nattribute "+i+" "+a+" a_"+r+";\n#else\nuniform "+i+" "+n+" u_"+r+";\n#endif\n";if("initialize"===e)return"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+i+" "+n+" "+r+" = unpack_mix_"+a+"(a_"+r+", a_"+r+"_t);\n#else\n    "+i+" "+n+" "+r+" = u_"+r+";\n#endif\n"}})}(o)},{}],93:[function(t,e,i){"use strict";var n=t("./image_source"),o=t("../util/window"),r=function(t){function e(e,i,n,o){t.call(this,e,i,n,o),this.options=i,this.animate=void 0===i.animate||i.animate}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){if(this.canvas=this.canvas||o.document.getElementById(this.options.canvas),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions())return this.fire("error",new Error("Canvas dimensions cannot be less than or equal to zero."));var t;this.play=function(){t=this.map.style.animationLoop.set(1/0),this.map._rerender()},this.pause=function(){this.map.style.animationLoop.cancel(t)},this._finishLoading()},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.canvas&&this.animate&&this.play())},e.prototype.prepare=function(){var t=!1;this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||0!==Object.keys(this.tiles).length&&this._prepareImage(this.map.painter.gl,this.canvas,t)},e.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}},e.prototype._hasInvalidDimensions=function(){for(var t=this,e=0,i=[t.canvas.width,t.canvas.height];e<i.length;e+=1){var n=i[e];if(isNaN(n)||n<=0)return!0}return!1},e}(n);e.exports=r},{"../util/window":200,"./image_source":97}],94:[function(t,e,i){"use strict";function n(t){var e=a.document.createElement("a");return e.href=t,e.href}var o=t("../util/evented"),r=t("../util/util"),a=t("../util/window"),s=t("../data/extent"),l=function(t){function e(e,i,n,o){t.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this.dispatcher=n,this.setEventedParent(o),this._data=i.data,this._options=r.extend({},i),void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type);var a=s/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:s,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:s,radius:(i.clusterRadius||50)*a,log:!1}},i.workerOptions)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(e){e?t.fire("error",{error:e}):t.fire("data",{dataType:"source",sourceDataType:"metadata"})})},e.prototype.onAdd=function(t){this.load(),this.map=t},e.prototype.setData=function(t){var e=this;return this._data=t,this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(t){if(t)return e.fire("error",{error:t});e.fire("data",{dataType:"source",sourceDataType:"content"})}),this},e.prototype._updateWorkerData=function(t){var e=this,i=r.extend({},this.workerOptions),o=this._data;"string"==typeof o?i.url=n(o):i.data=JSON.stringify(o),this.workerID=this.dispatcher.send(this.type+".loadData",i,function(i){e._loaded=!0,t(i)},this.workerID)},e.prototype.loadTile=function(t,e){var i=this,n=t.workerID&&"expired"!==t.state?"reloadTile":"loadTile",o={type:this.type,uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(t),showCollisionBoxes:this.map.showCollisionBoxes};t.workerID=this.dispatcher.send(n,o,function(n,o){if(t.unloadVectorData(),!t.aborted)return n?e(n):(t.loadVectorData(o,i.map.painter),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(i)),e(null))},this.workerID)},e.prototype.abortTile=function(t){t.aborted=!0},e.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},function(){},t.workerID)},e.prototype.onRemove=function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id},function(){})},e.prototype.serialize=function(){return r.extend({},this._options,{type:this.type,data:this._data})},e}(o);e.exports=l},{"../data/extent":65,"../util/evented":206,"../util/util":219,"../util/window":200}],95:[function(t,e,i){"use strict";function n(t,e){var i=t.source,n=t.coord;if(!this._geoJSONIndexes[i])return e(null,null);var o=this._geoJSONIndexes[i].getTile(Math.min(n.z,t.maxZoom),n.x,n.y);if(!o)return e(null,null);var r=new a(o.features),l=s(r);0===l.byteOffset&&l.byteLength===l.buffer.byteLength||(l=new Uint8Array(l)),e(null,{vectorTile:r,rawData:l.buffer})}var o=t("../util/ajax"),r=t("geojson-rewind"),a=t("./geojson_wrapper"),s=t("vt-pbf"),l=t("supercluster"),u=t("geojson-vt"),c=function(t){function e(e,i,o){t.call(this,e,i,n),o&&(this.loadGeoJSON=o),this._geoJSONIndexes={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadData=function(t,e){var i=this;this.loadGeoJSON(t,function(n,o){if(n||!o)return e(n);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));r(o,!0);try{i._geoJSONIndexes[t.source]=t.cluster?l(t.superclusterOptions).load(o.features):u(o,t.geojsonVtOptions)}catch(n){return e(n)}i.loaded[t.source]={},e(null)})},e.prototype.reloadTile=function(e,i){var n=this.loaded[e.source],o=e.uid;return n&&n[o]?t.prototype.reloadTile.call(this,e,i):this.loadTile(e,i)},e.prototype.loadGeoJSON=function(t,e){if(t.url)o.getJSON(t.url,e);else{if("string"!=typeof t.data)return e(new Error("Input data is not a valid GeoJSON object."));try{return e(null,JSON.parse(t.data))}catch(t){return e(new Error("Input data is not a valid GeoJSON object."))}}},e.prototype.removeSource=function(t){this._geoJSONIndexes[t.source]&&delete this._geoJSONIndexes[t.source]},e}(t("./vector_tile_worker_source"));e.exports=c},{"../util/ajax":197,"./geojson_wrapper":96,"./vector_tile_worker_source":109,"geojson-rewind":11,"geojson-vt":15,supercluster:40,"vt-pbf":49}],96:[function(t,e,i){"use strict";var n=t("point-geometry"),o=t("vector-tile").VectorTileFeature.prototype.toGeoJSON,r=t("../data/extent"),a=function(t){var e=this;if(this.type=t.type,1===t.type){this.rawGeometry=[];for(var i=0;i<t.geometry.length;i++)e.rawGeometry.push([t.geometry[i]])}else this.rawGeometry=t.geometry;this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10)),this.extent=r};a.prototype.loadGeometry=function(){var t=this,e=this.rawGeometry;this.geometry=[];for(var i=0;i<e.length;i++){for(var o=e[i],r=[],a=0;a<o.length;a++)r.push(new n(o[a][0],o[a][1]));t.geometry.push(r)}return this.geometry},a.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,n=1/0,o=-1/0,r=0;r<t.length;r++)for(var a=t[r],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),o=Math.max(o,l.y)}return[e,n,i,o]},a.prototype.toGeoJSON=function(){return o.apply(this,arguments)};var s=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r,this.length=t.length,this._features=t};s.prototype.feature=function(t){return new a(this._features[t])},e.exports=s},{"../data/extent":65,"point-geometry":37,"vector-tile":45}],97:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../util/window"),r=t("./tile_coord"),a=t("../geo/lng_lat"),s=t("point-geometry"),l=t("../util/evented"),u=t("../util/ajax"),c=t("../data/extent"),h=t("../data/raster_bounds_array"),p=t("../data/buffer"),f=t("../render/vertex_array_object"),d=function(t){function e(e,i,n,o){t.call(this),this.id=e,this.dispatcher=n,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(o),this.options=i,this.textureLoaded=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),this.url=this.options.url,u.getImage(this.options.url,function(e,i){e?t.fire("error",{error:e}):i&&(t.image=i,t._finishLoading())})},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",sourceDataType:"metadata"}))},e.prototype.onAdd=function(t){this.load(),this.map=t,this.image&&this.setCoordinates(this.coordinates)},e.prototype.setCoordinates=function(t){this.coordinates=t;var e=this.map,i=t.map(function(t){return e.transform.locationCoordinate(a.convert(t)).zoomTo(0)}),o=this.centerCoord=n.getCoordinatesCenter(i);return o.column=Math.floor(o.column),o.row=Math.floor(o.row),this.coord=new r(o.zoom,o.column,o.row),this.minzoom=this.maxzoom=o.zoom,this._tileCoords=i.map(function(t){var e=t.zoomTo(o.zoom);return new s(Math.round((e.column-o.column)*c),Math.round((e.row-o.row)*c))}),this.fire("data",{dataType:"source",sourceDataType:"content"}),this},e.prototype._setTile=function(t){this.tiles[String(t.coord.w)]=t;var e=new h;e.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0),e.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,32767,0),e.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,32767),e.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,32767,32767),t.buckets={},t.boundsBuffer=p.fromStructArray(e,p.BufferType.VERTEX),t.boundsVAO=new f},e.prototype.prepare=function(){0===Object.keys(this.tiles).length!==0&&this.image&&this._prepareImage(this.map.painter.gl,this.image)},e.prototype._prepareImage=function(t,e,i){var n=this;this.textureLoaded?i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e):(e instanceof o.HTMLVideoElement||e instanceof o.ImageData||e instanceof o.HTMLCanvasElement)&&(t.bindTexture(t.TEXTURE_2D,this.texture),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,e)):(this.textureLoaded=!0,this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e));for(var r in n.tiles){var a=n.tiles[r];"loaded"!==a.state&&(a.state="loaded",a.texture=n.texture)}},e.prototype.loadTile=function(t,e){this.coord&&this.coord.toString()===t.coord.toString()?(this._setTile(t),e(null)):(t.state="errored",e(null))},e.prototype.serialize=function(){return{type:"image",urls:this.url,coordinates:this.coordinates}},e}(l);e.exports=d},{"../data/buffer":62,"../data/extent":65,"../data/raster_bounds_array":70,"../geo/lng_lat":73,"../render/vertex_array_object":90,"../util/ajax":197,"../util/evented":206,"../util/util":219,"../util/window":200,"./tile_coord":107,"point-geometry":37}],98:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../util/ajax"),r=t("../util/browser"),a=t("../util/mapbox").normalizeSourceURL;e.exports=function(t,e){var i=function(t,i){if(t)return e(t);var o=n.pick(i,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);i.vector_layers&&(o.vectorLayers=i.vector_layers,o.vectorLayerIds=o.vectorLayers.map(function(t){return t.id})),e(null,o)};t.url?o.getJSON(a(t.url),i):r.frame(i.bind(null,null,t))}},{"../util/ajax":197,"../util/browser":198,"../util/mapbox":213,"../util/util":219}],99:[function(t,e,i){"use strict";var n=t("../data/extent");e.exports=function(t,e,i){return e*(n/(t.tileSize*Math.pow(2,i-t.coord.z)))}},{"../data/extent":65}],100:[function(t,e,i){"use strict";function n(t,e){var i=t.coord,n=e.coord;return i.z-n.z||i.y-n.y||i.w-n.w||i.x-n.x}function o(t){for(var e={},i={},n=0,o=t;n<o.length;n+=1){var r=o[n],a=r.queryResults,s=r.wrappedTileID,l=i[s]=i[s]||{};for(var u in a)for(var c=a[u],h=l[u]=l[u]||{},p=e[u]=e[u]||[],f=0,d=c;f<d.length;f+=1){var m=d[f];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m.feature))}}return e}var r=t("./tile_coord");i.rendered=function(t,e,i,r,a,s){var l=t.tilesIn(i);l.sort(n);for(var u=[],c=0;c<l.length;c++){var h=l[c];h.tile.featureIndex&&u.push({wrappedTileID:h.coord.wrapped().id,queryResults:h.tile.featureIndex.query({queryGeometry:h.queryGeometry,scale:h.scale,tileSize:h.tile.tileSize,bearing:s,params:r},e)})}return o(u)},i.source=function(t,e){for(var i=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),n=[],o={},a=0;a<i.length;a++){var s=i[a],l=new r(Math.min(s.sourceMaxZoom,s.coord.z),s.coord.x,s.coord.y,0).id;o[l]||(o[l]=!0,s.querySourceFeatures(n,e))}return n}},{"./tile_coord":107}],101:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../util/ajax"),r=t("../util/evented"),a=t("./load_tilejson"),s=t("../util/mapbox").normalizeTileURL,l=t("./tile_bounds"),u=function(t){function e(e,i,o,r){t.call(this),this.id=e,this.dispatcher=o,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=n.extend({},i),n.extend(this,n.pick(i,["url","scheme","tileSize"]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),a(this._options,function(e,i){e?t.fire("error",e):i&&(n.extend(t,i),t.setBounds(i.bounds),t.fire("data",{dataType:"source",sourceDataType:"metadata"}),t.fire("data",{dataType:"source",sourceDataType:"content"}))})},e.prototype.onAdd=function(t){this.load(),this.map=t},e.prototype.setBounds=function(t){this.bounds=t,t&&(this.tileBounds=new l(t,this.minzoom,this.maxzoom))},e.prototype.serialize=function(){return n.extend({},this._options)},e.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t,this.maxzoom)},e.prototype.loadTile=function(t,e){var i=this,n=s(t.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);t.request=o.getImage(n,function(n,o){if(delete t.request,t.aborted)i.state="unloaded",e(null);else if(n)i.state="errored",e(n);else if(o){i.map._refreshExpiredTiles&&t.setExpiryData(o),delete o.cacheControl,delete o.expires;var r=i.map.painter.gl;t.texture=i.map.painter.getTileTexture(o.width),t.texture?(r.bindTexture(r.TEXTURE_2D,t.texture),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,o)):(t.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,t.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.map.painter.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.map.painter.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.map.painter.extTextureFilterAnisotropicMax),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,o),t.texture.size=o.width),r.generateMipmap(r.TEXTURE_2D),t.state="loaded",e(null)}})},e.prototype.abortTile=function(t){t.request&&(t.request.abort(),delete t.request)},e.prototype.unloadTile=function(t){t.texture&&this.map.painter.saveTileTexture(t.texture)},e}(r);e.exports=u},{"../util/ajax":197,"../util/evented":206,"../util/mapbox":213,"../util/util":219,"./load_tilejson":98,"./tile_bounds":106}],102:[function(t,e,i){"use strict";var n=t("../util/ajax"),o=t("../util/evented"),r=t("../util/window"),a=!1,s=null;e.exports.evented=new o,e.exports.registerForPluginAvailability=function(t){return s?t({pluginBlobURL:s,errorCallback:e.exports.errorCallback}):e.exports.evented.once("pluginAvailable",t),t},e.exports.createBlobURL=function(t){return r.URL.createObjectURL(new r.Blob([t.data]),{type:"text/javascript"})},e.exports.clearRTLTextPlugin=function(){a=!1,s=null},e.exports.setRTLTextPlugin=function(t,i){if(a)throw new Error("setRTLTextPlugin cannot be called multiple times.");a=!0,e.exports.errorCallback=i,n.getArrayBuffer(t,function(t,n){t?i(t):n&&(s=e.exports.createBlobURL(n),e.exports.evented.fire("pluginAvailable",{pluginBlobURL:s,errorCallback:i}))})},e.exports.applyArabicShaping=null,e.exports.processBidirectionalText=null},{"../util/ajax":197,"../util/evented":206,"../util/window":200}],103:[function(t,e,i){"use strict";var n=t("../util/util"),o={vector:t("../source/vector_tile_source"),raster:t("../source/raster_tile_source"),geojson:t("../source/geojson_source"),video:t("../source/video_source"),image:t("../source/image_source"),canvas:t("../source/canvas_source")};i.create=function(t,e,i,r){var a=new o[e.type](t,e,i,r);if(a.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+a.id);return n.bindAll(["load","abort","unload","serialize","prepare"],a),a},i.getType=function(t){return o[t]},i.setType=function(t,e){o[t]=e}},{"../source/canvas_source":93,"../source/geojson_source":94,"../source/image_source":97,"../source/raster_tile_source":101,"../source/vector_tile_source":108,"../source/video_source":110,"../util/util":219}],104:[function(t,e,i){"use strict";function n(t,e,i){var n=i.zoomTo(Math.min(t.z,e));return{x:(n.column-(t.x+t.w*Math.pow(2,t.z)))*f,y:(n.row-t.y)*f}}function o(t,e){return t%32-e%32}function r(t){return"raster"===t||"image"===t||"video"===t}var a=t("./source"),s=t("./tile"),l=t("../util/evented"),u=t("./tile_coord"),c=t("../util/lru_cache"),h=t("../geo/coordinate"),p=t("../util/util"),f=t("../data/extent"),d=function(t){function e(e,i,n){t.call(this),this.id=e,this.dispatcher=n,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("error",function(){this._sourceErrored=!0}),this._source=a.create(e,i,n,this),this._tiles={},this._cache=new c(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},e.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},e.prototype.loaded=function(){var t=this;if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var e in t._tiles){var i=t._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0},e.prototype.getSource=function(){return this._source},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},e.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},e.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t)},e.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t)},e.prototype.serialize=function(){return this._source.serialize()},e.prototype.prepare=function(){if(this._sourceLoaded&&this._source.prepare)return this._source.prepare()},e.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(o)},e.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},e.prototype._isIdRenderable=function(t){return this._tiles[t].hasData()&&!this._coveredTiles[t]},e.prototype.reload=function(){var t=this;if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(var e in t._tiles)t._reloadTile(e,"reloading")}},e.prototype._reloadTile=function(t,e){var i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))},e.prototype._tileLoaded=function(t,e,i,n){if(n)return t.state="errored",void(404!==n.status&&this._source.fire("error",{tile:t,error:n}));t.sourceCache=this,t.timeAdded=(new Date).getTime(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),this._source.fire("data",{dataType:"source",tile:t,coord:t.coord}),this.map&&(this.map.painter.tileExtentVAO.vao=null)},e.prototype.getTile=function(t){return this.getTileByID(t.id)},e.prototype.getTileByID=function(t){return this._tiles[t]},e.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},e.prototype._findLoadedChildren=function(t,e,i){var n=this,o=!1;for(var r in n._tiles){var a=n._tiles[r];if(!(i[r]||!a.hasData()||a.coord.z<=t.z||a.coord.z>e)){var s=Math.pow(2,Math.min(a.coord.z,n._source.maxzoom)-Math.min(t.z,n._source.maxzoom));if(Math.floor(a.coord.x/s)===t.x&&Math.floor(a.coord.y/s)===t.y)for(i[r]=!0,o=!0;a&&a.coord.z-1>t.z;){var l=a.coord.parent(n._source.maxzoom).id;(a=n._tiles[l])&&a.hasData()&&(delete i[r],i[l]=!0)}}}return o},e.prototype.findLoadedParent=function(t,e,i){for(var n=this,o=t.z-1;o>=e;o--){t=t.parent(n._source.maxzoom);var r=n._tiles[t.id];if(r&&r.hasData())return i[t.id]=!0,r;if(n._cache.has(t.id))return i[t.id]=!0,n._cache.getWithoutRemoving(t.id)}},e.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/t.tileSize)+1)*(Math.ceil(t.height/t.tileSize)+1),i=Math.floor(5*e),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(n)},e.prototype.update=function(t){var i=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var n,o,a,s;this.updateCacheSize(t);var l=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(t)),c=Math.max(l-e.maxOverzooming,this._source.minzoom),h=Math.max(l+e.maxUnderzooming,this._source.minzoom),f={};this._coveredTiles={};var d;for(this.used?this._source.coord?d=t.getVisibleWrappedCoordinates(this._source.coord):(d=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(t){return i._source.hasTile(t)}))):d=[],n=0;n<d.length;n++)o=d[n],a=i._addTile(o),f[o.id]=!0,a.hasData()||i._findLoadedChildren(o,h,f)||(s=i.findLoadedParent(o,c,f))&&i._addTile(s.coord);var m={};if(r(this._source.type))for(var g=Object.keys(f),y=0;y<g.length;y++){var v=g[y];o=u.fromID(v),(a=i._tiles[v])&&((void 0===a.fadeEndTime||a.fadeEndTime>=Date.now())&&(i._findLoadedChildren(o,h,f)&&(f[v]=!0),(s=i.findLoadedParent(o,c,m))&&i._addTile(s.coord)))}var _;for(_ in m)f[_]||(i._coveredTiles[_]=!0);for(_ in m)f[_]=!0;var x=p.keysDifference(this._tiles,f);for(n=0;n<x.length;n++)i._removeTile(+x[n])}},e.prototype._addTile=function(t){var e=this._tiles[t.id];if(e)return e;(e=this._cache.get(t.id))&&(e.redoPlacement(this._source),this._cacheTimers[t.id]&&(clearTimeout(this._cacheTimers[t.id]),this._cacheTimers[t.id]=void 0,this._setTileReloadTimer(t.id,e)));var i=Boolean(e);if(!i){var n=t.z,o=n>this._source.maxzoom?Math.pow(2,n-this._source.maxzoom):1;e=new s(t,this._source.tileSize*o,this._source.maxzoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.id,e.state))}return e.uses++,this._tiles[t.id]=e,i||this._source.fire("dataloading",{tile:e,coord:e.coord,dataType:"source"}),e},e.prototype._setTileReloadTimer=function(t,e){var i=this,n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(function(){i._reloadTile(t,"expired"),i._timers[t]=void 0},n))},e.prototype._setCacheInvalidationTimer=function(t,e){var i=this,n=e.getExpiryTimeout();n&&(this._cacheTimers[t]=setTimeout(function(){i._cache.remove(t),i._cacheTimers[t]=void 0},n))},e.prototype._removeTile=function(t){var e=this._tiles[t];if(e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),this._timers[t]=void 0),!(e.uses>0)))if(e.stopPlacementThrottler(),e.hasData()){var i=e.coord.wrapped().id;this._cache.add(i,e),this._setCacheInvalidationTimer(i,e)}else e.aborted=!0,this._abortTile(e),this._unloadTile(e)},e.prototype.clearTiles=function(){var t=this;this._shouldReloadOnResume=!1,this._paused=!1;for(var e in t._tiles)t._removeTile(e);this._cache.reset()},e.prototype.tilesIn=function(t){for(var e=this,i=[],o=this.getIds(),r=1/0,a=1/0,s=-1/0,l=-1/0,c=t[0].zoom,p=0;p<t.length;p++){var d=t[p];r=Math.min(r,d.column),a=Math.min(a,d.row),s=Math.max(s,d.column),l=Math.max(l,d.row)}for(var m=0;m<o.length;m++){var g=e._tiles[o[m]],y=u.fromID(o[m]),v=[n(y,g.sourceMaxZoom,new h(r,a,c)),n(y,g.sourceMaxZoom,new h(s,l,c))];if(v[0].x<f&&v[0].y<f&&v[1].x>=0&&v[1].y>=0){for(var _=[],x=0;x<t.length;x++)_.push(n(y,g.sourceMaxZoom,t[x]));i.push({tile:g,coord:y,queryGeometry:[_],scale:Math.pow(2,e.transform.zoom-g.coord.z)})}}return i},e.prototype.redoPlacement=function(){for(var t=this,e=this.getIds(),i=0;i<e.length;i++)t.getTileByID(e[i]).redoPlacement(t._source)},e.prototype.getVisibleCoordinates=function(){for(var t=this,e=this.getRenderableIds().map(u.fromID),i=0,n=e;i<n.length;i+=1){var o=n[i];o.posMatrix=t.transform.calculatePosMatrix(o,t._source.maxzoom)}return e},e}(l);d.maxOverzooming=10,d.maxUnderzooming=3,e.exports=d},{"../data/extent":65,"../geo/coordinate":72,"../util/evented":206,"../util/lru_cache":212,"../util/util":219,"./source":103,"./tile":105,"./tile_coord":107}],105:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../data/bucket"),r=t("../data/feature_index"),a=t("vector-tile"),s=t("pbf"),l=t("../util/vectortile_to_geojson"),u=t("../style-spec/feature_filter"),c=t("../symbol/collision_tile"),h=t("../symbol/collision_box"),p=t("../util/throttler"),f=function(t,e,i){this.coord=t,this.uid=n.uniqueId(),this.uses=0,this.tileSize=e,this.sourceMaxZoom=i,this.buckets={},this.expirationTime=null,this.expiredRequestCount=0,this.state="loading",this.placementThrottler=new p(300,this._immediateRedoPlacement.bind(this))};f.prototype.registerFadeDuration=function(t,e){var i=e+this.timeAdded;i<Date.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i,t.set(this.fadeEndTime-Date.now()))},f.prototype.loadVectorData=function(t,e){this.hasData()&&this.unloadVectorData(),this.state="loaded",t&&(t.rawTileData&&(this.rawTileData=t.rawTileData),this.collisionBoxArray=new h(t.collisionBoxArray),this.collisionTile=c.deserialize(t.collisionTile,this.collisionBoxArray),this.featureIndex=r.deserialize(t.featureIndex,this.rawTileData,this.collisionTile),this.buckets=o.deserialize(t.buckets,e.style))},f.prototype.reloadSymbolData=function(t,e){var i=this;if("unloaded"!==this.state){this.collisionTile=c.deserialize(t.collisionTile,this.collisionBoxArray),this.featureIndex&&this.featureIndex.setCollisionTile(this.collisionTile);for(var r in i.buckets){var a=i.buckets[r];"symbol"===a.layers[0].type&&(a.destroy(),delete i.buckets[r])}n.extend(this.buckets,o.deserialize(t.buckets,e))}},f.prototype.unloadVectorData=function(){var t=this;for(var e in t.buckets)t.buckets[e].destroy();this.buckets={},this.collisionBoxArray=null,this.collisionTile=null,this.featureIndex=null,this.state="unloaded"},f.prototype.redoPlacement=function(t){if("vector"===t.type||"geojson"===t.type)if("loaded"===this.state){if(this.collisionTile){var e=t.map.transform.cameraToTileDistance(this);if(this.angle===t.map.transform.angle&&this.pitch===t.map.transform.pitch&&this.cameraToCenterDistance===t.map.transform.cameraToCenterDistance&&this.showCollisionBoxes===t.map.showCollisionBoxes){if(this.cameraToTileDistance===e)return;if(this.pitch<25)return void(this.cameraToTileDistance=e)}this.angle=t.map.transform.angle,this.pitch=t.map.transform.pitch,this.cameraToCenterDistance=t.map.transform.cameraToCenterDistance,this.cameraToTileDistance=e,this.showCollisionBoxes=t.map.showCollisionBoxes,this.placementSource=t,this.state="reloading",this.placementThrottler.invoke()}}else this.redoWhenDone=!0},f.prototype._immediateRedoPlacement=function(){var t=this;this.placementSource.dispatcher.send("redoPlacement",{type:this.placementSource.type,uid:this.uid,source:this.placementSource.id,angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,showCollisionBoxes:this.showCollisionBoxes},function(e,i){t.state="loaded",t.reloadSymbolData(i,t.placementSource.map.style),t.placementSource.fire("data",{tile:t,coord:t.coord,dataType:"source"}),t.placementSource.map&&(t.placementSource.map.painter.tileExtentVAO.vao=null),t.redoWhenDone&&(t.redoWhenDone=!1,t._immediateRedoPlacement())},this.workerID)},f.prototype.getBucket=function(t){return this.buckets[t.id]},f.prototype.querySourceFeatures=function(t,e){var i=this;if(this.rawTileData){this.vtLayers||(this.vtLayers=new a.VectorTile(new s(this.rawTileData)).layers);var n=e?e.sourceLayer:"",o=this.vtLayers._geojsonTileLayer||this.vtLayers[n];if(o)for(var r=u(e&&e.filter),c={z:this.coord.z,x:this.coord.x,y:this.coord.y},h=0;h<o.length;h++){var p=o.feature(h);if(r(p)){var f=new l(p,i.coord.z,i.coord.x,i.coord.y);f.tile=c,t.push(f)}}}},f.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},f.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=n.parseCacheControl(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var o=Date.now(),r=!1;if(this.expirationTime>o)r=!1;else if(e)if(this.expirationTime<e)r=!0;else{var a=this.expirationTime-e;a?this.expirationTime=o+Math.max(a,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},f.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},f.prototype.stopPlacementThrottler=function(){this.placementThrottler.stop(),"reloading"===this.state&&(this.state="loaded")},e.exports=f},{"../data/bucket":56,"../data/feature_index":66,"../style-spec/feature_filter":116,"../symbol/collision_box":164,"../symbol/collision_tile":166,"../util/throttler":217,"../util/util":219,"../util/vectortile_to_geojson":220,pbf:36,"vector-tile":45}],106:[function(t,e,i){"use strict";var n=t("../geo/lng_lat_bounds"),o=t("../util/util").clamp,r=function(t,e,i){this.bounds=n.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24};r.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},r.prototype.contains=function(t,e){var i=e?Math.min(t.z,e):t.z,n={minX:Math.floor(this.lngX(this.bounds.getWest(),i)),minY:Math.floor(this.latY(this.bounds.getNorth(),i)),maxX:Math.ceil(this.lngX(this.bounds.getEast(),i)),maxY:Math.ceil(this.latY(this.bounds.getSouth(),i))};return t.x>=n.minX&&t.x<n.maxX&&t.y>=n.minY&&t.y<n.maxY},r.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},r.prototype.latY=function(t,e){var i=o(Math.sin(Math.PI/180*t),-.9999,.9999),n=Math.pow(2,e)/(2*Math.PI);return Math.pow(2,e-1)+.5*Math.log((1+i)/(1-i))*-n},e.exports=r},{"../geo/lng_lat_bounds":74,"../util/util":219}],107:[function(t,e,i){"use strict";function n(t,e){if(t.row>e.row){var i=t;t=e,e=i}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function o(t,e,i,n,o){var r=Math.max(i,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,h=e.dx<0,p=r;p<a;p++){var f=l*Math.max(0,Math.min(t.dy,p+c-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;o(Math.floor(d),Math.ceil(f),p)}}function r(t,e,i,r,a,s){var l,u=n(t,e),c=n(e,i),h=n(i,t);u.dy>c.dy&&(l=u,u=c,c=l),u.dy>h.dy&&(l=u,u=h,h=l),c.dy>h.dy&&(l=c,c=h,h=l),u.dy&&o(h,u,r,a,s),c.dy&&o(h,c,r,a,s)}function a(t,e,i){for(var n,o="",r=t;r>0;r--)o+=(e&(n=1<<r-1)?1:0)+(i&n?2:0);return o}var s=t("assert"),l=t("@mapbox/whoots-js"),u=t("../geo/coordinate"),c=function(t,e,i,n){s(!isNaN(t)&&t>=0&&t%1==0),s(!isNaN(e)&&e>=0&&e%1==0),s(!isNaN(i)&&i>=0&&i%1==0),(void 0===n||isNaN(n))&&(n=0),this.z=+t,this.x=+e,this.y=+i,this.w=+n,(n*=2)<0&&(n=-1*n-1);var o=1<<this.z;this.id=32*(o*o*n+o*this.y+this.x)+this.z,this.posMatrix=null};c.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},c.prototype.toCoordinate=function(t){var e=Math.min(this.z,void 0===t?this.z:t),i=Math.pow(2,e),n=this.y,o=this.x+i*this.w;return new u(o,n,e)},c.prototype.url=function(t,e,i){var n=l.getTileBBox(this.x,this.y,this.z),o=a(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(Math.min(this.z,e||this.z))).replace("{x}",String(this.x)).replace("{y}",String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",o).replace("{bbox-epsg-3857}",n)},c.prototype.parent=function(t){return 0===this.z?null:this.z>t?new c(this.z-1,this.x,this.y,this.w):new c(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},c.prototype.wrapped=function(){return new c(this.z,this.x,this.y,0)},c.prototype.children=function(t){if(this.z>=t)return[new c(this.z+1,this.x,this.y,this.w)];var e=this.z+1,i=2*this.x,n=2*this.y;return[new c(e,i,n,this.w),new c(e,i+1,n,this.w),new c(e,i,n+1,this.w),new c(e,i+1,n+1,this.w)]},c.cover=function(t,e,i,n){function o(t,e,o){var r,l,u,h;if(o>=0&&o<=a)for(r=t;r<e;r++)l=Math.floor(r/a),u=(r%a+a)%a,0!==l&&!0!==n||(h=new c(i,u,o,l),s[h.id]=h)}void 0===n&&(n=!0);var a=1<<t,s={};return r(e[0],e[1],e[2],0,a,o),r(e[2],e[3],e[0],0,a,o),Object.keys(s).map(function(t){return s[t]})},c.fromID=function(t){var e=t%32,i=1<<e,n=(t-e)/32,o=n%i,r=(n-o)/i%i,a=Math.floor(n/(i*i));return a%2!=0&&(a=-1*a-1),a/=2,new c(e,o,r,a)},e.exports=c},{"../geo/coordinate":72,"@mapbox/whoots-js":5,assert:6}],108:[function(t,e,i){"use strict";var n=t("../util/evented"),o=t("../util/util"),r=t("./load_tilejson"),a=t("../util/mapbox").normalizeTileURL,s=t("./tile_bounds"),l=function(t){function e(e,i,n,r){if(t.call(this),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,o.extend(this,o.pick(i,["url","scheme","tileSize"])),this._options=o.extend({type:"vector"},i),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),r(this._options,function(e,i){e?t.fire("error",e):i&&(o.extend(t,i),t.setBounds(i.bounds),t.fire("data",{dataType:"source",sourceDataType:"metadata"}),t.fire("data",{dataType:"source",sourceDataType:"content"}))})},e.prototype.setBounds=function(t){this.bounds=t,t&&(this.tileBounds=new s(t,this.minzoom,this.maxzoom))},e.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t,this.maxzoom)},e.prototype.onAdd=function(t){this.load(),this.map=t},e.prototype.serialize=function(){return o.extend({},this._options)},e.prototype.loadTile=function(t,e){function i(i,n){if(!t.aborted){if(i)return e(i);this.map._refreshExpiredTiles&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(this)),e(null),t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)}}var n=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,o={url:a(t.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),uid:t.uid,coord:t.coord,zoom:t.coord.z,tileSize:this.tileSize*n,type:this.type,source:this.id,overscaling:n,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(t),showCollisionBoxes:this.map.showCollisionBoxes};t.workerID&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:this.dispatcher.send("reloadTile",o,i.bind(this),t.workerID):t.workerID=this.dispatcher.send("loadTile",o,i.bind(this))},e.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},e.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},e}(n);e.exports=l},{"../util/evented":206,"../util/mapbox":213,"../util/util":219,"./load_tilejson":98,"./tile_bounds":106}],109:[function(t,e,i){"use strict";function n(t,e){var i=o.getArrayBuffer(t.url,function(t,i){t?e(t):i&&e(null,{vectorTile:new r.VectorTile(new a(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires})});return function(){i.abort()}}var o=t("../util/ajax"),r=t("vector-tile"),a=t("pbf"),s=t("./worker_tile"),l=t("../util/util"),u=function(t,e,i){this.actor=t,this.layerIndex=e,this.loadVectorData=i||n,this.loading={},this.loaded={}};u.prototype.loadTile=function(t,e){var i=this,n=t.source,o=t.uid;this.loading[n]||(this.loading[n]={});var r=this.loading[n][o]=new s(t);r.abort=this.loadVectorData(t,function(t,a){if(delete i.loading[n][o],t||!a)return e(t);var s=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl),r.vectorTile=a.vectorTile,r.parse(a.vectorTile,i.layerIndex,i.actor,function(t,i,n){if(t||!i)return e(t);e(null,l.extend({rawTileData:s},i,u),n)}),i.loaded[n]=i.loaded[n]||{},i.loaded[n][o]=r})},u.prototype.reloadTile=function(t,e){var i=this.loaded[t.source],n=t.uid,o=this;if(i&&i[n]){var r=i[n];"parsing"===r.status?r.reloadCallback=e:"done"===r.status&&r.parse(r.vectorTile,this.layerIndex,this.actor,function(t,i){if(this.reloadCallback){var n=this.reloadCallback;delete this.reloadCallback,this.parse(this.vectorTile,o.layerIndex,o.actor,n)}e(t,i)}.bind(r))}},u.prototype.abortTile=function(t){var e=this.loading[t.source],i=t.uid;e&&e[i]&&e[i].abort&&(e[i].abort(),delete e[i])},u.prototype.removeTile=function(t){var e=this.loaded[t.source],i=t.uid;e&&e[i]&&delete e[i]},u.prototype.redoPlacement=function(t,e){var i=this.loaded[t.source],n=this.loading[t.source],o=t.uid;if(i&&i[o]){var r=i[o].redoPlacement(t.angle,t.pitch,t.cameraToCenterDistance,t.cameraToTileDistance,t.showCollisionBoxes);r.result&&e(null,r.result,r.transferables)}else n&&n[o]&&(n[o].angle=t.angle)},e.exports=u},{"../util/ajax":197,"../util/util":219,"./worker_tile":112,pbf:36,"vector-tile":45}],110:[function(t,e,i){"use strict";var n=t("../util/ajax"),o=function(t){function e(e,i,n,o){t.call(this,e,i,n,o),this.roundZoom=!0,this.type="video",this.options=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this,e=this.options;this.urls=e.urls,n.getVideo(e.urls,function(e,i){if(e)t.fire("error",{error:e});else if(i){t.video=i,t.video.loop=!0;var n;t.video.addEventListener("playing",function(){n=t.map.style.animationLoop.set(1/0),t.map._rerender()}),t.video.addEventListener("pause",function(){t.map.style.animationLoop.cancel(n)}),t.map&&t.video.play(),t._finishLoading()}})},e.prototype.getVideo=function(){return this.video},e.prototype.onAdd=function(t){this.map||(this.load(),this.map=t,this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},e.prototype.prepare=function(){0===Object.keys(this.tiles).length||this.video.readyState<2||this._prepareImage(this.map.painter.gl,this.video)},e.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},e}(t("./image_source"));e.exports=o},{"../util/ajax":197,"./image_source":97}],111:[function(t,e,i){"use strict";var n=t("../util/actor"),o=t("../style/style_layer_index"),r=t("./vector_tile_worker_source"),a=t("./geojson_worker_source"),s=t("assert"),l=t("./rtl_text_plugin"),u=function(t){var e=this;this.self=t,this.actor=new n(t,this),this.layerIndexes={},this.workerSourceTypes={vector:r,geojson:a},this.workerSources={},this.self.registerWorkerSource=function(t,i){if(e.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');e.workerSourceTypes[t]=i},this.self.registerRTLTextPlugin=function(t){if(l.applyArabicShaping||l.processBidirectionalText)throw new Error("RTL text plugin already registered.");l.applyArabicShaping=t.applyArabicShaping,l.processBidirectionalText=t.processBidirectionalText}};u.prototype.setLayers=function(t,e){this.getLayerIndex(t).replace(e)},u.prototype.updateLayers=function(t,e){this.getLayerIndex(t).update(e.layers,e.removedIds,e.symbolOrder)},u.prototype.loadTile=function(t,e,i){s(e.type),this.getWorkerSource(t,e.type).loadTile(e,i)},u.prototype.reloadTile=function(t,e,i){s(e.type),this.getWorkerSource(t,e.type).reloadTile(e,i)},u.prototype.abortTile=function(t,e){s(e.type),this.getWorkerSource(t,e.type).abortTile(e)},u.prototype.removeTile=function(t,e){s(e.type),this.getWorkerSource(t,e.type).removeTile(e)},u.prototype.removeSource=function(t,e){s(e.type);var i=this.getWorkerSource(t,e.type);void 0!==i.removeSource&&i.removeSource(e)},u.prototype.redoPlacement=function(t,e,i){s(e.type),this.getWorkerSource(t,e.type).redoPlacement(e,i)},u.prototype.loadWorkerSource=function(t,e,i){try{this.self.importScripts(e.url),i()}catch(t){i(t)}},u.prototype.loadRTLTextPlugin=function(t,e,i){try{l.applyArabicShaping||l.processBidirectionalText||(this.self.importScripts(e),l.applyArabicShaping&&l.processBidirectionalText||i(new Error("RTL Text Plugin failed to import scripts from "+e)))}catch(t){i(t)}},u.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new o),e},u.prototype.getWorkerSource=function(t,e){var i=this;if(this.workerSources[t]||(this.workerSources[t]={}),!this.workerSources[t][e]){var n={send:function(e,n,o,r){i.actor.send(e,n,o,r,t)}};this.workerSources[t][e]=new this.workerSourceTypes[e](n,this.getLayerIndex(t))}return this.workerSources[t][e]},e.exports=function(t){return new u(t)}},{"../style/style_layer_index":158,"../util/actor":196,"./geojson_worker_source":95,"./rtl_text_plugin":102,"./vector_tile_worker_source":109,assert:6}],112:[function(t,e,i){"use strict";function n(t,e){for(var i=0,n=t.layers;i<n.length;i+=1)n[i].recalculate(e)}function o(t,e){return t.filter(function(t){return!t.isEmpty()}).map(function(t){return t.serialize(e)})}var r=t("../data/feature_index"),a=t("../symbol/collision_tile"),s=t("../symbol/collision_box"),l=t("../util/dictionary_coder"),u=t("../util/util"),c=t("assert"),h=function(t){this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.cameraToCenterDistance=t.cameraToCenterDistance,this.cameraToTileDistance=t.cameraToTileDistance,this.showCollisionBoxes=t.showCollisionBoxes};h.prototype.parse=function(t,e,i,h){var p=this;this.status="parsing",this.data=t,this.collisionBoxArray=new s;var f=new l(Object.keys(t.layers).sort()),d=new r(this.coord,this.overscaling);d.bucketLayerIDs=[];var m={},g={featureIndex:d,iconDependencies:{},glyphDependencies:{}},y=e.familiesBySource[this.source];for(var v in y){var _=t.layers[v];if(_){1===_.version&&u.warnOnce('Vector tile source "'+p.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var x=f.encode(v),b=[],w=0;w<_.length;w++){var T=_.feature(w);b.push({feature:T,index:w,sourceLayerIndex:x})}for(var E=0,C=y[v];E<C.length;E+=1){var S=C[E],A=S[0];if(c(A.source===p.source),!(A.minzoom&&p.zoom<A.minzoom||A.maxzoom&&p.zoom>=A.maxzoom||A.layout&&"none"===A.layout.visibility)){for(var k=0,I=S;k<I.length;k+=1)I[k].recalculate(p.zoom);(m[A.id]=A.createBucket({index:d.bucketLayerIDs.length,layers:S,zoom:p.zoom,overscaling:p.overscaling,collisionBoxArray:p.collisionBoxArray})).populate(b,g),d.bucketLayerIDs.push(S.map(function(t){return t.id}))}}}}var L=function(t){p.status="done",d.paintPropertyStatistics={};for(var e in m)u.extend(d.paintPropertyStatistics,m[e].getPaintPropertyStatistics());var i=[];h(null,{buckets:o(u.values(m),i),featureIndex:d.serialize(i),collisionTile:t.serialize(i),collisionBoxArray:p.collisionBoxArray.serialize()},i)};this.symbolBuckets=[];for(var D=e.symbolOrder.length-1;D>=0;D--){var P=m[e.symbolOrder[D]];P&&p.symbolBuckets.push(P)}if(0===this.symbolBuckets.length)return L(new a(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray));var z=0,M=Object.keys(g.iconDependencies),O=u.mapObject(g.glyphDependencies,function(t){return Object.keys(t).map(Number)}),R=function(t){if(t)return h(t);if(2==++z){for(var e=new a(p.angle,p.pitch,p.cameraToCenterDistance,p.cameraToTileDistance,p.collisionBoxArray),i=0,o=p.symbolBuckets;i<o.length;i+=1){var r=o[i];n(r,p.zoom),r.prepare(O,M),r.place(e,p.showCollisionBoxes)}L(e)}};Object.keys(O).length?i.send("getGlyphs",{uid:this.uid,stacks:O},function(t,e){O=e,R(t)}):R(),M.length?i.send("getIcons",{icons:M},function(t,e){M=e,R(t)}):R()},h.prototype.redoPlacement=function(t,e,i,r,s){var l=this;if(this.angle=t,this.pitch=e,this.cameraToCenterDistance=i,this.cameraToTileDistance=r,"done"!==this.status)return{};for(var u=new a(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray),c=0,h=l.symbolBuckets;c<h.length;c+=1){var p=h[c];n(p,l.zoom),p.place(u,s)}var f=[];return{result:{buckets:o(this.symbolBuckets,f),collisionTile:u.serialize(f)},transferables:f}},e.exports=h},{"../data/feature_index":66,"../symbol/collision_box":164,"../symbol/collision_tile":166,"../util/dictionary_coder":203,"../util/util":219,assert:6}],113:[function(t,e,i){"use strict";function n(t,e){var i={};for(var n in t)"ref"!==n&&(i[n]=t[n]);return o.forEach(function(t){t in e&&(i[t]=e[t])}),i}var o=t("./util/ref_properties");e.exports=function(t){t=t.slice();for(var e=Object.create(null),i=0;i<t.length;i++)e[t[i].id]=t[i];for(var o=0;o<t.length;o++)"ref"in t[o]&&(t[o]=n(t[o],e[t[o].ref]));return t}},{"./util/ref_properties":126}],114:[function(t,e,i){"use strict";function n(t,e,i,n){t=t||{},e=e||{};var o;for(o in t)t.hasOwnProperty(o)&&(e.hasOwnProperty(o)||(i.push({command:u.removeSource,args:[o]}),n[o]=!0));for(o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)?l(t[o],e[o])||(i.push({command:u.removeSource,args:[o]}),i.push({command:u.addSource,args:[o,e[o]]}),n[o]=!0):i.push({command:u.addSource,args:[o,e[o]]}))}function o(t,e,i,n,o,r){t=t||{},e=e||{};var a;for(a in t)t.hasOwnProperty(a)&&(l(t[a],e[a])||i.push({command:r,args:[n,a,e[a],o]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(l(t[a],e[a])||i.push({command:r,args:[n,a,e[a],o]}))}function r(t){return t.id}function a(t,e){return t[e.id]=e,t}function s(t,e,i){t=t||[],e=e||[];var n,s,c,h,p,f,d,m=t.map(r),g=e.map(r),y=t.reduce(a,{}),v=e.reduce(a,{}),_=m.slice(),x=Object.create(null);for(n=0,s=0;n<m.length;n++)c=m[n],v.hasOwnProperty(c)?s++:(i.push({command:u.removeLayer,args:[c]}),_.splice(_.indexOf(c,s),1));for(n=0,s=0;n<g.length;n++)c=g[g.length-1-n],_[_.length-1-n]!==c&&(y.hasOwnProperty(c)?(i.push({command:u.removeLayer,args:[c]}),_.splice(_.lastIndexOf(c,_.length-s),1)):s++,f=_[_.length-n],i.push({command:u.addLayer,args:[v[c],f]}),_.splice(_.length-n,0,c),x[c]=!0);for(n=0;n<g.length;n++)if(c=g[n],h=y[c],p=v[c],!x[c]&&!l(h,p))if(l(h.source,p.source)&&l(h["source-layer"],p["source-layer"])&&l(h.type,p.type)){o(h.layout,p.layout,i,c,null,u.setLayoutProperty),o(h.paint,p.paint,i,c,null,u.setPaintProperty),l(h.filter,p.filter)||i.push({command:u.setFilter,args:[c,p.filter]}),l(h.minzoom,p.minzoom)&&l(h.maxzoom,p.maxzoom)||i.push({command:u.setLayerZoomRange,args:[c,p.minzoom,p.maxzoom]});for(d in h)h.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?o(h[d],p[d],i,c,d.slice(6),u.setPaintProperty):l(h[d],p[d])||i.push({command:u.setLayerProperty,args:[c,d,p[d]]}));for(d in p)p.hasOwnProperty(d)&&!h.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?o(h[d],p[d],i,c,d.slice(6),u.setPaintProperty):l(h[d],p[d])||i.push({command:u.setLayerProperty,args:[c,d,p[d]]}))}else i.push({command:u.removeLayer,args:[c]}),f=_[_.lastIndexOf(c)+1],i.push({command:u.addLayer,args:[p,f]})}var l=t("lodash.isequal"),u={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};e.exports=function(t,e){if(!t)return[{command:u.setStyle,args:[e]}];var i=[];try{if(!l(t.version,e.version))return[{command:u.setStyle,args:[e]}];l(t.center,e.center)||i.push({command:u.setCenter,args:[e.center]}),l(t.zoom,e.zoom)||i.push({command:u.setZoom,args:[e.zoom]}),l(t.bearing,e.bearing)||i.push({command:u.setBearing,args:[e.bearing]}),l(t.pitch,e.pitch)||i.push({command:u.setPitch,args:[e.pitch]}),l(t.sprite,e.sprite)||i.push({command:u.setSprite,args:[e.sprite]}),l(t.glyphs,e.glyphs)||i.push({command:u.setGlyphs,args:[e.glyphs]}),l(t.transition,e.transition)||i.push({command:u.setTransition,args:[e.transition]}),l(t.light,e.light)||i.push({command:u.setLight,args:[e.light]});var o={},r=[];n(t.sources,e.sources,r,o);var a=[];t.layers&&t.layers.forEach(function(t){o[t.source]?i.push({command:u.removeLayer,args:[t.id]}):a.push(t)}),i=i.concat(r),s(a,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:u.setStyle,args:[e]}]}return i},e.exports.operations=u},{"lodash.isequal":31}],115:[function(t,e,i){"use strict";var n=t("util").format;e.exports=function(t,e){for(var i=[],o=arguments.length-2;o-- >0;)i[o]=arguments[o+2];this.message=(t?t+": ":"")+n.apply(n,i),null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)}},{util:44}],116:[function(t,e,i){"use strict";function n(t){if(!t)return"true";var e=t[0];return t.length<=1?"any"===e?"false":"true":"("+("=="===e?r(t[1],t[2],"===",!1):"!="===e?r(t[1],t[2],"!==",!1):"<"===e||">"===e||"<="===e||">="===e?r(t[1],t[2],e,!0):"any"===e?a(t.slice(1),"||"):"all"===e?a(t.slice(1),"&&"):"none"===e?u(a(t.slice(1),"||")):"in"===e?s(t[1],t.slice(2)):"!in"===e?u(s(t[1],t.slice(2))):"has"===e?l(t[1]):"!has"===e?u(l(t[1])):"true")+")"}function o(t){return"$type"===t?"f.type":"$id"===t?"f.id":"p["+JSON.stringify(t)+"]"}function r(t,e,i,n){var r=o(t),a="$type"===t?h.indexOf(e):JSON.stringify(e);return(n?"typeof "+r+"=== typeof "+a+"&&":"")+r+i+a}function a(t,e){return t.map(n).join(e)}function s(t,e){"$type"===t&&(e=e.map(function(t){return h.indexOf(t)}));var i=JSON.stringify(e.sort(c)),n=o(t);return e.length<=200?i+".indexOf("+n+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+n+", "+i+",0,"+(e.length-1)+")"}function l(t){return"$id"===t?'"id" in f':JSON.stringify(t)+" in p"}function u(t){return"!("+t+")"}function c(t,e){return t<e?-1:t>e?1:0}e.exports=function(t){return new Function("f","var p = (f && f.properties || {}); return "+n(t))};var h=["Unknown","Point","LineString","Polygon"]},{}],117:[function(t,e,i){"use strict";function n(t){return t>m?Math.pow(t,1/3):t/d+p}function o(t){return t>f?t*t*t:d*(t-p)}function r(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function a(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function s(t){var e=a(t[0]),i=a(t[1]),o=a(t[2]),r=n((.4124564*e+.3575761*i+.1804375*o)/u),s=n((.2126729*e+.7151522*i+.072175*o)/c);return[116*s-16,500*(r-s),200*(s-n((.0193339*e+.119192*i+.9503041*o)/h)),t[3]]}function l(t){var e=(t[0]+16)/116,i=isNaN(t[1])?e:e+t[1]/500,n=isNaN(t[2])?e:e-t[2]/200;return e=c*o(e),i=u*o(i),n=h*o(n),[r(3.2404542*i-1.5371385*e-.4985314*n),r(-.969266*i+1.8760108*e+.041556*n),r(.0556434*i-.2040259*e+1.0572252*n),t[3]]}var u=.95047,c=1,h=1.08883,p=4/29,f=6/29,d=3*f*f,m=f*f*f,g=Math.PI/180,y=180/Math.PI;e.exports={lab:{forward:s,reverse:l},hcl:{forward:function(t){var e=s(t),i=e[0],n=e[1],o=e[2],r=Math.atan2(o,n)*y;return[r<0?r+360:r,Math.sqrt(n*n+o*o),i,t[3]]},reverse:function(t){var e=t[0]*g,i=t[1];return l([t[2],Math.cos(e)*i,Math.sin(e)*i,t[3]])}}}},{}],118:[function(t,e,i){"use strict";function n(t){return t}function o(t,e){var i,c="color"===e.type;if(h(t)){var p=t.stops&&"object"==typeof t.stops[0][0],g=p||void 0!==t.property,y=p||!g,v=t.type||("interpolated"===e.function?"exponential":"interval");c&&((t=m({},t)).stops&&(t.stops=t.stops.map(function(t){return[t[0],d(t[1])]})),t.default?t.default=d(t.default):t.default=d(e.default));var _,x,b;if("exponential"===v)_=l;else if("interval"===v)_=s;else if("categorical"===v){_=a,x=Object.create(null);for(var w=0,T=t.stops;w<T.length;w+=1){var E=T[w];x[E[0]]=E[1]}b=typeof t.stops[0][0]}else{if("identity"!==v)throw new Error('Unknown function type "'+v+'"');_=u}var C;if(t.colorSpace&&"rgb"!==t.colorSpace){if(!f[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);var S=f[t.colorSpace];t=JSON.parse(JSON.stringify(t));for(var A=0;A<t.stops.length;A++)t.stops[A]=[t.stops[A][0],S.forward(t.stops[A][1])];C=S.reverse}else C=n;if(p){for(var k={},I=[],L=0;L<t.stops.length;L++){var D=t.stops[L],P=D[0].zoom;void 0===k[P]&&(k[P]={zoom:P,type:t.type,property:t.property,default:t.default,stops:[]},I.push(P)),k[P].stops.push([D[0].value,D[1]])}for(var z=[],M=0,O=I;M<O.length;M+=1){var R=O[M];z.push([k[R].zoom,o(k[R],e)])}(i=function(i,n){return C(l({stops:z,base:t.base},e,i)(i,n))}).isFeatureConstant=!1,i.isZoomConstant=!1}else y?((i=function(i){return C(_(t,e,i,x,b))}).isFeatureConstant=!0,i.isZoomConstant=!1):((i=function(i,n){var o=n[t.property];return void 0===o?r(t.default,e.default):C(_(t,e,o,x,b))}).isFeatureConstant=!1,i.isZoomConstant=!0)}else c&&t&&(t=d(t)),(i=function(){return t}).isFeatureConstant=!0,i.isZoomConstant=!0;return i}function r(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function a(t,e,i,n,o){return r(typeof i===o?n[i]:void 0,t.default,e.default)}function s(t,e,i){if("number"!==g(i))return r(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];var o=c(t.stops,i);return t.stops[o][1]}function l(t,e,i){var o=void 0!==t.base?t.base:1;if("number"!==g(i))return r(t.default,e.default);var a=t.stops.length;if(1===a)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[a-1][0])return t.stops[a-1][1];var s=c(t.stops,i),l=p(i,o,t.stops[s][0],t.stops[s+1][0]),u=t.stops[s][1],h=t.stops[s+1][1],f=y[e.type]||n;return"function"==typeof u?function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=u.apply(void 0,t),n=h.apply(void 0,t);if(void 0!==i&&void 0!==n)return f(i,n,l)}:f(u,h,l)}function u(t,e,i){return"color"===e.type?i=d(i):g(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),r(i,t.default,e.default)}function c(t,e){for(var i,n,o=0,r=t.length-1,a=0;o<=r;){if(a=Math.floor((o+r)/2),i=t[a][0],n=t[a+1][0],e===i||e>i&&e<n)return a;i<e?o=a+1:i>e&&(r=a-1)}return Math.max(a-1,0)}function h(t){return"object"==typeof t&&(t.stops||"identity"===t.type)}function p(t,e,i,n){var o=n-i,r=t-i;return 1===e?r/o:(Math.pow(e,r)-1)/(Math.pow(e,o)-1)}var f=t("./color_spaces"),d=t("../util/parse_color"),m=t("../util/extend"),g=t("../util/get_type"),y=t("../util/interpolate");e.exports=o,e.exports.isFunctionDefinition=h,e.exports.interpolationFactor=p,e.exports.findStopLessThanOrEqualTo=c},{"../util/extend":122,"../util/get_type":123,"../util/interpolate":124,"../util/parse_color":125,"./color_spaces":117}],119:[function(t,e,i){"use strict";function n(t){return r(o.map(function(e){return t[e]}))}var o=t("./util/ref_properties"),r=t("fast-stable-stringify");e.exports=function(t){for(var e={},i=0;i<t.length;i++){var o=n(t[i]),r=e[o];r||(r=e[o]=[]),r.push(t[i])}var a=[];for(var s in e)a.push(e[s]);return a}},{"./util/ref_properties":126,"fast-stable-stringify":9}],120:[function(t,e,i){"use strict";e.exports=t("./v8.json")},{"./v8.json":121}],121:[function(t,e,i){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image","source_canvas"],source_tile:{type:{required:!0,type:"enum",values:{vector:{},raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_canvas:{type:{required:!0,type:"enum",values:{canvas:{}}},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}},animate:{type:"boolean",default:"true"},canvas:{type:"string",required:!0}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},"fill-extrusion":{},raster:{},background:{}}},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_fill-extrusion","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_fill-extrusion","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,maximum:65535,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,maximum:65535,units:"meters",transition:!0,requires:["fill-extrusion-height"]}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],122:[function(t,e,i){"use strict";e.exports=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var n=0,o=e;n<o.length;n+=1){var r=o[n];for(var a in r)t[a]=r[a]}return t}},{}],123:[function(t,e,i){"use strict";e.exports=function(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}},{}],124:[function(t,e,i){"use strict";function n(t,e,i){return t*(1-i)+e*i}e.exports=n,n.number=n,n.vec2=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i)]},n.color=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i),n(t[2],e[2],i),n(t[3],e[3],i)]},n.array=function(t,e,i){return t.map(function(t,o){return n(t,e[o],i)})}},{}],125:[function(t,e,i){"use strict";var n=t("csscolorparser").parseCSSColor;e.exports=function(t){if("string"==typeof t){var e=n(t);if(!e)return;return[e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]]}return Array.isArray(t)?t:void 0}},{csscolorparser:7}],126:[function(t,e,i){"use strict";e.exports=["type","source","source-layer","minzoom","maxzoom","filter","layout"]},{}],127:[function(t,e,i){"use strict";e.exports=function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}},{}],128:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type"),r=t("../util/extend");e.exports=function(e){var i=t("./validate_function"),a=t("./validate_object"),s={"*":function(){return[]},array:t("./validate_array"),boolean:t("./validate_boolean"),number:t("./validate_number"),color:t("./validate_color"),constants:t("./validate_constants"),enum:t("./validate_enum"),filter:t("./validate_filter"),function:t("./validate_function"),layer:t("./validate_layer"),object:t("./validate_object"),source:t("./validate_source"),light:t("./validate_light"),string:t("./validate_string")},l=e.value,u=e.valueSpec,c=e.key,h=e.styleSpec,p=e.style;if("string"===o(l)&&"@"===l[0]){if(h.$version>7)return[new n(c,l,"constants have been deprecated as of v8")];if(!(l in p.constants))return[new n(c,l,'constant "%s" not found',l)];e=r({},e,{value:p.constants[l]})}return u.function&&"object"===o(l)?i(e):u.type&&s[u.type]?s[u.type](e):a(r({},e,{valueSpec:u.type?h[u.type]:u}))}},{"../error/validation_error":115,"../util/extend":122,"../util/get_type":123,"./validate_array":129,"./validate_boolean":130,"./validate_color":131,"./validate_constants":132,"./validate_enum":133,"./validate_filter":134,"./validate_function":135,"./validate_layer":137,"./validate_light":139,"./validate_number":140,"./validate_object":141,"./validate_source":144,"./validate_string":145}],129:[function(t,e,i){"use strict";var n=t("../util/get_type"),o=t("./validate"),r=t("../error/validation_error");e.exports=function(t){var e=t.value,i=t.valueSpec,a=t.style,s=t.styleSpec,l=t.key,u=t.arrayElementValidator||o;if("array"!==n(e))return[new r(l,e,"array expected, %s found",n(e))];if(i.length&&e.length!==i.length)return[new r(l,e,"array length %d expected, length %d found",i.length,e.length)];if(i["min-length"]&&e.length<i["min-length"])return[new r(l,e,"array length at least %d expected, length %d found",i["min-length"],e.length)];var c={type:i.value};s.$version<7&&(c.function=i.function),"object"===n(i.value)&&(c=i.value);for(var h=[],p=0;p<e.length;p++)h=h.concat(u({array:e,arrayIndex:p,value:e[p],valueSpec:c,style:a,styleSpec:s,key:l+"["+p+"]"}));return h}},{"../error/validation_error":115,"../util/get_type":123,"./validate":128}],130:[function(t,e,i){"use strict";var n=t("../util/get_type"),o=t("../error/validation_error");e.exports=function(t){var e=t.value,i=t.key,r=n(e);return"boolean"!==r?[new o(i,e,"boolean expected, %s found",r)]:[]}},{"../error/validation_error":115,"../util/get_type":123}],131:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type"),r=t("csscolorparser").parseCSSColor;e.exports=function(t){var e=t.key,i=t.value,a=o(i);return"string"!==a?[new n(e,i,"color expected, %s found",a)]:null===r(i)?[new n(e,i,'color expected, "%s" found',i)]:[]}},{"../error/validation_error":115,"../util/get_type":123,csscolorparser:7}],132:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type");e.exports=function(t){var e=t.key,i=t.value;if(t.styleSpec.$version>7)return i?[new n(e,i,"constants have been deprecated as of v8")]:[];var r=o(i);if("object"!==r)return[new n(e,i,"object expected, %s found",r)];var a=[];for(var s in i)"@"!==s[0]&&a.push(new n(e+"."+s,i[s],'constants must start with "@"'));return a}},{"../error/validation_error":115,"../util/get_type":123}],133:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/unbundle_jsonlint");e.exports=function(t){var e=t.key,i=t.value,r=t.valueSpec,a=[];return Array.isArray(r.values)?-1===r.values.indexOf(o(i))&&a.push(new n(e,i,"expected one of [%s], %s found",r.values.join(", "),i)):-1===Object.keys(r.values).indexOf(o(i))&&a.push(new n(e,i,"expected one of [%s], %s found",Object.keys(r.values).join(", "),i)),a}},{"../error/validation_error":115,"../util/unbundle_jsonlint":127}],134:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("./validate_enum"),r=t("../util/get_type"),a=t("../util/unbundle_jsonlint");e.exports=function t(e){var i,s=e.value,l=e.key,u=e.styleSpec,c=[];if("array"!==r(s))return[new n(l,s,"array expected, %s found",r(s))];if(s.length<1)return[new n(l,s,"filter array must have at least 1 element")];switch(c=c.concat(o({key:l+"[0]",value:s[0],valueSpec:u.filter_operator,style:e.style,styleSpec:e.styleSpec})),a(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===a(s[1])&&c.push(new n(l,s,'"$type" cannot be use with operator "%s"',s[0]));case"==":case"!=":3!==s.length&&c.push(new n(l,s,'filter array for operator "%s" must have 3 elements',s[0]));case"in":case"!in":s.length>=2&&"string"!==(i=r(s[1]))&&c.push(new n(l+"[1]",s[1],"string expected, %s found",i));for(var h=2;h<s.length;h++)i=r(s[h]),"$type"===a(s[1])?c=c.concat(o({key:l+"["+h+"]",value:s[h],valueSpec:u.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&c.push(new n(l+"["+h+"]",s[h],"string, number, or boolean expected, %s found",i));break;case"any":case"all":case"none":for(var p=1;p<s.length;p++)c=c.concat(t({key:l+"["+p+"]",value:s[p],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=r(s[1]),2!==s.length?c.push(new n(l,s,'filter array for "%s" operator must have 2 elements',s[0])):"string"!==i&&c.push(new n(l+"[1]",s[1],"string expected, %s found",i))}return c}},{"../error/validation_error":115,"../util/get_type":123,"../util/unbundle_jsonlint":127,"./validate_enum":133}],135:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type"),r=t("./validate"),a=t("./validate_object"),s=t("./validate_array"),l=t("./validate_number"),u=t("../util/unbundle_jsonlint");e.exports=function(t){function e(t){var e=[],s=t.value,c=t.key;if("array"!==o(s))return[new n(c,s,"array expected, %s found",o(s))];if(2!==s.length)return[new n(c,s,"array length %d expected, length %d found",2,s.length)];if(v){if("object"!==o(s[0]))return[new n(c,s,"object expected, %s found",o(s[0]))];if(void 0===s[0].zoom)return[new n(c,s,"object stop key must have zoom")];if(void 0===s[0].value)return[new n(c,s,"object stop key must have value")];if(p&&p>u(s[0].zoom))return[new n(c,s[0].zoom,"stop zoom values must appear in ascending order")];u(s[0].zoom)!==p&&(p=u(s[0].zoom),h=void 0,m={}),e=e.concat(a({key:c+"[0]",value:s[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:l,value:i}}))}else e=e.concat(i({key:c+"[0]",value:s[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec}));return e.concat(r({key:c+"[1]",value:s[1],valueSpec:f,style:t.style,styleSpec:t.styleSpec}))}function i(t){var e=o(t.value),i=u(t.value);if(c){if(e!==c)return[new n(t.key,t.value,"%s stop domain type must match previous stop domain type %s",e,c)]}else c=e;if("number"!==e&&"string"!==e&&"boolean"!==e)return[new n(t.key,t.value,"stop domain value must be a number, string, or boolean")];if("number"!==e&&"categorical"!==d){var r="number expected, %s found";return f["property-function"]&&void 0===d&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new n(t.key,t.value,r,e)]}return"categorical"!==d||"number"!==e||isFinite(i)&&Math.floor(i)===i?"categorical"!==d&&"number"===e&&void 0!==h&&i<h?[new n(t.key,t.value,"stop domain values must appear in ascending order")]:(h=i,"categorical"===d&&i in m?[new n(t.key,t.value,"stop domain values must be unique")]:(m[i]=!0,[])):[new n(t.key,t.value,"integer expected, found %s",i)]}var c,h,p,f=t.valueSpec,d=u(t.value.type),m={},g="categorical"!==d&&void 0===t.value.property,y=!g,v="array"===o(t.value.stops)&&"array"===o(t.value.stops[0])&&"object"===o(t.value.stops[0][0]),_=a({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===d)return[new n(t.key,t.value,'identity function may not have a "stops" property')];var i=[],r=t.value;return i=i.concat(s({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:e})),"array"===o(r)&&0===r.length&&i.push(new n(t.key,r,"array must have at least one stop")),i},default:function(t){return r({key:t.key,value:t.value,valueSpec:f,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===d&&g&&_.push(new n(t.key,t.value,'missing required property "property"')),"identity"===d||t.value.stops||_.push(new n(t.key,t.value,'missing required property "stops"')),"exponential"===d&&"piecewise-constant"===t.valueSpec.function&&_.push(new n(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(y&&!t.valueSpec["property-function"]?_.push(new n(t.key,t.value,"property functions not supported")):g&&!t.valueSpec["zoom-function"]&&_.push(new n(t.key,t.value,"zoom functions not supported"))),"categorical"!==d&&!v||void 0!==t.value.property||_.push(new n(t.key,t.value,'"property" property is required')),_}},{"../error/validation_error":115,"../util/get_type":123,"../util/unbundle_jsonlint":127,"./validate":128,"./validate_array":129,"./validate_number":140,"./validate_object":141}],136:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("./validate_string");e.exports=function(t){var e=t.value,i=t.key,r=o(t);return r.length?r:(-1===e.indexOf("{fontstack}")&&r.push(new n(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new n(i,e,'"glyphs" url must include a "{range}" token')),r)}},{"../error/validation_error":115,"./validate_string":145}],137:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/unbundle_jsonlint"),r=t("./validate_object"),a=t("./validate_filter"),s=t("./validate_paint_property"),l=t("./validate_layout_property"),u=t("../util/extend");e.exports=function(t){var e=[],i=t.value,c=t.key,h=t.style,p=t.styleSpec;i.type||i.ref||e.push(new n(c,i,'either "type" or "ref" is required'));var f=o(i.type),d=o(i.ref);if(i.id)for(var m=o(i.id),g=0;g<t.arrayIndex;g++){var y=h.layers[g];o(y.id)===m&&e.push(new n(c,i.id,'duplicate layer id "%s", previously used at line %d',i.id,y.id.__line__))}if("ref"in i){["type","source","source-layer","filter","layout"].forEach(function(t){t in i&&e.push(new n(c,i[t],'"%s" is prohibited for ref layers',t))});var v;h.layers.forEach(function(t){o(t.id)===d&&(v=t)}),v?v.ref?e.push(new n(c,i.ref,"ref cannot reference another ref layer")):f=o(v.type):e.push(new n(c,i.ref,'ref layer "%s" not found',d))}else if("background"!==f)if(i.source){var _=h.sources&&h.sources[i.source],x=_&&o(_.type);_?"vector"===x&&"raster"===f?e.push(new n(c,i.source,'layer "%s" requires a raster source',i.id)):"raster"===x&&"raster"!==f?e.push(new n(c,i.source,'layer "%s" requires a vector source',i.id)):"vector"!==x||i["source-layer"]||e.push(new n(c,i,'layer "%s" must specify a "source-layer"',i.id)):e.push(new n(c,i.source,'source "%s" not found',i.source))}else e.push(new n(c,i,'missing required property "source"'));return e=e.concat(r({key:c,value:i,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},filter:a,layout:function(t){return r({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return l(u({layerType:f},t))}}})},paint:function(t){return r({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return s(u({layerType:f},t))}}})}}}))}},{"../error/validation_error":115,"../util/extend":122,"../util/unbundle_jsonlint":127,"./validate_filter":134,"./validate_layout_property":138,"./validate_object":141,"./validate_paint_property":142}],138:[function(t,e,i){"use strict";var n=t("./validate_property");e.exports=function(t){return n(t,"layout")}},{"./validate_property":143}],139:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type"),r=t("./validate");e.exports=function(t){var e=t.value,i=t.styleSpec,a=i.light,s=t.style,l=[],u=o(e);if(void 0===e)return l;if("object"!==u)return l=l.concat([new n("light",e,"object expected, %s found",u)]);for(var c in e){var h=c.match(/^(.*)-transition$/);l=h&&a[h[1]]&&a[h[1]].transition?l.concat(r({key:c,value:e[c],valueSpec:i.transition,style:s,styleSpec:i})):a[c]?l.concat(r({key:c,value:e[c],valueSpec:a[c],style:s,styleSpec:i})):l.concat([new n(c,e[c],'unknown property "%s"',c)])}return l}},{"../error/validation_error":115,"../util/get_type":123,"./validate":128}],140:[function(t,e,i){"use strict";var n=t("../util/get_type"),o=t("../error/validation_error");e.exports=function(t){var e=t.key,i=t.value,r=t.valueSpec,a=n(i);return"number"!==a?[new o(e,i,"number expected, %s found",a)]:"minimum"in r&&i<r.minimum?[new o(e,i,"%s is less than the minimum value %s",i,r.minimum)]:"maximum"in r&&i>r.maximum?[new o(e,i,"%s is greater than the maximum value %s",i,r.maximum)]:[]}},{"../error/validation_error":115,"../util/get_type":123}],141:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/get_type"),r=t("./validate");e.exports=function(t){var e=t.key,i=t.value,a=t.valueSpec||{},s=t.objectElementValidators||{},l=t.style,u=t.styleSpec,c=[],h=o(i);if("object"!==h)return[new n(e,i,"object expected, %s found",h)];for(var p in i){var f=p.split(".")[0],d=a[f]||a["*"],m=void 0;if(s[f])m=s[f];else if(a[f])m=r;else if(s["*"])m=s["*"];else{if(!a["*"]){c.push(new n(e,i[p],'unknown property "%s"',p));continue}m=r}c=c.concat(m({key:(e?e+".":e)+p,value:i[p],valueSpec:d,style:l,styleSpec:u,object:i,objectKey:p}))}for(var g in a)a[g].required&&void 0===a[g].default&&void 0===i[g]&&c.push(new n(e,i,'missing required property "%s"',g));return c}},{"../error/validation_error":115,"../util/get_type":123,"./validate":128}],142:[function(t,e,i){"use strict";var n=t("./validate_property");e.exports=function(t){return n(t,"paint")}},{"./validate_property":143}],143:[function(t,e,i){"use strict";var n=t("./validate"),o=t("../error/validation_error"),r=t("../util/get_type");e.exports=function(t,e){var i=t.key,a=t.style,s=t.styleSpec,l=t.value,u=t.objectKey,c=s[e+"_"+t.layerType];if(!c)return[];var h=u.match(/^(.*)-transition$/);if("paint"===e&&h&&c[h[1]]&&c[h[1]].transition)return n({key:i,value:l,valueSpec:s.transition,style:a,styleSpec:s});var p=t.valueSpec||c[u];if(!p)return[new o(i,l,'unknown property "%s"',u)];var f;if("string"===r(l)&&p["property-function"]&&!p.tokens&&(f=/^{([^}]+)}$/.exec(l)))return[new o(i,l,'"%s" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": %s` }`.',u,JSON.stringify(f[1]))];var d=[];return"symbol"===t.layerType&&"text-field"===u&&a&&!a.glyphs&&d.push(new o(i,l,'use of "text-field" requires a style "glyphs" property')),d.concat(n({key:t.key,value:l,valueSpec:p,style:a,styleSpec:s}))}},{"../error/validation_error":115,"../util/get_type":123,"./validate":128}],144:[function(t,e,i){"use strict";var n=t("../error/validation_error"),o=t("../util/unbundle_jsonlint"),r=t("./validate_object"),a=t("./validate_enum");e.exports=function(t){var e=t.value,i=t.key,s=t.styleSpec,l=t.style;if(!e.type)return[new n(i,e,'"type" is required')];var u=[];switch(o(e.type)){case"vector":case"raster":if(u=u.concat(r({key:i,value:e,valueSpec:s.source_tile,style:t.style,styleSpec:s})),"url"in e)for(var c in e)["type","url","tileSize"].indexOf(c)<0&&u.push(new n(i+"."+c,e[c],'a source with a "url" property may not include a "%s" property',c));return u;case"geojson":return r({key:i,value:e,valueSpec:s.source_geojson,style:l,styleSpec:s});case"video":return r({key:i,value:e,valueSpec:s.source_video,style:l,styleSpec:s});case"image":return r({key:i,value:e,valueSpec:s.source_image,style:l,styleSpec:s});case"canvas":return r({key:i,value:e,valueSpec:s.source_canvas,style:l,styleSpec:s});default:return a({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","geojson","video","image","canvas"]},style:l,styleSpec:s})}}},{"../error/validation_error":115,"../util/unbundle_jsonlint":127,"./validate_enum":133,"./validate_object":141}],145:[function(t,e,i){"use strict";var n=t("../util/get_type"),o=t("../error/validation_error");e.exports=function(t){var e=t.value,i=t.key,r=n(e);return"string"!==r?[new o(i,e,"string expected, %s found",r)]:[]}},{"../error/validation_error":115,"../util/get_type":123}],146:[function(t,e,i){"use strict";function n(t,e){e=e||l;var i=[];return i=i.concat(s({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:u,"*":function(){return[]}}})),e.$version>7&&t.constants&&(i=i.concat(a({key:"constants",value:t.constants,style:t,styleSpec:e}))),o(i)}function o(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function r(t){return function(){return o(t.apply(this,arguments))}}var a=t("./validate/validate_constants"),s=t("./validate/validate"),l=t("./reference/latest"),u=t("./validate/validate_glyphs_url");n.source=r(t("./validate/validate_source")),n.light=r(t("./validate/validate_light")),n.layer=r(t("./validate/validate_layer")),n.filter=r(t("./validate/validate_filter")),n.paintProperty=r(t("./validate/validate_paint_property")),n.layoutProperty=r(t("./validate/validate_layout_property")),e.exports=n},{"./reference/latest":120,"./validate/validate":128,"./validate/validate_constants":132,"./validate/validate_filter":134,"./validate/validate_glyphs_url":136,"./validate/validate_layer":137,"./validate/validate_layout_property":138,"./validate/validate_light":139,"./validate/validate_paint_property":142,"./validate/validate_source":144}],147:[function(t,e,i){"use strict";var n=function(){this.n=0,this.times=[]};n.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},n.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},n.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})},e.exports=n},{}],148:[function(t,e,i){"use strict";var n=t("../util/evented"),o=t("../util/ajax"),r=t("../util/browser"),a=t("../util/mapbox").normalizeSpriteURL,s=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.pixelRatio=1,this.sdf=!1},l=function(t){function e(e,i){var n=this;t.call(this),this.base=e,this.retina=r.devicePixelRatio>1,this.setEventedParent(i);var s=this.retina?"@2x":"";o.getJSON(a(e,s,".json"),function(t,e){t?n.fire("error",{error:t}):e&&(n.data=e,n.imgData&&n.fire("data",{dataType:"style"}))}),o.getImage(a(e,s,".png"),function(t,e){t?n.fire("error",{error:t}):e&&(n.imgData=r.getImageData(e),n.width=e.width,n.data&&n.fire("data",{dataType:"style"}))})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toJSON=function(){return this.base},e.prototype.loaded=function(){return!(!this.data||!this.imgData)},e.prototype.resize=function(){var t=this;if(r.devicePixelRatio>1!==this.retina){var i=new e(this.base);i.on("data",function(){t.data=i.data,t.imgData=i.imgData,t.width=i.width,t.retina=i.retina})}},e.prototype.getSpritePosition=function(t){if(!this.loaded())return new s;var e=this.data&&this.data[t];return e&&this.imgData?e:new s},e}(n);e.exports=l},{"../util/ajax":197,"../util/browser":198,"../util/evented":206,"../util/mapbox":213}],149:[function(t,e,i){"use strict";var n=t("../style-spec/reference/latest"),o=t("../util/util"),r=t("../util/evented"),a=t("./validate_style"),s=t("./style_declaration"),l=t("./style_transition"),u=function(t){function e(e){t.call(this),this.properties=["anchor","color","position","intensity"],this._specifications=n.light,this.set(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){var e=this;if(!this._validate(a.light,t)){this._declarations={},this._transitions={},this._transitionOptions={},this.calculated={},t=o.extend({anchor:this._specifications.anchor.default,color:this._specifications.color.default,position:this._specifications.position.default,intensity:this._specifications.intensity.default},t);for(var i=0,n=e.properties;i<n.length;i+=1){var r=n[i];e._declarations[r]=new s(e._specifications[r],t[r])}return this}},e.prototype.getLight=function(){return{anchor:this.getLightProperty("anchor"),color:this.getLightProperty("color"),position:this.getLightProperty("position"),intensity:this.getLightProperty("intensity")}},e.prototype.getLightProperty=function(t){return o.endsWith(t,"-transition")?this._transitionOptions[t]:this._declarations[t]&&this._declarations[t].value},e.prototype.getLightValue=function(t,e){if("position"===t){var i=this._transitions[t].calculate(e),n=o.sphericalToCartesian(i);return{x:n[0],y:n[1],z:n[2]}}return this._transitions[t].calculate(e)},e.prototype.setLight=function(t){var e=this;if(!this._validate(a.light,t))for(var i in t){var n=t[i];o.endsWith(i,"-transition")?e._transitionOptions[i]=n:null===n||void 0===n?delete e._declarations[i]:e._declarations[i]=new s(e._specifications[i],n)}},e.prototype.recalculate=function(t){var e=this;for(var i in e._declarations)e.calculated[i]=e.getLightValue(i,{zoom:t})},e.prototype._applyLightDeclaration=function(t,e,i,n,r){var a=i.transition?this._transitions[t]:void 0,u=this._specifications[t];if(null!==e&&void 0!==e||(e=new s(u,u.default)),!a||a.declaration.json!==e.json){var c=o.extend({duration:300,delay:0},n,this.getLightProperty(t+"-transition")),h=this._transitions[t]=new l(u,e,a,c);h.instant()||(h.loopID=r.set(h.endTime-Date.now())),a&&r.cancel(a.loopID)}},e.prototype.updateLightTransitions=function(t,e,i){var n,o=this;for(n in o._declarations)o._applyLightDeclaration(n,o._declarations[n],t,e,i)},e.prototype._validate=function(t,e){return a.emitErrors(this,t.call(a,o.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:n})))},e}(r);e.exports=u},{"../style-spec/reference/latest":120,"../util/evented":206,"../util/util":219,"./style_declaration":151,"./style_transition":159,"./validate_style":160}],150:[function(t,e,i){"use strict";var n=t("assert"),o=t("../util/evented"),r=t("./style_layer"),a=t("./image_sprite"),s=t("./light"),l=t("../symbol/glyph_source"),u=t("../symbol/sprite_atlas"),c=t("../render/line_atlas"),h=t("../util/util"),p=t("../util/ajax"),f=t("../util/mapbox"),d=t("../util/browser"),m=t("../util/dispatcher"),g=t("./animation_loop"),y=t("./validate_style"),v=t("../source/source"),_=t("../source/query_features"),x=t("../source/source_cache"),b=t("../style-spec/reference/latest"),w=t("../style-spec/function"),T=t("../util/global_worker_pool"),E=t("../style-spec/deref"),C=t("../style-spec/diff"),S=t("../source/rtl_text_plugin"),A=h.pick(C.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition"]),k=h.pick(C.operations,["setCenter","setZoom","setBearing","setPitch"]),I=function(t){function e(e,i,n){var o=this;t.call(this),this.map=i,this.animationLoop=i&&i.animationLoop||new g,this.dispatcher=new m(T(),this),this.spriteAtlas=new u(1024,1024),this.spriteAtlas.setEventedParent(this),this.lineAtlas=new c(256,512),this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory={},this._loaded=!1,h.bindAll(["_redoPlacement"],this),this._resetUpdates(),n=h.extend({validate:"string"!=typeof e||!f.isMapboxURL(e)},n),this.setEventedParent(i),this.fire("dataloading",{dataType:"style"});var r=this;this._rtlTextPluginCallback=S.registerForPluginAvailability(function(t){r.dispatcher.broadcast("loadRTLTextPlugin",t.pluginBlobURL,t.errorCallback);for(var e in r.sourceCaches)r.sourceCaches[e].reload()});var s=function(t,e){if(t)o.fire("error",{error:t});else if(!n.validate||!y.emitErrors(o,y(e))){o._loaded=!0,o.stylesheet=e,o.updateClasses();for(var i in e.sources)o.addSource(i,e.sources[i],n);e.sprite&&(o.sprite=new a(e.sprite,o)),o.glyphSource=new l(e.glyphs,n.localIdeographFontFamily,o),o._resolve(),o.fire("data",{dataType:"style"}),o.fire("style.load")}};"string"==typeof e?p.getJSON(f.normalizeStyleURL(e),s):d.frame(s.bind(this,null,e)),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=!!o.sourceCaches[t.sourceId]&&o.sourceCaches[t.sourceId].getSource();if(e&&e.vectorLayerIds)for(var i in o._layers){var n=o._layers[i];n.source===e.id&&o._validateLayer(n)}}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(t.sourceLayer&&e){var i=e.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(t.sourceLayer))&&this.fire("error",{error:new Error('Source layer "'+t.sourceLayer+'" does not exist on source "'+i.id+'" as specified by style layer "'+t.id+'"')})}},e.prototype.loaded=function(){var t=this;if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in t.sourceCaches)if(!t.sourceCaches[e].loaded())return!1;return!(this.sprite&&!this.sprite.loaded())},e.prototype._resolve=function(){var t=this,e=E(this.stylesheet.layers);this._order=e.map(function(t){return t.id}),this._layers={};for(var i=0,n=e;i<n.length;i+=1){var o=n[i];(o=r.create(o)).setEventedParent(t,{layer:{id:o.id}}),t._layers[o.id]=o}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new s(this.stylesheet.light)},e.prototype._serializeLayers=function(t){var e=this;return t.map(function(t){return e._layers[t].serialize()})},e.prototype._applyClasses=function(t,e){var i=this;if(this._loaded){t=t||[],e=e||{transition:!0};var n=this.stylesheet.transition||{},o=this._updatedAllPaintProps?this._layers:this._updatedPaintProps;for(var r in o){var a=i._layers[r],s=i._updatedPaintProps[r];if(i._updatedAllPaintProps||s.all)a.updatePaintTransitions(t,e,n,i.animationLoop,i.zoomHistory);else for(var l in s)i._layers[r].updatePaintTransition(l,t,e,n,i.animationLoop,i.zoomHistory)}this.light.updateLightTransitions(e,n,this.animationLoop)}},e.prototype._recalculate=function(t){var e=this;if(this._loaded){for(var i in e.sourceCaches)e.sourceCaches[i].used=!1;this._updateZoomHistory(t);for(var n=0,o=e._order;n<o.length;n+=1){var r=o[n],a=e._layers[r];a.recalculate(t),!a.isHidden(t)&&a.source&&(e.sourceCaches[a.source].used=!0)}this.light.recalculate(t);Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(300),this.z=t}},e.prototype._updateZoomHistory=function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},e.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},e.prototype.update=function(t,e){var i=this;if(this._changed){var o=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(o.length||r.length||this._updatedSymbolOrder)&&this._updateWorkerLayers(o,r);for(var a in i._updatedSources){var s=i._updatedSources[a];n("reload"===s||"clear"===s),"reload"===s?i._reloadSource(a):"clear"===s&&i._clearSource(a)}this._applyClasses(t,e),this._resetUpdates(),this.fire("data",{dataType:"style"})}},e.prototype._updateWorkerLayers=function(t,e){var i=this,n=this._updatedSymbolOrder?this._order.filter(function(t){return"symbol"===i._layers[t].type}):null;this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e,symbolOrder:n})},e.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSymbolOrder=!1,this._updatedSources={},this._updatedPaintProps={},this._updatedAllPaintProps=!1},e.prototype.setState=function(t){var e=this;if(this._checkLoaded(),y.emitErrors(this,y(t)))return!1;(t=h.extend({},t)).layers=E(t.layers);var i=C(this.serialize(),t).filter(function(t){return!(t.command in k)});if(0===i.length)return!1;var n=i.filter(function(t){return!(t.command in A)});if(n.length>0)throw new Error("Unimplemented: "+n.map(function(t){return t.command}).join(", ")+".");return i.forEach(function(t){"setTransition"!==t.command&&e[t.command].apply(e,t.args)}),this.stylesheet=t,!0},e.prototype.addSource=function(t,e,i){var n=this;if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e)+".");if(!(["vector","raster","geojson","video","image","canvas"].indexOf(e.type)>=0)||!this._validate(y.source,"sources."+t,e,null,i)){var o=this.sourceCaches[t]=new x(t,e,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:n.loaded(),source:o.serialize(),sourceId:t}}),o.onAdd(this.map),this._changed=!0}},e.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");var e=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],e.fire("data",{sourceDataType:"metadata",dataType:"source",sourceId:t}),e.setEventedParent(null),e.clearTiles(),e.onRemove&&e.onRemove(this.map),this._changed=!0},e.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},e.prototype.addLayer=function(t,e,i){this._checkLoaded();var n=t.id;if("object"==typeof t.source&&(this.addSource(n,t.source),t=h.extend(t,{source:n})),!this._validate(y.layer,"layers."+n,t,{arrayIndex:-1},i)){var o=r.create(t);this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}});var a=e?this._order.indexOf(e):this._order.length;if(this._order.splice(a,0,n),this._layers[n]=o,this._removedLayers[n]&&o.source){var s=this._removedLayers[n];delete this._removedLayers[n],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),"symbol"===o.type&&(this._updatedSymbolOrder=!0),this.updateClasses(n)}},e.prototype.moveLayer=function(t,e){this._checkLoaded(),this._changed=!0;var i=this._layers[t];if(i){var n=this._order.indexOf(t);this._order.splice(n,1);var o=e?this._order.indexOf(e):this._order.length;this._order.splice(o,0,t),"symbol"===i.type&&(this._updatedSymbolOrder=!0,i.source&&!this._updatedSources[i.source]&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()))}else this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")})},e.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var i=this._order.indexOf(t);this._order.splice(i,1),"symbol"===e.type&&(this._updatedSymbolOrder=!0),this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t]}else this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")})},e.prototype.getLayer=function(t){return this._layers[t]},e.prototype.setLayerZoomRange=function(t,e,i){this._checkLoaded();var n=this.getLayer(t);n?n.minzoom===e&&n.maxzoom===i||(null!=e&&(n.minzoom=e),null!=i&&(n.maxzoom=i),this._updateLayer(n)):this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")})},e.prototype.setFilter=function(t,e){this._checkLoaded();var i=this.getLayer(t);i?null!==e&&void 0!==e&&this._validate(y.filter,"layers."+i.id+".filter",e)||h.deepEqual(i.filter,e)||(i.filter=h.clone(e),this._updateLayer(i)):this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")})},e.prototype.getFilter=function(t){return h.clone(this.getLayer(t).filter)},e.prototype.setLayoutProperty=function(t,e,i){this._checkLoaded();var n=this.getLayer(t);n?h.deepEqual(n.getLayoutProperty(e),i)||(n.setLayoutProperty(e,i),this._updateLayer(n)):this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")})},e.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},e.prototype.setPaintProperty=function(t,e,i,n){this._checkLoaded();var o=this.getLayer(t);if(o){if(!h.deepEqual(o.getPaintProperty(e,n),i)){var r=o.isPaintValueFeatureConstant(e);o.setPaintProperty(e,i,n),!(i&&w.isFunctionDefinition(i)&&"$zoom"!==i.property&&void 0!==i.property)&&r||this._updateLayer(o),this.updateClasses(t,e)}}else this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")})},e.prototype.getPaintProperty=function(t,e,i){return this.getLayer(t).getPaintProperty(e,i)},e.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},e.prototype.updateClasses=function(t,e){if(this._changed=!0,t){var i=this._updatedPaintProps;i[t]||(i[t]={}),i[t][e||"all"]=!0}else this._updatedAllPaintProps=!0},e.prototype.serialize=function(){var t=this;return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._order.map(function(e){return t._layers[e].serialize()})},function(t){return void 0!==t})},e.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},e.prototype._flattenRenderedFeatures=function(t){for(var e=this,i=[],n=this._order.length-1;n>=0;n--)for(var o=e._order[n],r=0,a=t;r<a.length;r+=1){var s=a[r][o];if(s)for(var l=0,u=s;l<u.length;l+=1){var c=u[l];i.push(c)}}return i},e.prototype.queryRenderedFeatures=function(t,e,i,n){var o=this;e&&e.filter&&this._validate(y.filter,"queryRenderedFeatures.filter",e.filter);var r={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire("error",{error:"parameters.layers must be an Array."}),[];for(var a=0,s=e.layers;a<s.length;a+=1){var l=s[a],u=o._layers[l];if(!u)return o.fire("error",{error:"The layer '"+l+"' does not exist in the map's style and cannot be queried for features."}),[];r[u.source]=!0}}var c=[];for(var h in o.sourceCaches)if(!e.layers||r[h]){var p=_.rendered(o.sourceCaches[h],o._layers,t,e,i,n);c.push(p)}return this._flattenRenderedFeatures(c)},e.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(y.filter,"querySourceFeatures.filter",e.filter);var i=this.sourceCaches[t];return i?_.source(i,e):[]},e.prototype.addSourceType=function(t,e,i){return v.getType(t)?i(new Error('A source type called "'+t+'" already exists.')):(v.setType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))},e.prototype.getLight=function(){return this.light.getLight()},e.prototype.setLight=function(t,e){this._checkLoaded();var i=this.light.getLight(),n=!1;for(var o in t)if(!h.deepEqual(t[o],i[o])){n=!0;break}if(n){var r=this.stylesheet.transition||{};this.light.setLight(t),this.light.updateLightTransitions(e||{transition:!0},r,this.animationLoop)}},e.prototype._validate=function(t,e,i,n,o){return(!o||!1!==o.validate)&&y.emitErrors(this,t.call(y,h.extend({key:e,style:this.serialize(),value:i,styleSpec:b},n)))},e.prototype._remove=function(){var t=this;S.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var e in t.sourceCaches)t.sourceCaches[e].clearTiles();this.dispatcher.remove()},e.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},e.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},e.prototype._updateSources=function(t){var e=this;for(var i in e.sourceCaches)e.sourceCaches[i].update(t)},e.prototype._redoPlacement=function(){var t=this;for(var e in t.sourceCaches)t.sourceCaches[e].redoPlacement()},e.prototype.getIcons=function(t,e,i){var n=this,o=function(){n.spriteAtlas.setSprite(n.sprite),n.spriteAtlas.addIcons(e.icons,i)};!this.sprite||this.sprite.loaded()?o():this.sprite.on("data",o)},e.prototype.getGlyphs=function(t,e,i){var n=this,o=e.stacks,r=Object.keys(o).length,a={};for(var s in o)n.glyphSource.getSimpleGlyphs(s,o[s],e.uid,function(t,e,n){t&&console.error(t),a[n]=e,0==--r&&i(null,a)})},e}(o);e.exports=I},{"../render/line_atlas":87,"../source/query_features":100,"../source/rtl_text_plugin":102,"../source/source":103,"../source/source_cache":104,"../style-spec/deref":113,"../style-spec/diff":114,"../style-spec/function":118,"../style-spec/reference/latest":120,"../symbol/glyph_source":169,"../symbol/sprite_atlas":174,"../util/ajax":197,"../util/browser":198,"../util/dispatcher":204,"../util/evented":206,"../util/global_worker_pool":208,"../util/mapbox":213,"../util/util":219,"./animation_loop":147,"./image_sprite":148,"./light":149,"./style_layer":152,"./validate_style":160,assert:6}],151:[function(t,e,i){"use strict";var n=t("../style-spec/function"),o=t("../util/util"),r=function(t,e){var i=this;if(this.value=o.clone(e),this.isFunction=n.isFunctionDefinition(e),this.json=JSON.stringify(this.value),this.minimum=t.minimum,this.function=n(this.value,t),this.isFeatureConstant=this.function.isFeatureConstant,this.isZoomConstant=this.function.isZoomConstant,this.isFeatureConstant||this.isZoomConstant){if(!this.isZoomConstant){this.stopZoomLevels=[];for(var r=0,a=i.value.stops;r<a.length;r+=1){var s=a[r];i.stopZoomLevels.indexOf(s[0])<0&&i.stopZoomLevels.push(s[0])}}}else{this.stopZoomLevels=[];for(var l=[],u=0,c=i.value.stops;u<c.length;u+=1){var h=c[u][0].zoom;i.stopZoomLevels.indexOf(h)<0&&(i.stopZoomLevels.push(h),l.push([h,l.length]))}this._functionInterpolationT=n({type:"exponential",stops:l,base:e.base},{type:"number"})}};r.prototype.calculate=function(t,e){var i=this.function(t&&t.zoom,e||{});return void 0!==this.minimum&&i<this.minimum?this.minimum:i},r.prototype.calculateInterpolationT=function(t){return this.isFeatureConstant||this.isZoomConstant?0:this._functionInterpolationT(t&&t.zoom,{})},e.exports=r},{"../style-spec/function":118,"../util/util":219}],152:[function(t,e,i){"use strict";function n(t){return t.value}var o=t("../util/util"),r=t("./style_transition"),a=t("./style_declaration"),s=t("../style-spec/reference/latest"),l=t("./validate_style"),u=t("./../style-spec/util/parse_color"),c=function(t){function e(e){var i=this;t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this.paint={},this.layout={},this._paintSpecifications=s["paint_"+this.type],this._layoutSpecifications=s["layout_"+this.type],this._paintTransitions={},this._paintTransitionOptions={},this._paintDeclarations={},this._layoutDeclarations={},this._layoutFunctions={};var n,o,r={validate:!1};for(var a in e){var l=a.match(/^paint(?:\.(.*))?$/);if(l){var u=l[1]||"";for(n in e[a])i.setPaintProperty(n,e[a][n],u,r)}}for(o in e.layout)i.setLayoutProperty(o,e.layout[o],r);for(n in i._paintSpecifications)i.paint[n]=i.getPaintValue(n);for(o in i._layoutSpecifications)i._updateLayoutValue(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setLayoutProperty=function(t,e,i){if(null==e)delete this._layoutDeclarations[t];else{var n="layers."+this.id+".layout."+t;if(this._validate(l.layoutProperty,n,t,e,i))return;this._layoutDeclarations[t]=new a(this._layoutSpecifications[t],e)}this._updateLayoutValue(t)},e.prototype.getLayoutProperty=function(t){return this._layoutDeclarations[t]&&this._layoutDeclarations[t].value},e.prototype.getLayoutValue=function(t,e,i){var n=this._layoutSpecifications[t],o=this._layoutDeclarations[t];return o?o.calculate(e,i):n.default},e.prototype.setPaintProperty=function(t,e,i,n){var r="layers."+this.id+(i?'["paint.'+i+'"].':".paint.")+t;if(o.endsWith(t,"-transition"))if(this._paintTransitionOptions[i||""]||(this._paintTransitionOptions[i||""]={}),null===e||void 0===e)delete this._paintTransitionOptions[i||""][t];else{if(this._validate(l.paintProperty,r,t,e,n))return;this._paintTransitionOptions[i||""][t]=e}else if(this._paintDeclarations[i||""]||(this._paintDeclarations[i||""]={}),null===e||void 0===e)delete this._paintDeclarations[i||""][t];else{if(this._validate(l.paintProperty,r,t,e,n))return;this._paintDeclarations[i||""][t]=new a(this._paintSpecifications[t],e)}},e.prototype.getPaintProperty=function(t,e){return e=e||"",o.endsWith(t,"-transition")?this._paintTransitionOptions[e]&&this._paintTransitionOptions[e][t]:this._paintDeclarations[e]&&this._paintDeclarations[e][t]&&this._paintDeclarations[e][t].value},e.prototype.getPaintValue=function(t,e,i){var n=this._paintSpecifications[t],o=this._paintTransitions[t];return o?o.calculate(e,i):"color"===n.type&&n.default?u(n.default):n.default},e.prototype.getPaintValueStopZoomLevels=function(t){var e=this._paintTransitions[t];return e?e.declaration.stopZoomLevels:[]},e.prototype.getLayoutValueStopZoomLevels=function(t){var e=this._layoutDeclarations[t];return e?e.stopZoomLevels:[]},e.prototype.getPaintInterpolationT=function(t,e){return this._paintTransitions[t].declaration.calculateInterpolationT(e)},e.prototype.getLayoutInterpolationT=function(t,e){return this._layoutDeclarations[t].calculateInterpolationT(e)},e.prototype.isPaintValueFeatureConstant=function(t){var e=this._paintTransitions[t];return!e||e.declaration.isFeatureConstant},e.prototype.isLayoutValueFeatureConstant=function(t){var e=this._layoutDeclarations[t];return!e||e.isFeatureConstant},e.prototype.isPaintValueZoomConstant=function(t){var e=this._paintTransitions[t];return!e||e.declaration.isZoomConstant},e.prototype.isLayoutValueZoomConstant=function(t){var e=this._layoutDeclarations[t];return!e||e.isZoomConstant},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||(!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.layout.visibility)},e.prototype.updatePaintTransitions=function(t,e,i,n,r){for(var a=this,s=o.extend({},this._paintDeclarations[""]),l=0;l<t.length;l++)o.extend(s,a._paintDeclarations[t[l]]);var u;for(u in s)a._applyPaintDeclaration(u,s[u],e,i,n,r);for(u in a._paintTransitions)u in s||a._applyPaintDeclaration(u,null,e,i,n,r)},e.prototype.updatePaintTransition=function(t,e,i,n,o,r){for(var a=this,s=this._paintDeclarations[""][t],l=0;l<e.length;l++){var u=a._paintDeclarations[e[l]];u&&u[t]&&(s=u[t])}this._applyPaintDeclaration(t,s,i,n,o,r)},e.prototype.recalculate=function(t){var e=this;for(var i in e._paintTransitions)e.paint[i]=e.getPaintValue(i,{zoom:t});for(var n in e._layoutFunctions)e.layout[n]=e.getLayoutValue(n,{zoom:t})},e.prototype.serialize=function(){var t=this,e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:o.mapObject(this._layoutDeclarations,n)};for(var i in t._paintDeclarations)e[""===i?"paint":"paint."+i]=o.mapObject(t._paintDeclarations[i],n);return o.filterObject(e,function(t,e){return void 0!==t&&!("layout"===e&&!Object.keys(t).length)})},e.prototype._applyPaintDeclaration=function(t,e,i,n,s,l){var u=i.transition?this._paintTransitions[t]:void 0,c=this._paintSpecifications[t];if(null!==e&&void 0!==e||(e=new a(c,c.default)),!u||u.declaration.json!==e.json){var h=o.extend({duration:300,delay:0},n,this.getPaintProperty(t+"-transition")),p=this._paintTransitions[t]=new r(c,e,u,h,l);p.instant()||(p.loopID=s.set(p.endTime-Date.now())),u&&s.cancel(u.loopID)}},e.prototype._updateLayoutValue=function(t){var e=this._layoutDeclarations[t];e&&e.isFunction?this._layoutFunctions[t]=!0:(delete this._layoutFunctions[t],this.layout[t]=this.getLayoutValue(t))},e.prototype._validate=function(t,e,i,n,o){return(!o||!1!==o.validate)&&l.emitErrors(this,t.call(l,{key:e,layerType:this.type,objectKey:i,value:n,styleSpec:s,style:{glyphs:!0,sprite:!0}}))},e}(t("../util/evented"));e.exports=c;var h={circle:t("./style_layer/circle_style_layer"),fill:t("./style_layer/fill_style_layer"),"fill-extrusion":t("./style_layer/fill_extrusion_style_layer"),line:t("./style_layer/line_style_layer"),symbol:t("./style_layer/symbol_style_layer"),background:c,raster:c};c.create=function(t){return new h[t.type](t)}},{"../style-spec/reference/latest":120,"../util/evented":206,"../util/util":219,"./../style-spec/util/parse_color":125,"./style_declaration":151,"./style_layer/circle_style_layer":153,"./style_layer/fill_extrusion_style_layer":154,"./style_layer/fill_style_layer":155,"./style_layer/line_style_layer":156,"./style_layer/symbol_style_layer":157,"./style_transition":159,"./validate_style":160}],153:[function(t,e,i){"use strict";var n=t("../style_layer"),o=t("../../data/bucket/circle_bucket"),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new o(t)},e}(n);e.exports=r},{"../../data/bucket/circle_bucket":57,"../style_layer":152}],154:[function(t,e,i){"use strict";var n=t("../style_layer"),o=t("../../data/bucket/fill_extrusion_bucket"),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPaintValue=function(e,i,n){var o=t.prototype.getPaintValue.call(this,e,i,n);return"fill-extrusion-color"===e&&o&&(o[3]=1),o},e.prototype.createBucket=function(t){return new o(t)},e}(n);e.exports=r},{"../../data/bucket/fill_extrusion_bucket":59,"../style_layer":152}],155:[function(t,e,i){"use strict";var n=t("../style_layer"),o=t("../../data/bucket/fill_bucket"),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPaintValue=function(e,i,n){var o=this;if("fill-outline-color"===e){if(void 0===this.getPaintProperty("fill-outline-color"))return t.prototype.getPaintValue.call(this,"fill-color",i,n);for(var r=this._paintTransitions["fill-outline-color"];r;){if(!(r&&r.declaration&&r.declaration.value))return t.prototype.getPaintValue.call(o,"fill-color",i,n);r=r.oldTransition}}return t.prototype.getPaintValue.call(this,e,i,n)},e.prototype.getPaintValueStopZoomLevels=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):t.prototype.getPaintValueStopZoomLevels.call(this,e)},e.prototype.getPaintInterpolationT=function(e,i){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.getPaintInterpolationT.call(this,"fill-color",i):t.prototype.getPaintInterpolationT.call(this,e,i)},e.prototype.isPaintValueFeatureConstant=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):t.prototype.isPaintValueFeatureConstant.call(this,e)},e.prototype.isPaintValueZoomConstant=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.isPaintValueZoomConstant.call(this,"fill-color"):t.prototype.isPaintValueZoomConstant.call(this,e)},e.prototype.createBucket=function(t){return new o(t)},e}(n);e.exports=r},{"../../data/bucket/fill_bucket":58,"../style_layer":152}],156:[function(t,e,i){"use strict";var n=t("../style_layer"),o=t("../../data/bucket/line_bucket"),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new o(t)},e}(n);e.exports=r},{"../../data/bucket/line_bucket":60,"../style_layer":152}],157:[function(t,e,i){"use strict";var n=t("../style_layer"),o=t("../../data/bucket/symbol_bucket"),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutValue=function(e,i,n){var o=t.prototype.getLayoutValue.call(this,e,i,n);if("auto"!==o)return o;switch(e){case"text-rotation-alignment":case"icon-rotation-alignment":return"line"===this.getLayoutValue("symbol-placement",i,n)?"map":"viewport";case"text-pitch-alignment":return this.getLayoutValue("text-rotation-alignment",i,n);case"icon-pitch-alignment":return this.getLayoutValue("icon-rotation-alignment",i,n);default:return o}},e.prototype.createBucket=function(t){return new o(t)},e}(n);e.exports=r},{"../../data/bucket/symbol_bucket":61,"../style_layer":152}],158:[function(t,e,i){"use strict";var n=t("./style_layer"),o=t("../util/util"),r=t("../style-spec/feature_filter"),a=t("../style-spec/group_by_layout"),s=function(t){t&&this.replace(t)};s.prototype.replace=function(t){var e=this;this.symbolOrder=[];for(var i=0,n=t;i<n.length;i+=1){var o=n[i];"symbol"===o.type&&e.symbolOrder.push(o.id)}this._layerConfigs={},this._layers={},this.update(t,[])},s.prototype.update=function(t,e,i){for(var s=this,l=0,u=t;l<u.length;l+=1){var c=u[l];s._layerConfigs[c.id]=c;var h=s._layers[c.id]=n.create(c);h.updatePaintTransitions({},{transition:!1}),h.filter=r(h.filter)}for(var p=0,f=e;p<f.length;p+=1){var d=f[p];delete s._layerConfigs[d],delete s._layers[d]}i&&(this.symbolOrder=i),this.familiesBySource={};for(var m=0,g=a(o.values(this._layerConfigs));m<g.length;m+=1){var y=g[m].map(function(t){return s._layers[t.id]}),v=y[0];if(!v.layout||"none"!==v.layout.visibility){var _=v.source||"",x=s.familiesBySource[_];x||(x=s.familiesBySource[_]={});var b=v.sourceLayer||"_geojsonTileLayer",w=x[b];w||(w=x[b]=[]),w.push(y)}}},e.exports=s},{"../style-spec/feature_filter":116,"../style-spec/group_by_layout":119,"../util/util":219,"./style_layer":152}],159:[function(t,e,i){"use strict";function n(t,e,i){if(void 0!==t&&void 0!==e)return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:i}}var o=t("../util/util"),r=t("../style-spec/util/interpolate"),a={lastIntegerZoom:0,lastIntegerZoomTime:0,lastZoom:0},s=function(t,e,i,o,s){this.declaration=e,this.startTime=this.endTime=(new Date).getTime(),this.oldTransition=i,this.duration=o.duration||0,this.delay=o.delay||0,this.zoomTransitioned="piecewise-constant"===t.function&&t.transition,this.interp=this.zoomTransitioned?n:r[t.type],this.zoomHistory=s||a,this.instant()||(this.endTime=this.startTime+this.duration+this.delay),i&&i.endTime<=this.startTime&&delete i.oldTransition};s.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},s.prototype.calculate=function(t,e,i){var n=this._calculateTargetValue(t,e);if(this.instant())return n;if((i=i||Date.now())>=this.endTime)return n;var r=this.oldTransition.calculate(t,e,this.startTime),a=o.easeCubicInOut((i-this.startTime-this.delay)/this.duration);return this.interp(r,n,a)},s.prototype._calculateTargetValue=function(t,e){if(!this.zoomTransitioned)return this.declaration.calculate(t,e);var i=t.zoom,n=this.zoomHistory.lastIntegerZoom,o=i>n?2:.5,a=this.declaration.calculate({zoom:i>n?i-1:i+1},e),s=this.declaration.calculate({zoom:i},e),l=Math.min((Date.now()-this.zoomHistory.lastIntegerZoomTime)/this.duration,1),u=Math.abs(i-n),c=r(l,1,u);return void 0!==a&&void 0!==s?{from:a,fromScale:o,to:s,toScale:1,t:c}:void 0},e.exports=s},{"../style-spec/util/interpolate":124,"../util/util":219}],160:[function(t,e,i){"use strict";e.exports=t("../style-spec/validate_style.min"),e.exports.emitErrors=function(t,e){if(e&&e.length){for(var i=0;i<e.length;i++)t.fire("error",{error:new Error(e[i].message)});return!0}return!1}},{"../style-spec/validate_style.min":146}],161:[function(t,e,i){"use strict";var n=function(t){function e(e,i,n,o){t.call(this,e,i),this.angle=n,void 0!==o&&(this.segment=o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(t("point-geometry"));e.exports=n},{"point-geometry":37}],162:[function(t,e,i){"use strict";e.exports=function(t,e,i,n,o){if(void 0===e.segment)return!0;for(var r=e,a=e.segment+1,s=0;s>-i/2;){if(--a<0)return!1;s-=t[a].dist(r),r=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<i/2;){var c=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var f=c.angleTo(h)-h.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:f}),u+=f;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>o)return!1;a++,s+=h.dist(p)}return!0}},{}],163:[function(t,e,i){"use strict";var n=t("point-geometry");e.exports=function(t,e,i,o,r){for(var a=[],s=0;s<t.length;s++)for(var l=t[s],u=void 0,c=0;c<l.length-1;c++){var h=l[c],p=l[c+1];h.x<e&&p.x<e||(h.x<e?h=new n(e,h.y+(p.y-h.y)*((e-h.x)/(p.x-h.x)))._round():p.x<e&&(p=new n(e,h.y+(p.y-h.y)*((e-h.x)/(p.x-h.x)))._round()),h.y<i&&p.y<i||(h.y<i?h=new n(h.x+(p.x-h.x)*((i-h.y)/(p.y-h.y)),i)._round():p.y<i&&(p=new n(h.x+(p.x-h.x)*((i-h.y)/(p.y-h.y)),i)._round()),h.x>=o&&p.x>=o||(h.x>=o?h=new n(o,h.y+(p.y-h.y)*((o-h.x)/(p.x-h.x)))._round():p.x>=o&&(p=new n(o,h.y+(p.y-h.y)*((o-h.x)/(p.x-h.x)))._round()),h.y>=r&&p.y>=r||(h.y>=r?h=new n(h.x+(p.x-h.x)*((r-h.y)/(p.y-h.y)),r)._round():p.y>=r&&(p=new n(h.x+(p.x-h.x)*((r-h.y)/(p.y-h.y)),r)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(p)))))}return a}},{"point-geometry":37}],164:[function(t,e,i){"use strict";var n=t("../util/struct_array"),o=t("point-geometry"),r=n({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"offsetX"},{type:"Int16",name:"offsetY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"unadjustedMaxScale"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});Object.defineProperty(r.prototype.StructType.prototype,"anchorPoint",{get:function(){return new o(this.anchorPointX,this.anchorPointY)}}),e.exports=r},{"../util/struct_array":216,"point-geometry":37}],165:[function(t,e,i){"use strict";var n=function(t,e,i,n,o,r,a,s,l,u,c){var h=a.top*s-l,p=a.bottom*s+l,f=a.left*s-l,d=a.right*s+l;if(this.boxStartIndex=t.length,u){var m=p-h,g=d-f;if(m>0)if(m=Math.max(10*s,m),c){var y=e[i.segment+1].sub(e[i.segment])._unit()._mult(g),v=[i.sub(y),i.add(y)];this._addLineCollisionBoxes(t,v,i,0,g,m,n,o,r)}else this._addLineCollisionBoxes(t,e,i,i.segment,g,m,n,o,r)}else t.emplaceBack(i.x,i.y,0,0,f,h,d,p,1/0,1/0,n,o,r,0,0,0,0,0);this.boxEndIndex=t.length};n.prototype._addLineCollisionBoxes=function(t,e,i,n,o,r,a,s,l){var u=r/2,c=Math.floor(o/u),h=Math.floor(c/2),p=-r/2,f=i,d=n+1,m=p,g=-o/2,y=g-o/8;do{if(--d<0){if(m>g)return;d=0;break}m-=e[d].dist(f),f=e[d]}while(m>y);for(var v=e[d].dist(e[d+1]),_=-h;_<c+h;_++){var x=_*u,b=g+x;if(x<0&&(b+=x),x>o&&(b+=x-o),!(b<m)){for(;m+v<b;){if(m+=v,++d+1>=e.length)return;v=e[d].dist(e[d+1])}var w=b-m,T=e[d],E=e[d+1].sub(T)._unit()._mult(w)._add(T)._round(),C=o/2/Math.max(Math.abs(b-p)-u/2,0);(_<0||_>=c)&&(C=Math.min(C,.99)),t.emplaceBack(E.x,E.y,E.x-i.x,E.y-i.y,-r/2,-r/2,r/2,r/2,C,C,a,s,l,0,0,0,0,0)}}},e.exports=n},{}],166:[function(t,e,i){"use strict";var n=t("point-geometry"),o=t("../data/extent"),r=t("grid-index"),a=t("../util/intersection_tests"),s=function(t,e,i,n,a,s,l){void 0===s&&(s=new r(o,12,6)),void 0===l&&(l=new r(o,12,0)),this.angle=t,this.pitch=e,this.cameraToCenterDistance=i,this.cameraToTileDistance=n,this.grid=s,this.ignoredGrid=l,this.perspectiveRatio=1+.5*(n/i-1),this.minScale=.5/this.perspectiveRatio,this.maxScale=2/this.perspectiveRatio;var u=Math.sin(this.angle),c=Math.cos(this.angle);if(this.rotationMatrix=[c,-u,u,c],this.reverseRotationMatrix=[c,u,-u,c],this.yStretch=Math.max(1,n/(i*Math.cos(e/180*Math.PI))),this.collisionBoxArray=a,0===a.length){a.emplaceBack();a.emplaceBack(0,0,0,0,0,-32767,0,32767,1/0,1/0,0,0,0,0,0,0,0,0,0),a.emplaceBack(o,0,0,0,0,-32767,0,32767,1/0,1/0,0,0,0,0,0,0,0,0,0),a.emplaceBack(0,0,0,0,-32767,0,32767,0,1/0,1/0,0,0,0,0,0,0,0,0,0),a.emplaceBack(0,o,0,0,-32767,0,32767,0,1/0,1/0,0,0,0,0,0,0,0,0,0)}this.tempCollisionBox=a.get(0),this.edges=[a.get(1),a.get(2),a.get(3),a.get(4)]};s.deserialize=function(t,e){return new s(t.angle,t.pitch,t.cameraToCenterDistance,t.cameraToTileDistance,e,new r(t.grid),new r(t.ignoredGrid))},s.prototype.serialize=function(t){var e=this.grid.toArrayBuffer(),i=this.ignoredGrid.toArrayBuffer();return t&&(t.push(e),t.push(i)),{angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,grid:e,ignoredGrid:i}},s.prototype.placeCollisionFeature=function(t,e,i){for(var o=this,r=this.collisionBoxArray,a=this.minScale,s=this.rotationMatrix,l=this.yStretch,u=t.boxStartIndex;u<t.boxEndIndex;u++){var c=r.get(u),h=c.anchorPoint._matMult(s),p=h.x,f=h.y,d=p+c.x1*o.perspectiveRatio,m=f+c.y1*l*o.perspectiveRatio,g=p+c.x2*o.perspectiveRatio,y=f+c.y2*l*o.perspectiveRatio;c.bbox0=d,c.bbox1=m,c.bbox2=g,c.bbox3=y;var v=new n(c.offsetX,c.offsetY)._matMult(s),_=v.x*v.x,x=v.y*v.y,b=x*l*l,w=Math.sqrt((_+b)/(_+x))||1;if(c.maxScale=c.unadjustedMaxScale*w,!e)for(var T=o.grid.query(d,m,g,y),E=0;E<T.length;E++){var C=r.get(T[E]),S=C.anchorPoint._matMult(s);if((a=o.getPlacementScale(a,h,c,S,C))>=o.maxScale)return a}if(i){var A=void 0;if(o.angle){var k=o.reverseRotationMatrix,I=new n(c.x1,c.y1).matMult(k),L=new n(c.x2,c.y1).matMult(k),D=new n(c.x1,c.y2).matMult(k),P=new n(c.x2,c.y2).matMult(k);(A=o.tempCollisionBox).anchorPointX=c.anchorPoint.x,A.anchorPointY=c.anchorPoint.y,A.x1=Math.min(I.x,L.x,D.x,P.x),A.y1=Math.min(I.y,L.x,D.x,P.x),A.x2=Math.max(I.x,L.x,D.x,P.x),A.y2=Math.max(I.y,L.x,D.x,P.x),A.maxScale=c.maxScale}else A=c;for(var z=0;z<this.edges.length;z++){var M=o.edges[z];if((a=o.getPlacementScale(a,c.anchorPoint,A,M.anchorPoint,M))>=o.maxScale)return a}}}return a},s.prototype.queryRenderedSymbols=function(t,e){var i={},o=[];if(0===t.length||0===this.grid.keys.length&&0===this.ignoredGrid.keys.length)return o;for(var r=this.collisionBoxArray,s=this.rotationMatrix,l=this.yStretch,u=[],c=1/0,h=1/0,p=-1/0,f=-1/0,d=0;d<t.length;d++)for(var m=t[d],g=0;g<m.length;g++){var y=m[g].matMult(s);c=Math.min(c,y.x),h=Math.min(h,y.y),p=Math.max(p,y.x),f=Math.max(f,y.y),u.push(y)}for(var v=this.grid.query(c,h,p,f),_=this.ignoredGrid.query(c,h,p,f),x=0;x<_.length;x++)v.push(_[x]);for(var b=e/this.perspectiveRatio,w=Math.pow(2,Math.ceil(Math.log(b)/Math.LN2*10)/10),T=0;T<v.length;T++){var E=r.get(v[T]),C=E.sourceLayerIndex,S=E.featureIndex;if(void 0===i[C]&&(i[C]={}),!i[C][S]&&!(w<E.placementScale||w>E.maxScale)){var A=E.anchorPoint.matMult(s),k=A.x+E.x1/b,I=A.y+E.y1/b*l,L=A.x+E.x2/b,D=A.y+E.y2/b*l,P=[new n(k,I),new n(L,I),new n(L,D),new n(k,D)];a.polygonIntersectsPolygon(u,P)&&(i[C][S]=!0,o.push(v[T]))}}return o},s.prototype.getPlacementScale=function(t,e,i,n,o){var r=e.x-n.x,a=e.y-n.y,s=(o.x1-i.x2)/r,l=(o.x2-i.x1)/r,u=(o.y1-i.y2)*this.yStretch/a,c=(o.y2-i.y1)*this.yStretch/a;(isNaN(s)||isNaN(l))&&(s=l=1),(isNaN(u)||isNaN(c))&&(u=c=1);var h=Math.min(Math.max(s,l),Math.max(u,c)),p=o.maxScale,f=i.maxScale;return h>p&&(h=p),h>f&&(h=f),h>t&&h>=o.placementScale&&(t=h),t},s.prototype.insertCollisionFeature=function(t,e,i){for(var n=this,o=i?this.ignoredGrid:this.grid,r=this.collisionBoxArray,a=t.boxStartIndex;a<t.boxEndIndex;a++){var s=r.get(a);s.placementScale=e,e<n.maxScale&&(1===n.perspectiveRatio||s.maxScale>=1)&&o.insert(a,s.bbox0,s.bbox1,s.bbox2,s.bbox3)}},e.exports=s},{"../data/extent":65,"../util/intersection_tests":210,"grid-index":20,"point-geometry":37}],167:[function(t,e,i){"use strict";function n(t,e,i,s,l,u,c,h,p){for(var f=u/2,d=0,m=0;m<t.length-1;m++)d+=t[m].dist(t[m+1]);for(var g=0,y=e-i,v=[],_=0;_<t.length-1;_++){for(var x=t[_],b=t[_+1],w=x.dist(b),T=b.angleTo(x);y+i<g+w;){var E=((y+=i)-g)/w,C=o(x.x,b.x,E),S=o(x.y,b.y,E);if(C>=0&&C<p&&S>=0&&S<p&&y-f>=0&&y+f<=d){var A=new r(C,S,T,_)._round();s&&!a(t,A,u,s,l)||v.push(A)}}g+=w}return h||v.length||c||(v=n(t,g/2,i,s,l,u,c,!0,p)),v}var o=t("../style-spec/util/interpolate"),r=t("../symbol/anchor"),a=t("./check_max_angle");e.exports=function(t,e,i,o,r,a,s,l,u){var c=o?.6*a*s:0,h=Math.max(o?o.right-o.left:0,r?r.right-r.left:0),p=0===t[0].x||t[0].x===u||0===t[0].y||t[0].y===u;e-h*s<e/4&&(e=h*s+e/4);var f=2*a;return n(t,p?e/2*l%e:(h/2+f)*s*l%e,e,c,i,h*s,p,!1,u)}},{"../style-spec/util/interpolate":124,"../symbol/anchor":161,"./check_max_angle":162}],168:[function(t,e,i){"use strict";var n=t("@mapbox/shelf-pack"),o=t("../util/util"),r=function(){this.width=128,this.height=128,this.atlas=new n(this.width,this.height),this.index={},this.ids={},this.data=new Uint8Array(this.width*this.height)};r.prototype.getGlyphs=function(){var t,e,i,n=this,o={};for(var r in n.ids)e=(t=r.split("#"))[0],i=t[1],o[e]||(o[e]=[]),o[e].push(i);return o},r.prototype.getRects=function(){var t,e,i,n=this,o={};for(var r in n.ids)e=(t=r.split("#"))[0],i=t[1],o[e]||(o[e]={}),o[e][i]=n.index[r];return o},r.prototype.addGlyph=function(t,e,i,n){var r=this;if(!i)return null;var a=e+"#"+i.id;if(this.index[a])return this.ids[a].indexOf(t)<0&&this.ids[a].push(t),this.index[a];if(!i.bitmap)return null;var s=i.width+2*n,l=i.height+2*n,u=s+2,c=l+2,h=this.atlas.packOne(u,c);if(h||(this.resize(),h=this.atlas.packOne(u,c)),!h)return o.warnOnce("glyph bitmap overflow"),null;this.index[a]=h,this.ids[a]=[t];for(var p=this.data,f=i.bitmap,d=0;d<l;d++)for(var m=r.width*(h.y+d+1)+h.x+1,g=s*d,y=0;y<s;y++)p[m+y]=f[g+y];return this.dirty=!0,h},r.prototype.resize=function(){var t=this,e=this.width,i=this.height;if(!(e>=2048||i>=2048)){this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null),this.width*=4,this.height*=4,this.atlas.resize(this.width,this.height);for(var n=new ArrayBuffer(this.width*this.height),o=0;o<i;o++){var r=new Uint8Array(t.data.buffer,i*o,e);new Uint8Array(n,i*o*4,e).set(r)}this.data=new Uint8Array(n)}},r.prototype.bind=function(t){this.gl=t,this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,null))},r.prototype.updateTexture=function(t){this.bind(t),this.dirty&&(t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data),this.dirty=!1)},e.exports=r},{"../util/util":219,"@mapbox/shelf-pack":2}],169:[function(t,e,i){"use strict";function n(t,e,i,n){return n=n||"abc",i.replace("{s}",n[t.length%n.length]).replace("{fontstack}",t).replace("{range}",e)}var o=t("../util/mapbox").normalizeGlyphsURL,r=t("../util/ajax"),a=t("../util/glyphs"),s=t("../symbol/glyph_atlas"),l=t("pbf"),u=t("@mapbox/tiny-sdf"),c=t("../util/is_char_in_unicode_block"),h=function(t,e,i){this.advance=t.advance,this.left=t.left-i-1,this.top=t.top+i+1,this.rect=e},p=function(t){function e(e,i,n){t.call(this),this.url=e&&o(e),this.atlases={},this.stacks={},this.loading={},this.localIdeographFontFamily=i,this.tinySDFs={},this.setEventedParent(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getSimpleGlyphs=function(t,e,i,n){var o=this;void 0===this.stacks[t]&&(this.stacks[t]={ranges:{},cjkGlyphs:{}}),void 0===this.atlases[t]&&(this.atlases[t]=new s);for(var r={},a=this.stacks[t],l=this.atlases[t],u={},p=0,f=0;f<e.length;f++)!function(e){var n=Math.floor(e/256);if(o.localIdeographFontFamily&&(c["CJK Unified Ideographs"](e)||c["Hangul Syllables"](e))){a.cjkGlyphs[e]||(a.cjkGlyphs[e]=o.loadCJKGlyph(t,e));var s=a.cjkGlyphs[e],f=l.addGlyph(i,t,s,3);s&&(r[e]=new h(s,f,3))}else if(a.ranges[n]){var d=a.ranges[n].glyphs[e],m=l.addGlyph(i,t,d,3);d&&(r[e]=new h(d,m,3))}else void 0===u[n]&&(u[n]=[],p++),u[n].push(e)}(e[f]);p||n(void 0,r,t);for(var d in u)o.loadRange(t,d,function(e,a,s){if(e)o.fire("error",{error:e});else{for(var c=o.stacks[t].ranges[a]=s.stacks[0],f=0;f<u[a].length;f++){var d=u[a][f],m=c.glyphs[d],g=l.addGlyph(i,t,m,3);m&&(r[d]=new h(m,g,3))}--p||n(void 0,r,t)}})},e.prototype.createTinySDF=function(t,e){return new u(24,3,8,.25,t,e)},e.prototype.loadCJKGlyph=function(t,e){var i=this.tinySDFs[t];if(!i){var n="400";/bold/i.test(t)?n="900":/medium/i.test(t)?n="500":/light/i.test(t)&&(n="200"),i=this.tinySDFs[t]=this.createTinySDF(this.localIdeographFontFamily,n)}return{id:e,bitmap:i.draw(String.fromCharCode(e)),width:24,height:24,left:0,top:-8,advance:24}},e.prototype.loadPBF=function(t,e){r.getArrayBuffer(t,e)},e.prototype.loadRange=function(t,e,i){if(256*e>65535)return i("glyphs > 65535 not supported");void 0===this.loading[t]&&(this.loading[t]={});var o=this.loading[t];if(o[e])o[e].push(i);else{o[e]=[i];var r=n(t,256*e+"-"+(256*e+255),this.url);this.loadPBF(r,function(t,i){for(var n=!t&&new a(new l(i.data)),r=0;r<o[e].length;r++)o[e][r](t,e,n);delete o[e]})}},e.prototype.getGlyphAtlas=function(t){return this.atlases[t]},e}(t("../util/evented"));e.exports=p},{"../symbol/glyph_atlas":168,"../util/ajax":197,"../util/evented":206,"../util/glyphs":209,"../util/is_char_in_unicode_block":211,"../util/mapbox":213,"@mapbox/tiny-sdf":3,pbf:36}],170:[function(t,e,i){"use strict";e.exports=function(t){function e(e){s.push(t[e]),l++}function i(t,e,i){var n=a[t];return delete a[t],a[e]=n,s[n].geometry[0].pop(),s[n].geometry[0]=s[n].geometry[0].concat(i[0]),n}function n(t,e,i){var n=r[e];return delete r[e],r[t]=n,s[n].geometry[0].shift(),s[n].geometry[0]=i[0].concat(s[n].geometry[0]),n}function o(t,e,i){var n=i?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}for(var r={},a={},s=[],l=0,u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.text;if(p){var f=o(p,h),d=o(p,h,!0);if(f in a&&d in r&&a[f]!==r[d]){var m=n(f,d,h),g=i(f,d,s[m].geometry);delete r[f],delete a[d],a[o(p,s[g].geometry,!0)]=g,s[m].geometry=null}else f in a?i(f,d,h):d in r?n(f,d,h):(e(u),r[f]=l-1,a[d]=l-1)}else e(u)}return s.filter(function(t){return t.geometry})}},{}],171:[function(t,e,i){"use strict";function n(t,e){var i=[t.x,t.y,0,1];return c.transformMat4(i,i,e),new l(i[0]/i[3],i[1]/i[3])}function o(t,e,i,n){var o=t[0]/t[3],r=t[1]/t[3];return o>=-i[0]&&o<=i[0]&&r>=-i[1]&&r<=i[1]&&n.frameHistory.isVisible(e)}function r(t,e,i,o,r,s,l,u,c,h,f,d){var m,g=e/24,y=t.lineOffsetX*e,v=t.lineOffsetY*e;if(t.numGlyphs>1){var _=t.glyphStartIndex+t.numGlyphs,x=u.get(t.glyphStartIndex).offsetX,b=u.get(_-1).offsetX,w=t.lineStartIndex,T=t.lineStartIndex+t.lineLength,E=a(g*x,y,v,i,f,t.segment,w,T,c,s,d);if(!E)return{notEnoughRoom:!0};var C=a(g*b,y,v,i,f,t.segment,w,T,c,s,d);if(!C)return{notEnoughRoom:!0};var S=n(E.point,l),A=n(C.point,l);if(o&&!i&&(t.vertical?S.y<A.y:S.x>A.x))return{needsFlipping:!0};m=[E];for(var k=t.glyphStartIndex+1;k<_-1;k++){var I=u.get(k);m.push(a(g*I.offsetX,y,v,i,f,t.segment,w,T,c,s,d))}m.push(C)}else{if(o&&!i){var L=n(c.get(t.lineStartIndex+t.segment),r),D=n(c.get(t.lineStartIndex+t.segment+1),r);if(t.vertical?D.y>L.y:D.x<L.x)return{needsFlipping:!0}}var P=a(g*u.get(t.glyphStartIndex).offsetX,y,v,i,f,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,c,s,d);if(!P)return{notEnoughRoom:!0};m=[P]}for(var z=t.placementZoom,M=0,O=m;M<O.length;M+=1){var R=O[M];p(h,R.point,R.angle,z)}return{}}function a(t,e,i,o,r,a,s,l,u,c,h){var p=o?t-e:t+e,f=p>0?1:-1,d=0;o&&(f*=-1,d=Math.PI),f<0&&(d+=Math.PI);for(var m=f>0?s+a:s+a+1,g=r,y=r,v=0,_=0,x=Math.abs(p);v+_<=x;){if((m+=f)<s||m>=l)return null;y=g,void 0===(g=h[m])&&(g=h[m]=n(u.get(m),c)),v+=_,_=y.dist(g)}var b=(x-v)/_,w=g.sub(y),T=w.mult(b)._add(y);return T._add(w._unit()._perp()._mult(i*f)),{point:T,angle:d+Math.atan2(g.y-y.y,g.x-y.x)}}function s(t,e){for(var i=0;i<t;i++)p(e,f,0,25)}var l=t("point-geometry"),u=t("@mapbox/gl-matrix").mat4,c=t("@mapbox/gl-matrix").vec4,h=t("./symbol_size"),p=t("../data/bucket/symbol_bucket").addDynamicAttributes;e.exports={updateLineLabels:function(t,e,i,a,u,p,f,d,m,g){var y=a?t.textSizeData:t.iconSizeData,v=h.evaluateSizeForZoom(y,i.transform,g,a),_=[256/i.width*2+1,256/i.height*2+1],x=a?t.buffers.glyph.dynamicLayoutVertexArray:t.buffers.icon.dynamicLayoutVertexArray;x.clear();for(var b=t.lineVertexArray,w=a?t.placedGlyphArray:t.placedIconArray,T=0;T<w.length;T++){var E=w.get(T),C=[E.anchorX,E.anchorY,0,1];if(c.transformMat4(C,C,e),o(C,E.placementZoom,_,i)){var S=1+.5*(C[3]/i.transform.cameraToCenterDistance-1),A=h.evaluateSizeForFeature(y,v,E),k=f?A*S:A/S,I=n(new l(E.anchorX,E.anchorY),u),L={},D=r(E,k,!1,d,e,u,p,t.glyphOffsetArray,b,x,I,L);(D.notEnoughRoom||D.needsFlipping&&r(E,k,!0,d,e,u,p,t.glyphOffsetArray,b,x,I,L).notEnoughRoom)&&s(E.numGlyphs,x)}else s(E.numGlyphs,x)}a?t.buffers.glyph.dynamicLayoutVertexBuffer.updateData(x.serialize()):t.buffers.icon.dynamicLayoutVertexBuffer.updateData(x.serialize())},getLabelPlaneMatrix:function(t,e,i,n,o){var r=u.identity(new Float32Array(16));return e?(u.identity(r),u.scale(r,r,[1/o,1/o,1]),i||u.rotateZ(r,r,n.angle)):(u.scale(r,r,[n.width/2,-n.height/2,1]),u.translate(r,r,[1,-1,0]),u.multiply(r,r,t)),r},getGlCoordMatrix:function(t,e,i,n,o){var r=u.identity(new Float32Array(16));return e?(u.multiply(r,r,t),u.scale(r,r,[o,o,1]),i||u.rotateZ(r,r,-n.angle)):(u.scale(r,r,[1,-1,1]),u.translate(r,r,[-1,-1,0]),u.scale(r,r,[2/n.width,2/n.height,1])),r}};var f=new l(-1/0,-1/0)},{"../data/bucket/symbol_bucket":61,"./symbol_size":175,"@mapbox/gl-matrix":1,"point-geometry":37}],172:[function(t,e,i){"use strict";function n(t,e,i,n,o,r,a){this.tl=t,this.tr=e,this.bl=i,this.br=n,this.tex=o,this.writingMode=r,this.glyphOffset=a}var o=t("point-geometry");e.exports={getIconQuads:function(t,e,i,r,a,s,l){var u,c,h,p,f=e.image,d=i.layout,m=e.top-1/f.pixelRatio,g=e.left-1/f.pixelRatio,y=e.bottom+1/f.pixelRatio,v=e.right+1/f.pixelRatio;if("none"!==d["icon-text-fit"]&&a){var _=v-g,x=y-m,b=d["text-size"]/24,w=a.left*b,T=a.right*b,E=a.top*b,C=T-w,S=a.bottom*b-E,A=d["icon-text-fit-padding"][0],k=d["icon-text-fit-padding"][1],I=d["icon-text-fit-padding"][2],L=d["icon-text-fit-padding"][3],D="width"===d["icon-text-fit"]?.5*(S-x):0,P="height"===d["icon-text-fit"]?.5*(C-_):0,z="width"===d["icon-text-fit"]||"both"===d["icon-text-fit"]?C:_,M="height"===d["icon-text-fit"]||"both"===d["icon-text-fit"]?S:x;u=new o(w+P-L,E+D-A),c=new o(w+P+k+z,E+D-A),h=new o(w+P+k+z,E+D+I+M),p=new o(w+P-L,E+D+I+M)}else u=new o(g,m),c=new o(v,m),h=new o(v,y),p=new o(g,y);var O=i.getLayoutValue("icon-rotate",s,l)*Math.PI/180;if(O){var R=Math.sin(O),N=Math.cos(O),j=[N,-R,R,N];u._matMult(j),c._matMult(j),p._matMult(j),h._matMult(j)}return[new n(u,c,p,h,{x:f.textureRect.x-1,y:f.textureRect.y-1,w:f.textureRect.w+2,h:f.textureRect.h+2},void 0,[0,0])]},getGlyphQuads:function(t,e,i,r,a,s){for(var l=i.getLayoutValue("text-rotate",a,s)*Math.PI/180,u=i.getLayoutValue("text-offset",a,s).map(function(t){return 24*t}),c=e.positionedGlyphs,h=[],p=0;p<c.length;p++){var f=c[p],d=f.glyph;if(d){var m=d.rect;if(m){var g=d.advance/2,y=r?[f.x+g,f.y]:[0,0],v=r?[0,0]:[f.x+g+u[0],f.y+u[1]],_=d.left-g+v[0],x=-d.top+v[1],b=_+m.w,w=x+m.h,T=new o(_,x),E=new o(b,x),C=new o(_,w),S=new o(b,w),A=new o(v[0]-g,d.advance/2);if(0!==f.angle&&(T._sub(A)._rotate(f.angle)._add(A),E._sub(A)._rotate(f.angle)._add(A),C._sub(A)._rotate(f.angle)._add(A),S._sub(A)._rotate(f.angle)._add(A)),l){var k=Math.sin(l),I=Math.cos(l),L=[I,-k,k,I];T._matMult(L),E._matMult(L),C._matMult(L),S._matMult(L)}h.push(new n(T,E,C,S,m,e.writingMode,y))}}}return h},SymbolQuad:n}},{"point-geometry":37}],173:[function(t,e,i){"use strict";function n(t,e,i,n,o){this.codePoint=t,this.x=e,this.y=i,this.glyph=n||null,this.angle=o}function o(t,e,i,n,o,r,a){this.positionedGlyphs=t,this.text=e,this.top=i,this.bottom=n,this.left=o,this.right=r,this.writingMode=a}function r(t,e){for(var i=[],n=0,o=0,r=e;o<r.length;o+=1){var a=r[o];i.push(t.substring(n,a)),n=a}return n<t.length&&i.push(t.substring(n,t.length)),i}function a(t,e,i,n){var o=0;for(var r in t){var a=n[t.charCodeAt(r)];a&&(o+=a.advance+e)}return o/Math.max(1,Math.ceil(o/i))}function s(t,e,i,n){var o=Math.pow(t-e,2);return n?t<e?o/2:2*o:o+Math.abs(i)*i}function l(t,e){var i=0;return 10===t&&(i-=1e4),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function u(t,e,i,n,o,r){for(var a=null,l=s(e,i,o,r),u=0,c=n;u<c.length;u+=1){var h=c[u],p=s(e-h.x,i,o,r)+h.badness;p<=l&&(a=h,l=p)}return{index:t,x:e,priorBreak:a,badness:l}}function c(t){return t?c(t.priorBreak).concat(t.index):[]}function h(t,e,i,n){if(!i)return[];if(!t)return[];for(var o=[],r=a(t,e,i,n),s=0,h=0;h<t.length;h++){var p=t.charCodeAt(h),f=n[p];f&&!b[p]&&(s+=f.advance+e),h<t.length-1&&(w[p]||y.charAllowsIdeographicBreaking(p))&&o.push(u(h+1,s,r,o,l(p,t.charCodeAt(h+1)),!1))}return c(u(t.length,s,r,o,0,!0))}function p(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function f(t,e,i,o,r,a,s,l,u,c){var h=0,f=-17,g=0,v=t.positionedGlyphs,_="right"===a?1:"left"===a?0:.5;for(var b in i){var w=i[b].trim();if(w.length){for(var T=v.length,E=0;E<w.length;E++){var C=w.charCodeAt(E),S=e[C];S&&(y.charHasUprightVerticalOrientation(C)&&l!==x.horizontal?(v.push(new n(C,h,0,S,-Math.PI/2)),h+=c+u):(v.push(new n(C,h,f,S,0)),h+=S.advance+u))}if(v.length!==T){var A=h-u;g=Math.max(A,g),d(v,e,T,v.length-1,_)}h=0,f+=o}else f+=o}var k=p(r);m(v,_,k.horizontalAlign,k.verticalAlign,g,o,i.length);var I=i.length*o;t.top+=-k.verticalAlign*I,t.bottom=t.top+I,t.left+=-k.horizontalAlign*g,t.right=t.left+g}function d(t,e,i,n,o){if(o)for(var r=e[t[n].codePoint].advance,a=(t[n].x+r)*o,s=i;s<=n;s++)t[s].x-=a}function m(t,e,i,n,o,r,a){for(var s=(e-i)*o,l=(-n*a+.5)*r,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l}function g(t,e,i,n,o){this.image=t,this.top=e,this.bottom=i,this.left=n,this.right=o}var y=t("../util/script_detection"),v=t("../util/verticalize_punctuation"),_=t("../source/rtl_text_plugin"),x={horizontal:1,vertical:2};e.exports={shapeText:function(t,e,i,n,a,s,l,u,c,p){var d=t.trim();p===x.vertical&&(d=v(d));var m,g=[],y=new o(g,d,u[1],u[1],u[0],u[0],p);return m=_.processBidirectionalText?_.processBidirectionalText(d,h(d,l,i,e)):r(d,h(d,l,i,e)),f(y,e,m,n,a,s,0,p,l,c),!!g.length&&y},shapeIcon:function(t,e){var i=e[0],n=e[1],o=i-t.displaySize[0]/2,r=o+t.displaySize[0],a=n-t.displaySize[1]/2;return new g(t,a,a+t.displaySize[1],o,r)},WritingMode:x};var b={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},w={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0}},{"../source/rtl_text_plugin":102,"../util/script_detection":214,"../util/verticalize_punctuation":221}],174:[function(t,e,i){"use strict";function n(t){var e={x:t.rect.x+u,y:t.rect.y+u,w:t.rect.w-2*u,h:t.rect.h-2*u};return{sdf:t.sdf,pixelRatio:t.pixelRatio,isNativePixelRatio:t.pixelRatio===a.devicePixelRatio,textureRect:e,tl:[e.x,e.y],br:[e.x+e.w,e.y+e.h],displaySize:[e.w/t.pixelRatio,e.h/t.pixelRatio]}}function o(t,e,i,n,o,r,a,s,l,u,c){var h,p,f=n*e+i,d=s*r+a;if(c)for(d-=r,p=-1;p<=u;p++,d+=r)for(f=((p+u)%u+n)*e+i,h=-1;h<=l;h++)o[d+h]=t[f+(h+l)%l];else for(p=0;p<u;p++,f+=e,d+=r)for(h=0;h<l;h++)o[d+h]=t[f+h]}var r=t("@mapbox/shelf-pack"),a=t("../util/browser"),s=t("../util/util"),l=t("../util/window"),u=1,c=function(t){function e(e,i){t.call(this),this.images={},this.data=!1,this.texture=0,this.filter=0,this.width=Math.ceil(e*a.devicePixelRatio),this.height=Math.ceil(i*a.devicePixelRatio),this.shelfPack=new r(this.width,this.height),this.dirty=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPixelSize=function(){return[this.width,this.height]},e.prototype.allocateImage=function(t,e){var i=t+2*u,n=e+2*u,o=this.shelfPack.packOne(i,n);return o||(s.warnOnce("SpriteAtlas out of space."),null)},e.prototype.addImage=function(t,e,i){var n,o,r;if(e instanceof l.HTMLImageElement?(n=e.width,o=e.height,e=a.getImageData(e),r=1):(n=i.width,o=i.height,r=i.pixelRatio||1),ArrayBuffer.isView(e)&&(e=new Uint32Array(e.buffer)),!(e instanceof Uint32Array))return this.fire("error",{error:new Error("Image provided in an invalid format. Supported formats are HTMLImageElement and ArrayBufferView.")});if(this.images[t])return this.fire("error",{error:new Error("An image with this name already exists.")});var s=this.allocateImage(n,o);if(!s)return this.fire("error",{error:new Error("There is not enough space to add this image.")});this.images[t]={rect:s,width:n,height:o,pixelRatio:r,sdf:!1},this.copy(e,n,s,{x:0,y:0,width:n,height:o},!1),this.fire("data",{dataType:"style"})},e.prototype.removeImage=function(t){var e=this.images[t];if(delete this.images[t],!e)return this.fire("error",{error:new Error("No image with this name exists.")});this.shelfPack.unref(e.rect),this.fire("data",{dataType:"style"})},e.prototype.getIcon=function(t){return this._getImage(t,!1)},e.prototype.getPattern=function(t){return this._getImage(t,!0)},e.prototype._getImage=function(t,e){if(this.images[t])return n(this.images[t]);if(!this.sprite)return null;var i=this.sprite.getSpritePosition(t);if(!i.width||!i.height)return null;var o=this.allocateImage(i.width,i.height);if(!o)return null;var r={rect:o,width:i.width,height:i.height,sdf:i.sdf,pixelRatio:i.pixelRatio};if(this.images[t]=r,!this.sprite.imgData)return null;var a=new Uint32Array(this.sprite.imgData.buffer);return this.copy(a,this.sprite.width,o,i,e),n(r)},e.prototype.allocate=function(){var t=this;if(!this.data){this.data=new Uint32Array(this.width*this.height);for(var e=0;e<this.data.length;e++)t.data[e]=0}},e.prototype.copy=function(t,e,i,n,r){this.allocate();var a=this.data;o(t,e,n.x,n.y,a,this.getPixelSize()[0],i.x+u,i.y+u,n.width,n.height,r),this.dirty=!0},e.prototype.setSprite=function(t){t&&this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.sprite=t},e.prototype.addIcons=function(t,e){for(var i=this,n={},o=0,r=t;o<r.length;o+=1){var a=r[o];n[a]=i.getIcon(a)}e(null,n)},e.prototype.bind=function(t,e){var i=!1;this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i=!0);var n=e?t.LINEAR:t.NEAREST;n!==this.filter&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),this.filter=n),this.dirty&&(this.allocate(),i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1)},e}(t("../util/evented"));e.exports=c},{"../util/browser":198,"../util/evented":206,"../util/util":219,"../util/window":200,"@mapbox/shelf-pack":2}],175:[function(t,e,i){"use strict";var n=t("../style-spec/util/interpolate"),o=t("../util/util"),r=t("../style-spec/function").interpolationFactor,a=t("assert");e.exports={evaluateSizeForFeature:function(t,e,i){var o=e;return t.isFeatureConstant?o.uSize:t.isZoomConstant?i.lowerSize/10:n.number(i.lowerSize/10,i.upperSize/10,o.uSizeT)},evaluateSizeForZoom:function(t,e,i,n){var s={};if(t.isZoomConstant||t.isFeatureConstant)if(t.isFeatureConstant&&!t.isZoomConstant){var l;if("interval"===t.functionType)l=i.getLayoutValue(n?"text-size":"icon-size",{zoom:e.zoom});else{a("exponential"===t.functionType);var u="interval"===t.functionType?0:r(e.zoom,t.functionBase,t.coveringZoomRange[0],t.coveringZoomRange[1]),c=t.coveringStopValues[0];l=c+(t.coveringStopValues[1]-c)*o.clamp(u,0,1)}s.uSize=l}else t.isFeatureConstant&&t.isZoomConstant&&(s.uSize=t.layoutSize);else{var h=r(e.zoom,t.functionBase,t.coveringZoomRange[0],t.coveringZoomRange[1]);s.uSizeT=o.clamp(h,0,1)}return s}}},{"../style-spec/function":118,"../style-spec/util/interpolate":124,"../util/util":219,assert:6}],176:[function(t,e,i){"use strict";var n=t("../source/rtl_text_plugin");e.exports=function(t,e,i,o){var r=e.getLayoutValue("text-transform",i,o);return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),n.applyArabicShaping&&(t=n.applyArabicShaping(t)),t}},{"../source/rtl_text_plugin":102}],177:[function(t,e,i){"use strict";var n=t("../util/dom"),o=t("point-geometry"),r={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),touchZoomRotate:t("./handler/touch_zoom_rotate")};e.exports=function(t,e){function i(){p=null}function a(e,i){var o=n.mousePos(l,i);return t.fire(e,{lngLat:t.unproject(o),point:o,originalEvent:i})}function s(e,i){var r=n.touchPos(l,i),a=r.reduce(function(t,e,i,n){return t.add(e.div(n.length))},new o(0,0));return t.fire(e,{lngLat:t.unproject(a),point:a,lngLats:r.map(function(e){return t.unproject(e)},this),points:r,originalEvent:i})}var l=t.getCanvasContainer(),u=null,c=!1,h=null,p=null;for(var f in r)t[f]=new r[f](t,e),e.interactive&&e[f]&&t[f].enable(e[f]);l.addEventListener("mouseout",function(t){a("mouseout",t)},!1),l.addEventListener("mousedown",function(e){t.stop(),h=n.mousePos(l,e),a("mousedown",e),c=!0},!1),l.addEventListener("mouseup",function(e){var i=t.dragRotate&&t.dragRotate.isActive();u&&!i&&a("contextmenu",u),u=null,c=!1,a("mouseup",e)},!1),l.addEventListener("mousemove",function(e){if(!(t.dragPan&&t.dragPan.isActive()||t.dragRotate&&t.dragRotate.isActive())){for(var i=e.toElement||e.target;i&&i!==l;)i=i.parentNode;i===l&&a("mousemove",e)}},!1),l.addEventListener("touchstart",function(e){t.stop(),s("touchstart",e),!e.touches||e.touches.length>1||(p?(clearTimeout(p),p=null,a("dblclick",e)):p=setTimeout(i,300))},!1),l.addEventListener("touchend",function(t){s("touchend",t)},!1),l.addEventListener("touchmove",function(t){s("touchmove",t)},!1),l.addEventListener("touchcancel",function(t){s("touchcancel",t)},!1),l.addEventListener("click",function(t){n.mousePos(l,t).equals(h)&&a("click",t)},!1),l.addEventListener("dblclick",function(t){a("dblclick",t),t.preventDefault()},!1),l.addEventListener("contextmenu",function(e){var i=t.dragRotate&&t.dragRotate.isActive();c||i?c&&(u=e):a("contextmenu",e),e.preventDefault()},!1)}},{"../util/dom":205,"./handler/box_zoom":185,"./handler/dblclick_zoom":186,"./handler/drag_pan":187,"./handler/drag_rotate":188,"./handler/keyboard":189,"./handler/scroll_zoom":190,"./handler/touch_zoom_rotate":191,"point-geometry":37}],178:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../style-spec/util/interpolate"),r=t("../util/browser"),a=t("../geo/lng_lat"),s=t("../geo/lng_lat_bounds"),l=t("point-geometry"),u=function(t){function e(e,i){t.call(this),this.moving=!1,this.transform=e,this._bearingSnap=i.bearingSnap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCenter=function(){return this.transform.center},e.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},e.prototype.panBy=function(t,e,i){return t=l.convert(t).mult(-1),this.panTo(this.transform.center,n.extend({offset:t},e),i)},e.prototype.panTo=function(t,e,i){return this.easeTo(n.extend({center:t},e),i)},e.prototype.getZoom=function(){return this.transform.zoom},e.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},e.prototype.zoomTo=function(t,e,i){return this.easeTo(n.extend({zoom:t},e),i)},e.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},e.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},e.prototype.getBearing=function(){return this.transform.bearing},e.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},e.prototype.rotateTo=function(t,e,i){return this.easeTo(n.extend({bearing:t},e),i)},e.prototype.resetNorth=function(t,e){return this.rotateTo(0,n.extend({duration:1e3},t),e),this},e.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},e.prototype.getPitch=function(){return this.transform.pitch},e.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},e.prototype.fitBounds=function(t,e,i){if("number"==typeof(e=n.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){var o=e.padding;e.padding={top:o,bottom:o,right:o,left:o}}if(n.deepEqual(Object.keys(e.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){t=s.convert(t);var r=[e.padding.left-e.padding.right,e.padding.top-e.padding.bottom],a=Math.min(e.padding.right,e.padding.left),u=Math.min(e.padding.top,e.padding.bottom);e.offset=[e.offset[0]+r[0],e.offset[1]+r[1]];var c=l.convert(e.offset),h=this.transform,p=h.project(t.getNorthWest()),f=h.project(t.getSouthEast()),d=f.sub(p),m=(h.width-2*a-2*Math.abs(c.x))/d.x,g=(h.height-2*u-2*Math.abs(c.y))/d.y;if(!(g<0||m<0))return e.center=h.unproject(p.add(f).div(2)),e.zoom=Math.min(h.scaleZoom(h.scale*Math.min(m,g)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e,i):this.flyTo(e,i);n.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else n.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},e.prototype.jumpTo=function(t,e){this.stop();var i=this.transform,n=!1,o=!1,r=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(n=!0,i.zoom=+t.zoom),"center"in t&&(i.center=a.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(o=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(r=!0,i.pitch=+t.pitch),this.fire("movestart",e).fire("move",e),n&&this.fire("zoomstart",e).fire("zoom",e).fire("zoomend",e),o&&this.fire("rotate",e),r&&this.fire("pitchstart",e).fire("pitch",e).fire("pitchend",e),this.fire("moveend",e)},e.prototype.easeTo=function(t,e){var i=this;this.stop(),!1===(t=n.extend({offset:[0,0],duration:500,easing:n.ease},t)).animate&&(t.duration=0),t.smoothEasing&&0!==t.duration&&(t.easing=this._smoothOutEasing(t.duration));var r=this.transform,s=this.getZoom(),u=this.getBearing(),c=this.getPitch(),h="zoom"in t?+t.zoom:s,p="bearing"in t?this._normalizeBearing(t.bearing,u):u,f="pitch"in t?+t.pitch:c,d=r.centerPoint.add(l.convert(t.offset)),m=r.pointLocation(d),g=a.convert(t.center||m);this._normalizeCenter(g);var y,v,_=r.project(m),x=r.project(g).sub(_),b=r.zoomScale(h-s);return t.around&&(y=a.convert(t.around),v=r.locationPoint(y)),this.zooming=h!==s,this.rotating=u!==p,this.pitching=f!==c,this._prepareEase(e,t.noMoveStart),clearTimeout(this._onEaseEnd),this._ease(function(t){if(this.zooming&&(r.zoom=o(s,h,t)),this.rotating&&(r.bearing=o(u,p,t)),this.pitching&&(r.pitch=o(c,f,t)),y)r.setLocationAtPoint(y,v);else{var i=r.zoomScale(r.zoom-s),n=h>s?Math.min(2,b):Math.max(.5,b),a=Math.pow(n,1-t),l=r.unproject(_.add(x.mult(t*a)).mult(i));r.setLocationAtPoint(r.renderWorldCopies?l.wrap():l,d)}this._fireMoveEvents(e)},function(){t.delayEndEvents?i._onEaseEnd=setTimeout(function(){return i._easeToEnd(e)},t.delayEndEvents):i._easeToEnd(e)},t),this},e.prototype._prepareEase=function(t,e){this.moving=!0,e||this.fire("movestart",t),this.zooming&&this.fire("zoomstart",t),this.pitching&&this.fire("pitchstart",t)},e.prototype._fireMoveEvents=function(t){this.fire("move",t),this.zooming&&this.fire("zoom",t),this.rotating&&this.fire("rotate",t),this.pitching&&this.fire("pitch",t)},e.prototype._easeToEnd=function(t){var e=this.zooming,i=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,e&&this.fire("zoomend",t),i&&this.fire("pitchend",t),this.fire("moveend",t)},e.prototype.flyTo=function(t,e){function i(t){var e=(S*S-C*C+(t?-1:1)*L*L*A*A)/(2*(t?S:C)*L*A);return Math.log(Math.sqrt(e*e+1)-e)}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function s(t){return(Math.exp(t)+Math.exp(-t))/2}function u(t){return r(t)/s(t)}var c=this;this.stop(),t=n.extend({offset:[0,0],speed:1.2,curve:1.42,easing:n.ease},t);var h=this.transform,p=this.getZoom(),f=this.getBearing(),d=this.getPitch(),m="zoom"in t?n.clamp(+t.zoom,h.minZoom,h.maxZoom):p,g="bearing"in t?this._normalizeBearing(t.bearing,f):f,y="pitch"in t?+t.pitch:d,v=h.zoomScale(m-p),_=h.centerPoint.add(l.convert(t.offset)),x=h.pointLocation(_),b=a.convert(t.center||x);this._normalizeCenter(b);var w=h.project(x),T=h.project(b).sub(w),E=t.curve,C=Math.max(h.width,h.height),S=C/v,A=T.mag();if("minZoom"in t){var k=n.clamp(Math.min(t.minZoom,p,m),h.minZoom,h.maxZoom),I=C/h.zoomScale(k-p);E=Math.sqrt(I/A*2)}var L=E*E,D=i(0),P=function(t){return s(D)/s(D+E*t)},z=function(t){return C*((s(D)*u(D+E*t)-r(D))/L)/A},M=(i(1)-D)/E;if(Math.abs(A)<1e-6||isNaN(M)){if(Math.abs(C-S)<1e-6)return this.easeTo(t,e);var O=S<C?-1:1;M=Math.abs(Math.log(S/C))/E,z=function(){return 0},P=function(t){return Math.exp(O*E*t)}}if("duration"in t)t.duration=+t.duration;else{var R="screenSpeed"in t?+t.screenSpeed/E:+t.speed;t.duration=1e3*M/R}return this.zooming=!0,this.rotating=f!==g,this.pitching=y!==d,this._prepareEase(e,!1),this._ease(function(t){var i=t*M,n=1/P(i);h.zoom=p+h.scaleZoom(n),this.rotating&&(h.bearing=o(f,g,t)),this.pitching&&(h.pitch=o(d,y,t));var r=h.unproject(w.add(T.mult(z(i))).mult(n));h.setLocationAtPoint(h.renderWorldCopies?r.wrap():r,_),this._fireMoveEvents(e)},function(){return c._easeToEnd(e)},t),this},e.prototype.isEasing=function(){return!!this._abortFn},e.prototype.isMoving=function(){return this.moving},e.prototype.stop=function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},e.prototype._ease=function(t,e,i){this._finishFn=e,this._abortFn=r.timed(function(e){t.call(this,i.easing(e)),1===e&&this._finishEase()},!1===i.animate?0:i.duration,this)},e.prototype._finishEase=function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},e.prototype._normalizeBearing=function(t,e){t=n.wrap(t,-180,180);var i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t},e.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}},e.prototype._smoothOutEasing=function(t){var e=n.ease;if(this._prevEase){var i=this._prevEase,o=(Date.now()-i.start)/i.duration,r=i.easing(o+.01)-i.easing(o),a=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-a*a);e=n.bezier(a,s,.25,1)}return this._prevEase={start:(new Date).getTime(),duration:t,easing:e},e},e}(t("../util/evented"));e.exports=u},{"../geo/lng_lat":73,"../geo/lng_lat_bounds":74,"../style-spec/util/interpolate":124,"../util/browser":198,"../util/evented":206,"../util/util":219,"point-geometry":37}],179:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/config"),a=function(t){this.options=t,o.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};a.prototype.getDefaultPosition=function(){return"bottom-right"},a.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},a.prototype._updateEditLink=function(){this._editLink||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var t=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:r.ACCESS_TOKEN}];if(this._editLink){var e=t.reduce(function(e,i,n){return void 0!==i.value&&(e+=i.key+"="+i.value+(n<t.length-1?"&":"")),e},"?");this._editLink.href="https://www.mapbox.com/feedback/"+e+(this._map._hash?this._map._hash.getHashString(!0):"")}},a.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},a.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var i=this._map.style.sourceCaches;for(var n in i){var o=i[n].getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}t.sort(function(t,e){return t.length-e.length}),t=t.filter(function(e,i){for(var n=i+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0}),this._container.innerHTML=t.join(" | "),this._editLink=null}},a.prototype._updateCompact=function(){var t=this._map.getCanvasContainer().offsetWidth<=640;this._container.classList[t?"add":"remove"]("mapboxgl-compact")},e.exports=a},{"../../util/config":202,"../../util/dom":205,"../../util/util":219}],180:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/window"),a=function(){this._fullscreen=!1,o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in r.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in r.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in r.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};a.prototype.onAdd=function(t){return this._map=t,this._mapContainer=this._map.getContainer(),this._container=n.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._container},a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=null,r.document.removeEventListener(this._fullscreenchange,this._changeIcon)},a.prototype._checkFullscreenSupport=function(){return!!(r.document.fullscreenEnabled||r.document.mozFullscreenEnabled||r.document.msFullscreenEnabled||r.document.webkitFullscreenEnabled)},a.prototype._setupUI=function(){var t=this._fullscreenButton=n.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);t.setAttribute("aria-label","Toggle fullscreen"),t.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.document.addEventListener(this._fullscreenchange,this._changeIcon)},a.prototype._isFullscreen=function(){return this._fullscreen},a.prototype._changeIcon=function(){(r.document.fullscreenElement||r.document.mozFullScreenElement||r.document.webkitFullscreenElement||r.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},a.prototype._onClickFullscreen=function(){this._isFullscreen()?r.document.exitFullscreen?r.document.exitFullscreen():r.document.mozCancelFullScreen?r.document.mozCancelFullScreen():r.document.msExitFullscreen?r.document.msExitFullscreen():r.document.webkitCancelFullScreen&&r.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()},e.exports=a},{"../../util/dom":205,"../../util/util":219,"../../util/window":200}],181:[function(t,e,i){"use strict";function n(t){void 0!==o?t(o):void 0!==s.navigator.permissions?s.navigator.permissions.query({name:"geolocation"}).then(function(e){o="denied"!==e.state,t(o)}):(o=!!s.navigator.geolocation,t(o))}var o,r=t("../../util/evented"),a=t("../../util/dom"),s=t("../../util/window"),l=t("../../util/util"),u=t("assert"),c=t("../../geo/lng_lat"),h=t("../marker"),p={positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},f=function(t){function e(e){t.call(this),this.options=l.extend({},p,e),l.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker","_onClickGeolocate"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){return this._map=t,this._container=a.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n(this._setupUI),this._container},e.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(s.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),this._container.parentNode.removeChild(this._container),this._map=void 0},e.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;default:u(!1,"Unexpected watchState "+this._watchState)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire("geolocate",t),this._finish()},e.prototype._updateCamera=function(t){var e=new c(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy;this._map.fitBounds(e.toBounds(i),this.options.fitBoundsOptions,{geolocateSource:!0})},e.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},e.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:u(!1,"Unexpected watchState "+this._watchState)}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire("error",t),this._finish()},e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},e.prototype._setupUI=function(t){var e=this;!1!==t&&(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=a.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed",!1),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=a.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new h(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)),this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==e._watchState||(e._watchState="BACKGROUND",e._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),e._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),e.fire("trackuserlocationend"))}))},e.prototype._onClickGeolocate=function(){if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire("trackuserlocationstart");break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire("trackuserlocationend");break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire("trackuserlocationstart");break;default:u(!1,"Unexpected watchState "+this._watchState)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break;case"OFF":break;default:u(!1,"Unexpected watchState "+this._watchState)}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed",!0),this._geolocationWatchID=s.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else s.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4)},e.prototype._clearWatch=function(){s.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed",!1),this.options.showUserLocation&&this._updateMarker(null)},e}(r);e.exports=f},{"../../geo/lng_lat":73,"../../util/dom":205,"../../util/evented":206,"../../util/util":219,"../../util/window":200,"../marker":194,assert:6}],182:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=function(){o.bindAll(["_updateLogo"],this)};r.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},r.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("sourcedata",this._updateLogo)},r.prototype.getDefaultPosition=function(){return"bottom-left"},r.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},r.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},e.exports=r},{"../../util/dom":205,"../../util/util":219}],183:[function(t,e,i){"use strict";function n(t){return new r.MouseEvent(t.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:t.detail,view:t.view,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,movementX:t.movementX,movementY:t.movementY,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey,metaKey:t.metaKey})}var o=t("../../util/dom"),r=t("../../util/window"),a=t("../../util/util"),s="mapboxgl-ctrl",l=function(){a.bindAll(["_rotateCompassArrow"],this)};l.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},l.prototype.onAdd=function(t){return this._map=t,this._container=o.create("div",s+" "+s+"-group",t.getContainer()),this._container.addEventListener("contextmenu",this._onContextMenu.bind(this)),this._zoomInButton=this._createButton(s+"-icon "+s+"-zoom-in","Zoom In",t.zoomIn.bind(t)),this._zoomOutButton=this._createButton(s+"-icon "+s+"-zoom-out","Zoom Out",t.zoomOut.bind(t)),this._compass=this._createButton(s+"-icon "+s+"-compass","Reset North",t.resetNorth.bind(t)),this._compassArrow=o.create("span",s+"-compass-arrow",this._compass),this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._container},l.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("rotate",this._rotateCompassArrow),this._map=void 0},l.prototype._onContextMenu=function(t){t.preventDefault()},l.prototype._onCompassDown=function(t){0===t.button&&(o.disableDrag(),r.document.addEventListener("mousemove",this._onCompassMove),r.document.addEventListener("mouseup",this._onCompassUp),this._map.getCanvasContainer().dispatchEvent(n(t)),t.stopPropagation())},l.prototype._onCompassMove=function(t){0===t.button&&(this._map.getCanvasContainer().dispatchEvent(n(t)),t.stopPropagation())},l.prototype._onCompassUp=function(t){0===t.button&&(r.document.removeEventListener("mousemove",this._onCompassMove),r.document.removeEventListener("mouseup",this._onCompassUp),o.enableDrag(),this._map.getCanvasContainer().dispatchEvent(n(t)),t.stopPropagation())},l.prototype._createButton=function(t,e,i){var n=o.create("button",t,this._container);return n.type="button",n.setAttribute("aria-label",e),n.addEventListener("click",function(){i()}),n},e.exports=l},{"../../util/dom":205,"../../util/util":219,"../../util/window":200}],184:[function(t,e,i){"use strict";function n(t,e,i){var n=i&&i.maxWidth||100,a=t._container.clientHeight/2,s=r(t.unproject([0,a]),t.unproject([n,a]));if(i&&"imperial"===i.unit){var l=3.2808*s;l>5280?o(e,n,l/5280,"mi"):o(e,n,l,"ft")}else o(e,n,s,"m")}function o(t,e,i,n){var o=a(i),r=o/i;"m"===n&&o>=1e3&&(o/=1e3,n="km"),t.style.width=e*r+"px",t.innerHTML=o+n}function r(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,r=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return 6371e3*Math.acos(Math.min(r,1))}function a(t){var e=Math.pow(10,(""+Math.floor(t)).length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}var s=t("../../util/dom"),l=t("../../util/util"),u=function(t){this.options=t,l.bindAll(["_onMove"],this)};u.prototype.getDefaultPosition=function(){return"bottom-left"},u.prototype._onMove=function(){n(this._map,this._container,this.options)},u.prototype.onAdd=function(t){return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},u.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("move",this._onMove),this._map=void 0},e.exports=u},{"../../util/dom":205,"../../util/util":219}],185:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../geo/lng_lat_bounds"),r=t("../../util/util"),a=t("../../util/window"),s=function(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),r.bindAll(["_onMouseDown","_onMouseMove","_onMouseUp","_onKeyDown"],this)};s.prototype.isEnabled=function(){return!!this._enabled},s.prototype.isActive=function(){return!!this._active},s.prototype.enable=function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)},s.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},s.prototype._onMouseDown=function(t){t.shiftKey&&0===t.button&&(a.document.addEventListener("mousemove",this._onMouseMove,!1),a.document.addEventListener("keydown",this._onKeyDown,!1),a.document.addEventListener("mouseup",this._onMouseUp,!1),n.disableDrag(),this._startPos=n.mousePos(this._el,t),this._active=!0)},s.prototype._onMouseMove=function(t){var e=this._startPos,i=n.mousePos(this._el,t);this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var o=Math.min(e.x,i.x),r=Math.max(e.x,i.x),a=Math.min(e.y,i.y),s=Math.max(e.y,i.y);n.setTransform(this._box,"translate("+o+"px,"+a+"px)"),this._box.style.width=r-o+"px",this._box.style.height=s-a+"px"},s.prototype._onMouseUp=function(t){if(0===t.button){var e=this._startPos,i=n.mousePos(this._el,t),r=(new o).extend(this._map.unproject(e)).extend(this._map.unproject(i));this._finish(),e.x===i.x&&e.y===i.y?this._fireEvent("boxzoomcancel",t):this._map.fitBounds(r,{linear:!0}).fire("boxzoomend",{originalEvent:t,boxZoomBounds:r})}},s.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},s.prototype._finish=function(){this._active=!1,a.document.removeEventListener("mousemove",this._onMouseMove,!1),a.document.removeEventListener("keydown",this._onKeyDown,!1),a.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.parentNode.removeChild(this._box),this._box=null),n.enableDrag()},s.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},e.exports=s},{"../../geo/lng_lat_bounds":74,"../../util/dom":205,"../../util/util":219,"../../util/window":200}],186:[function(t,e,i){"use strict";var n=function(t){this._map=t,this._onDblClick=this._onDblClick.bind(this)};n.prototype.isEnabled=function(){return!!this._enabled},n.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)},n.prototype.disable=function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},n.prototype._onDblClick=function(t){this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},e.exports=n},{}],187:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/window"),a=o.bezier(0,0,.3,1),s=function(t){this._map=t,this._el=t.getCanvasContainer(),o.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp"],this)};s.prototype.isEnabled=function(){return!!this._enabled},s.prototype.isActive=function(){return!!this._active},s.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},s.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},s.prototype._onDown=function(t){this._ignoreEvent(t)||this.isActive()||(t.touches?(r.document.addEventListener("touchmove",this._onMove),r.document.addEventListener("touchend",this._onTouchEnd)):(r.document.addEventListener("mousemove",this._onMove),r.document.addEventListener("mouseup",this._onMouseUp)),r.addEventListener("blur",this._onMouseUp),this._active=!1,this._startPos=this._pos=n.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]])},s.prototype._onMove=function(t){if(!this._ignoreEvent(t)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",t),this._fireEvent("movestart",t));var e=n.mousePos(this._el,t),i=this._map;i.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),e]),i.transform.setLocationAtPoint(i.transform.pointLocation(this._pos),e),this._fireEvent("drag",t),this._fireEvent("move",t),this._pos=e,t.preventDefault()}},s.prototype._onUp=function(t){var e=this;if(this.isActive()){this._active=!1,this._fireEvent("dragend",t),this._drainInertiaBuffer();var i=function(){e._map.moving=!1,e._fireEvent("moveend",t)},n=this._inertia;if(n.length<2)i();else{var o=n[n.length-1],r=n[0],s=o[1].sub(r[1]),l=(o[0]-r[0])/1e3;if(0===l||o[1].equals(r[1]))i();else{var u=s.mult(.3/l),c=u.mag();c>1400&&(c=1400,u._unit()._mult(c));var h=c/750,p=u.mult(-h/2);this._map.panBy(p,{duration:1e3*h,easing:a,noMoveStart:!0},{originalEvent:t})}}}},s.prototype._onMouseUp=function(t){this._ignoreEvent(t)||(this._onUp(t),r.document.removeEventListener("mousemove",this._onMove),r.document.removeEventListener("mouseup",this._onMouseUp),r.removeEventListener("blur",this._onMouseUp))},s.prototype._onTouchEnd=function(t){this._ignoreEvent(t)||(this._onUp(t),r.document.removeEventListener("touchmove",this._onMove),r.document.removeEventListener("touchend",this._onTouchEnd))},s.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},s.prototype._ignoreEvent=function(t){var e=this._map;if(e.boxZoom&&e.boxZoom.isActive())return!0;if(e.dragRotate&&e.dragRotate.isActive())return!0;if(t.touches)return t.touches.length>1;if(t.ctrlKey)return!0;return"mousemove"===t.type?!1&t.buttons:t.button&&0!==t.button},s.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},e.exports=s},{"../../util/dom":205,"../../util/util":219,"../../util/window":200}],188:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/window"),a=o.bezier(0,0,.25,1),s=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._bearingSnap=e.bearingSnap,this._pitchWithRotate=!1!==e.pitchWithRotate,o.bindAll(["_onDown","_onMove","_onUp"],this)};s.prototype.isEnabled=function(){return!!this._enabled},s.prototype.isActive=function(){return!!this._active},s.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},s.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},s.prototype._onDown=function(t){this._ignoreEvent(t)||this.isActive()||(r.document.addEventListener("mousemove",this._onMove),r.document.addEventListener("mouseup",this._onUp),r.addEventListener("blur",this._onUp),this._active=!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=n.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault())},s.prototype._onMove=function(t){if(!this._ignoreEvent(t)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t));var e=this._map;e.stop();var i=this._pos,o=n.mousePos(this._el,t),r=.8*(i.x-o.x),a=-.5*(i.y-o.y),s=e.getBearing()-r,l=e.getPitch()-a,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([Date.now(),e._normalizeBearing(s,c[1])]),e.transform.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.transform.pitch=l),this._fireEvent("rotate",t),this._fireEvent("move",t),this._pos=o}},s.prototype._onUp=function(t){var e=this;if(!this._ignoreEvent(t)&&(r.document.removeEventListener("mousemove",this._onMove),r.document.removeEventListener("mouseup",this._onUp),r.removeEventListener("blur",this._onUp),this.isActive())){this._active=!1,this._fireEvent("rotateend",t),this._drainInertiaBuffer();var i=this._map,n=i.getBearing(),o=this._inertia,s=function(){Math.abs(n)<e._bearingSnap?i.resetNorth({noMoveStart:!0},{originalEvent:t}):(e._map.moving=!1,e._fireEvent("moveend",t)),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(o.length<2)s();else{var l=o[0],u=o[o.length-1],c=o[o.length-2],h=i._normalizeBearing(n,c[1]),p=u[1]-l[1],f=p<0?-1:1,d=(u[0]-l[0])/1e3;if(0!==p&&0!==d){var m=Math.abs(p*(.25/d));m>180&&(m=180);var g=m/180;h+=f*m*(g/2),Math.abs(i._normalizeBearing(h,0))<this._bearingSnap&&(h=i._normalizeBearing(0,h)),i.rotateTo(h,{duration:1e3*g,easing:a,noMoveStart:!0},{originalEvent:t})}else s()}}},s.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},s.prototype._ignoreEvent=function(t){var e=this._map;if(e.boxZoom&&e.boxZoom.isActive())return!0;if(e.dragPan&&e.dragPan.isActive())return!0;if(t.touches)return t.touches.length>1;var i=t.ctrlKey?1:2,n=t.ctrlKey?0:2,o=t.button;return"undefined"!=typeof InstallTrigger&&2===t.button&&t.ctrlKey&&r.navigator.platform.toUpperCase().indexOf("MAC")>=0&&(o=0),"mousemove"===t.type?t.buttons&0===i:!this.isActive()&&o!==n},s.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},e.exports=s},{"../../util/dom":205,"../../util/util":219,"../../util/window":200}],189:[function(t,e,i){"use strict";function n(t){return t*(2-t)}var o=function(t){this._map=t,this._el=t.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)};o.prototype.isEnabled=function(){return!!this._enabled},o.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},o.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},o.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,i=0,o=0,r=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?o=-1:(a=1,t.preventDefault());break;default:return}var s=this._map,l=s.getZoom(),u={duration:300,delayEndEvents:500,easing:n,zoom:e?Math.round(l)+e*(t.shiftKey?2:1):l,bearing:s.getBearing()+15*i,pitch:s.getPitch()+10*o,offset:[100*-r,100*-a],center:s.getCenter()};s.easeTo(u,{originalEvent:t})}},e.exports=o},{}],190:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/browser"),a=t("../../util/window"),s=a.navigator.userAgent.toLowerCase(),l=-1!==s.indexOf("firefox"),u=-1!==s.indexOf("safari")&&-1===s.indexOf("chrom"),c=function(t){this._map=t,this._el=t.getCanvasContainer(),o.bindAll(["_onWheel","_onTimeout"],this)};c.prototype.isEnabled=function(){return!!this._enabled},c.prototype.enable=function(t){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},c.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},c.prototype._onWheel=function(t){var e;"wheel"===t.type?(e=t.deltaY,l&&t.deltaMode===a.WheelEvent.DOM_DELTA_PIXEL&&(e/=r.devicePixelRatio),t.deltaMode===a.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,u&&(e/=3));var i=r.now(),o=i-(this._time||0);this._pos=n.mousePos(this._el,t),this._time=i,0!==e&&e%4.000244140625==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(o*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e,t),t.preventDefault()},c.prototype._onTimeout=function(){this._type="wheel",this._zoom(-this._lastValue)},c.prototype._zoom=function(t,e){if(0!==t){var i=this._map,n=2/(1+Math.exp(-Math.abs(t/100)));t<0&&0!==n&&(n=1/n);var o=i.ease?i.ease.to:i.transform.scale,r=i.transform.scaleZoom(o*n);i.zoomTo(r,{duration:"wheel"===this._type?200:0,around:this._aroundCenter?i.getCenter():i.unproject(this._pos),delayEndEvents:200,smoothEasing:!0},{originalEvent:e})}},e.exports=c},{"../../util/browser":198,"../../util/dom":205,"../../util/util":219,"../../util/window":200}],191:[function(t,e,i){"use strict";var n=t("../../util/dom"),o=t("../../util/util"),r=t("../../util/window"),a=o.bezier(0,0,.15,1),s=function(t){this._map=t,this._el=t.getCanvasContainer(),o.bindAll(["_onStart","_onMove","_onEnd"],this)};s.prototype.isEnabled=function(){return!!this._enabled},s.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},s.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},s.prototype.disableRotation=function(){this._rotationDisabled=!0},s.prototype.enableRotation=function(){this._rotationDisabled=!1},s.prototype._onStart=function(t){if(2===t.touches.length){var e=n.mousePos(this._el,t.touches[0]),i=n.mousePos(this._el,t.touches[1]);this._startVec=e.sub(i),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,this._gestureIntent=void 0,this._inertia=[],r.document.addEventListener("touchmove",this._onMove,!1),r.document.addEventListener("touchend",this._onEnd,!1)}},s.prototype._onMove=function(t){if(2===t.touches.length){var e=n.mousePos(this._el,t.touches[0]),i=n.mousePos(this._el,t.touches[1]),o=e.add(i).div(2),r=e.sub(i),a=r.mag()/this._startVec.mag(),s=this._rotationDisabled?0:180*r.angleWith(this._startVec)/Math.PI,l=this._map;if(this._gestureIntent){var u={duration:0,around:l.unproject(o)};"rotate"===this._gestureIntent&&(u.bearing=this._startBearing+s),"zoom"!==this._gestureIntent&&"rotate"!==this._gestureIntent||(u.zoom=l.transform.scaleZoom(this._startScale*a)),l.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),a,o]),l.easeTo(u,{originalEvent:t})}else{var c=Math.abs(1-a)>.15;Math.abs(s)>10?this._gestureIntent="rotate":c&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=r,this._startScale=l.transform.scale,this._startBearing=l.transform.bearing)}t.preventDefault()}},s.prototype._onEnd=function(t){r.document.removeEventListener("touchmove",this._onMove),r.document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer();var e=this._inertia,i=this._map;if(e.length<2)i.snapToNorth({},{originalEvent:t});else{var n=e[e.length-1],o=e[0],s=i.transform.scaleZoom(this._startScale*n[1]),l=i.transform.scaleZoom(this._startScale*o[1]),u=s-l,c=(n[0]-o[0])/1e3,h=n[2];if(0!==c&&s!==l){var p=.15*u/c;Math.abs(p)>2.5&&(p=p>0?2.5:-2.5);var f=1e3*Math.abs(p/(12*.15)),d=s+p*f/2e3;d<0&&(d=0),i.easeTo({zoom:d,duration:f,easing:a,around:this._aroundCenter?i.getCenter():i.unproject(h)},{originalEvent:t})}else i.snapToNorth({},{originalEvent:t})}},s.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>2&&e-t[0][0]>160;)t.shift()},e.exports=s},{"../../util/dom":205,"../../util/util":219,"../../util/window":200}],192:[function(t,e,i){"use strict";var n=t("../util/util"),o=t("../util/window"),r=function(){n.bindAll(["_onHashChange","_updateHash"],this)};r.prototype.addTo=function(t){return this._map=t,o.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},r.prototype.remove=function(){return o.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},r.prototype.getHashString=function(t){var e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,n=Math.max(0,Math.ceil(Math.log(i)/Math.LN2)),o=Math.round(e.lng*Math.pow(10,n))/Math.pow(10,n),r=Math.round(e.lat*Math.pow(10,n))/Math.pow(10,n),a=this._map.getBearing(),s=this._map.getPitch(),l="";return l+=t?"#/"+o+"/"+r+"/"+i:"#"+i+"/"+r+"/"+o,(a||s)&&(l+="/"+Math.round(10*a)/10),s&&(l+="/"+Math.round(s)),l},r.prototype._onHashChange=function(){var t=o.location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},r.prototype._updateHash=function(){var t=this.getHashString();o.history.replaceState("","",t)},e.exports=r},{"../util/util":219,"../util/window":200}],193:[function(t,e,i){"use strict";function n(t){t.parentNode&&t.parentNode.removeChild(t)}var o=t("../util/util"),r=t("../util/browser"),a=t("../util/window"),s=t("../util/dom"),l=t("../util/ajax"),u=t("../style/style"),c=t("../style/animation_loop"),h=t("../render/painter"),p=t("../geo/transform"),f=t("./hash"),d=t("./bind_handlers"),m=t("./camera"),g=t("../geo/lng_lat"),y=t("../geo/lng_lat_bounds"),v=t("point-geometry"),_=t("./control/attribution_control"),x=t("./control/logo_control"),b=t("mapbox-gl-supported"),w={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null},T=function(t){function e(e){var i=this;if(null!=(e=o.extend({},w,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var n=new p(e.minZoom,e.maxZoom,e.renderWorldCopies);if(t.call(this,n,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,"string"==typeof e.container){if(this._container=a.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else this._container=e.container;this.animationLoop=new c,e.maxBounds&&this.setMaxBounds(e.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),this.on("moveend",function(){i.animationLoop.set(300),i._rerender()}),void 0!==a&&(a.addEventListener("online",this._onWindowOnline,!1),a.addEventListener("resize",this._onWindowResize,!1)),d(this,e),this._hash=e.hash&&(new f).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this._classes=[],this.resize(),e.classes&&this.setClasses(e.classes),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new _),this.addControl(new x,e.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this.style.update(this._classes,{transition:!1})}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};return e.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var i=t.onAdd(this),n=this._controlPositions[e];return-1!==e.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this},e.prototype.removeControl=function(t){return t.onRemove(this),this},e.prototype.addClass=function(t,e){return o.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(t)>=0||""===t?this:(this._classes.push(t),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0))},e.prototype.removeClass=function(t,e){o.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");var i=this._classes.indexOf(t);return i<0||""===t?this:(this._classes.splice(i,1),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0))},e.prototype.setClasses=function(t,e){o.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");for(var i={},n=0;n<t.length;n++)""!==t[n]&&(i[t[n]]=!0);return this._classes=Object.keys(i),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0)},e.prototype.hasClass=function(t){return o.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(t)>=0},e.prototype.getClasses=function(){return o.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes},e.prototype.resize=function(){var t=this._containerDimensions(),e=t[0],i=t[1];return this._resizeCanvas(e,i),this.transform.resize(e,i),this.painter.resize(e,i),this.fire("movestart").fire("move").fire("resize").fire("moveend")},e.prototype.getBounds=function(){var t=new y(this.transform.pointLocation(new v(0,this.transform.height)),this.transform.pointLocation(new v(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new v(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new v(0,this.transform.size.y)))),t},e.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new y([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},e.prototype.setMaxBounds=function(t){if(t){var e=y.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null!==t&&void 0!==t||(this.transform.lngRange=[],this.transform.latRange=[],this._update());return this},e.prototype.setMinZoom=function(t){if((t=null===t||void 0===t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(t){if((t=null===t||void 0===t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(t){return this.transform.locationPoint(g.convert(t))},e.prototype.unproject=function(t){return this.transform.pointLocation(v.convert(t))},e.prototype.on=function(e,i,n){var r=this;if(void 0===n)return t.prototype.on.call(this,e,i);var a=function(){if("mouseenter"===e||"mouseover"===e){var t=!1;return{layer:i,listener:n,delegates:{mousemove:function(a){var s=r.queryRenderedFeatures(a.point,{layers:[i]});s.length?t||(t=!0,n.call(r,o.extend({features:s},a,{type:e}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===e||"mouseout"===e){var a=!1;return{layer:i,listener:n,delegates:{mousemove:function(t){r.queryRenderedFeatures(t.point,{layers:[i]}).length?a=!0:a&&(a=!1,n.call(r,o.extend({},t,{type:e})))},mouseout:function(t){a&&(a=!1,n.call(r,o.extend({},t,{type:e})))}}}}return{layer:i,listener:n,delegates:(s={},s[e]=function(t){var e=r.queryRenderedFeatures(t.point,{layers:[i]});e.length&&n.call(r,o.extend({features:e},t))},s)};var s}();this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(a);for(var s in a.delegates)r.on(s,a.delegates[s]);return this},e.prototype.off=function(e,i,n){var o=this;if(void 0===n)return t.prototype.off.call(this,e,i);if(this._delegatedListeners&&this._delegatedListeners[e])for(var r=this._delegatedListeners[e],a=0;a<r.length;a++){var s=r[a];if(s.layer===i&&s.listener===n){for(var l in s.delegates)o.off(l,s.delegates[l]);return r.splice(a,1),o}}},e.prototype.queryRenderedFeatures=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n={};return 2===t.length?(i=arguments[0],n=arguments[1]):1===t.length&&function(t){return t instanceof v||Array.isArray(t)}(t[0])?i=t[0]:1===t.length&&(n=t[0]),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(i),n,this.transform.zoom,this.transform.angle):[]},e.prototype._makeQueryGeometry=function(t){var e=this;void 0===t&&(t=[v.convert([0,0]),v.convert([this.transform.width,this.transform.height])]);var i;if(t instanceof v||"number"==typeof t[0])i=[v.convert(t)];else{var n=[v.convert(t[0]),v.convert(t[1])];i=[n[0],new v(n[1].x,n[0].y),n[1],new v(n[0].x,n[1].y),n[0]]}return i=i.map(function(t){return e.transform.pointCoordinate(t)})},e.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},e.prototype.setStyle=function(t,e){if((!e||!1!==e.diff&&!e.localIdeographFontFamily)&&this.style&&t&&!(t instanceof u)&&"string"!=typeof t)try{return this.style.setState(t)&&this._update(!0),this}catch(t){o.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement),this.off("move",this.style._redoPlacement)),t?(this.style=t instanceof u?t:new u(t,this,e),this.style.setEventedParent(this,{style:this.style}),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this.on("move",this.style._redoPlacement),this):(this.style=null,this)},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];{if(void 0!==e)return e.loaded();this.fire("error",{error:new Error("There is no source with ID '"+t+"'")})}},e.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var i=t[e]._tiles;for(var n in i){var o=i[n];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},e.prototype.addSourceType=function(t,e,i){return this.style.addSourceType(t,e,i)},e.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},e.prototype.getSource=function(t){return this.style.getSource(t)},e.prototype.addImage=function(t,e,i){this.style.spriteAtlas.addImage(t,e,i)},e.prototype.removeImage=function(t){this.style.spriteAtlas.removeImage(t)},e.prototype.loadImage=function(t,e){l.getImage(t,e)},e.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},e.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},e.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},e.prototype.getLayer=function(t){return this.style.getLayer(t)},e.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},e.prototype.setLayerZoomRange=function(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0),this},e.prototype.getFilter=function(t){return this.style.getFilter(t)},e.prototype.setPaintProperty=function(t,e,i,n){return this.style.setPaintProperty(t,e,i,n),this._update(!0),this},e.prototype.getPaintProperty=function(t,e,i){return this.style.getPaintProperty(t,e,i)},e.prototype.setLayoutProperty=function(t,e,i){return this.style.setLayoutProperty(t,e,i),this._update(!0),this},e.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},e.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},e.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map");var e=this._canvasContainer=s.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var n=this._controlContainer=s.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=s.create("div","mapboxgl-ctrl-"+t,n)})},e.prototype._resizeCanvas=function(t,e){var i=a.devicePixelRatio||1;this._canvas.width=i*t,this._canvas.height=i*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var t=o.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},b.webGLContextAttributes),e=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);e?this.painter=new h(e,this.transform):this.fire("error",{error:new Error("Failed to initialize WebGL")})},e.prototype._contextLost=function(t){t.preventDefault(),this._frameId&&(r.cancelFrame(this._frameId),this._frameId=null),this.fire("webglcontextlost",{originalEvent:t})},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire("webglcontextrestored",{originalEvent:t})},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},e.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},e.prototype._render=function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty)&&this._rerender(),this},e.prototype.remove=function(){this._hash&&this._hash.remove(),r.cancelFrame(this._frameId),this._frameId=null,this.setStyle(null),void 0!==a&&(a.removeEventListener("resize",this._onWindowResize,!1),a.removeEventListener("online",this._onWindowOnline,!1));var t=this.painter.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),n(this._canvasContainer),n(this._controlContainer),this._container.classList.remove("mapboxgl-map"),this.fire("remove")},e.prototype._rerender=function(){this.style&&!this._frameId&&(this._frameId=r.frame(this._render))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,this.style._redoPlacement())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(t){this._repaint=t,this._update()},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(t){this._vertices=t,this._update()},e.prototype._onData=function(t){this._update("style"===t.dataType),this.fire(t.dataType+"data",t)},e.prototype._onDataLoading=function(t){this.fire(t.dataType+"dataloading",t)},Object.defineProperties(e.prototype,i),e}(m);e.exports=T},{"../geo/lng_lat":73,"../geo/lng_lat_bounds":74,"../geo/transform":75,"../render/painter":88,"../style/animation_loop":147,"../style/style":150,"../util/ajax":197,"../util/browser":198,"../util/dom":205,"../util/util":219,"../util/window":200,"./bind_handlers":177,"./camera":178,"./control/attribution_control":179,"./control/logo_control":182,"./hash":192,"mapbox-gl-supported":34,"point-geometry":37}],194:[function(t,e,i){"use strict";var n=t("../util/dom"),o=t("../geo/lng_lat"),r=t("point-geometry"),a=t("../util/smart_wrap"),s=function(t,e){this._offset=r.convert(e&&e.offset||[0,0]),this._update=this._update.bind(this),this._onMapClick=this._onMapClick.bind(this),t||(t=n.create("div")),t.classList.add("mapboxgl-marker"),this._element=t,this._popup=null};s.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map=null),n.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(t){return this._lngLat=o.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(t){return this._popup&&(this._popup.remove(),this._popup=null),t&&("offset"in t.options||(t.options.offset=this._offset),this._popup=t,this._popup.setLngLat(this._lngLat)),this},s.prototype._onMapClick=function(t){var e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var t=this._popup;t&&(t.isOpen()?t.remove():t.addTo(this._map))},s.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=a(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset)._add({x:-this._element.offsetWidth/2,y:-this._element.offsetHeight/2}),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,"translate("+this._pos.x+"px, "+this._pos.y+"px)"))},e.exports=s},{"../geo/lng_lat":73,"../util/dom":205,"../util/smart_wrap":215,"point-geometry":37}],195:[function(t,e,i){"use strict";function n(t){if(t){if("number"==typeof t){var e=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{top:new u(0,t),"top-left":new u(e,e),"top-right":new u(-e,e),bottom:new u(0,-t),"bottom-left":new u(e,-e),"bottom-right":new u(-e,-e),left:new u(t,0),right:new u(-t,0)}}if(o(t)){var i=u.convert(t);return{top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{top:u.convert(t.top||[0,0]),"top-left":u.convert(t["top-left"]||[0,0]),"top-right":u.convert(t["top-right"]||[0,0]),bottom:u.convert(t.bottom||[0,0]),"bottom-left":u.convert(t["bottom-left"]||[0,0]),"bottom-right":u.convert(t["bottom-right"]||[0,0]),left:u.convert(t.left||[0,0]),right:u.convert(t.right||[0,0])}}return n(new u(0,0))}function o(t){return t instanceof u||Array.isArray(t)}var r=t("../util/util"),a=t("../util/evented"),s=t("../util/dom"),l=t("../geo/lng_lat"),u=t("point-geometry"),c=t("../util/window"),h=t("../util/smart_wrap"),p={closeButton:!0,closeOnClick:!0},f=function(t){function e(e){t.call(this),this.options=r.extend(Object.create(p),e),r.bindAll(["_update","_onClickClose"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addTo=function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},e.prototype.isOpen=function(){return!!this._map},e.prototype.remove=function(){return this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._container&&(this._container.parentNode.removeChild(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire("close"),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=l.convert(t),this._pos=null,this._update(),this},e.prototype.setText=function(t){return this.setDOMContent(c.document.createTextNode(t))},e.prototype.setHTML=function(t){var e,i=c.document.createDocumentFragment(),n=c.document.createElement("body");for(n.innerHTML=t;;){if(!(e=n.firstChild))break;i.appendChild(e)}return this.setDOMContent(i)},e.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},e.prototype._createContent=function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._content=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},e.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=h(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat);var t=this.options.anchor,e=n(this.options.offset);if(!t){var i=this._container.offsetWidth,o=this._container.offsetHeight;t=this._pos.y+e.bottom.y<o?["top"]:this._pos.y>this._map.transform.height-o?["bottom"]:[],this._pos.x<i/2?t.push("left"):this._pos.x>this._map.transform.width-i/2&&t.push("right"),t=0===t.length?"bottom":t.join("-")}var r=this._pos.add(e[t]).round(),a={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},l=this._container.classList;for(var u in a)l.remove("mapboxgl-popup-anchor-"+u);l.add("mapboxgl-popup-anchor-"+t),s.setTransform(this._container,a[t]+" translate("+r.x+"px,"+r.y+"px)")}},e.prototype._onClickClose=function(){this.remove()},e}(a);e.exports=f},{"../geo/lng_lat":73,"../util/dom":205,"../util/evented":206,"../util/smart_wrap":215,"../util/util":219,"../util/window":200,"point-geometry":37}],196:[function(t,e,i){"use strict";var n=function(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)};n.prototype.send=function(t,e,i,n,o){var r=i?this.mapId+":"+this.callbackID++:null;i&&(this.callbacks[r]=i),this.target.postMessage({targetMapId:o,sourceMapId:this.mapId,type:t,id:String(r),data:e},n)},n.prototype.receive=function(t){var e,i=this,n=t.data,o=n.id;if(!n.targetMapId||this.mapId===n.targetMapId){var r=function(t,e,n){i.target.postMessage({sourceMapId:i.mapId,type:"<response>",id:String(o),error:t?String(t):null,data:e},n)};if("<response>"===n.type)e=this.callbacks[n.id],delete this.callbacks[n.id],e&&n.error?e(new Error(n.error)):e&&e(null,n.data);else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,n.data,r);else if(void 0!==n.id&&this.parent.getWorkerSource){var a=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,a[0])[a[1]](n.data,r)}else this.parent[n.type](n.data)}},n.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},e.exports=n},{}],197:[function(t,e,i){"use strict";function n(t){var e=o.document.createElement("a");return e.href=t,e.protocol===o.document.location.protocol&&e.host===o.document.location.host}var o=t("./window"),r=function(t){function e(e,i){t.call(this,e),this.status=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);i.getJSON=function(t,e){var i=new o.XMLHttpRequest;return i.open("GET",t,!0),i.setRequestHeader("Accept","application/json"),i.onerror=function(){e(new Error(i.statusText))},i.onload=function(){if(i.status>=200&&i.status<300&&i.response){var t;try{t=JSON.parse(i.response)}catch(t){return e(t)}e(null,t)}else e(new r(i.statusText,i.status))},i.send(),i},i.getArrayBuffer=function(t,e){var i=new o.XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onerror=function(){e(new Error(i.statusText))},i.onload=function(){var t=i.response;if(0===t.byteLength&&200===i.status)return e(new Error("http status 200 returned without content."));i.status>=200&&i.status<300&&i.response?e(null,{data:t,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")}):e(new r(i.statusText,i.status))},i.send(),i};i.getImage=function(t,e){return i.getArrayBuffer(t,function(t,i){if(t)e(t);else if(i){var n=new o.Image,r=o.URL||o.webkitURL;n.onload=function(){e(null,n),r.revokeObjectURL(n.src)};var a=new o.Blob([new Uint8Array(i.data)],{type:"image/png"});n.cacheControl=i.cacheControl,n.expires=i.expires,n.src=i.data.byteLength?r.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},i.getVideo=function(t,e){var i=o.document.createElement("video");i.onloadstart=function(){e(null,i)};for(var r=0;r<t.length;r++){var a=o.document.createElement("source");n(t[r])||(i.crossOrigin="Anonymous"),a.src=t[r],i.appendChild(a)}return i}},{"./window":200}],198:[function(t,e,i){"use strict";var n=t("./window"),o=n.performance&&n.performance.now?n.performance.now.bind(n.performance):Date.now.bind(Date),r=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame,a=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.msCancelAnimationFrame;e.exports={now:o,frame:function(t){return r(t)},cancelFrame:function(t){return a(t)},timed:function(t,e,i){function n(){if(!a){var l=o();l>=s+e?t.call(i,1):(t.call(i,(l-s)/e),r(n))}}if(!e)return t.call(i,1),null;var a=!1,s=o();return r(n),function(){a=!0}},getImageData:function(t){var e=n.document.createElement("canvas"),i=e.getContext("2d");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(0,0,t.width,t.height).data},hardwareConcurrency:n.navigator.hardwareConcurrency||4,get devicePixelRatio(){return n.devicePixelRatio},supportsWebp:!1};var s=n.document.createElement("img");s.onload=function(){e.exports.supportsWebp=!0},s.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":200}],199:[function(t,e,i){"use strict";var n=t("webworkify"),o=t("../window"),r=o.URL.createObjectURL(new n(t("../../source/worker"),{bare:!0}));e.exports=function(){return new o.Worker(r)}},{"../../source/worker":111,"../window":200,webworkify:52}],200:[function(t,e,i){"use strict";e.exports=self},{}],201:[function(t,e,i){"use strict";function n(t,e){return e.area-t.area}var o=t("quickselect"),r=t("./util").calculateSignedArea;e.exports=function(t,e){var i=t.length;if(i<=1)return[t];for(var a,s,l=[],u=0;u<i;u++){var c=r(t[u]);0!==c&&(t[u].area=Math.abs(c),void 0===s&&(s=c<0),s===c<0?(a&&l.push(a),a=[t[u]]):a.push(t[u]))}if(a&&l.push(a),e>1)for(var h=0;h<l.length;h++)l[h].length<=e||(o(l[h],e,1,l[h].length-1,n),l[h]=l[h].slice(0,e));return l}},{"./util":219,quickselect:39}],202:[function(t,e,i){"use strict";var n={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null};e.exports=n},{}],203:[function(t,e,i){"use strict";var n=t("assert"),o=function(t){var e=this;this._stringToNumber={},this._numberToString=[];for(var i=0;i<t.length;i++){var n=t[i];e._stringToNumber[n]=i,e._numberToString[i]=n}};o.prototype.encode=function(t){return n(t in this._stringToNumber),this._stringToNumber[t]},o.prototype.decode=function(t){return n(t<this._numberToString.length),this._numberToString[t]},e.exports=o},{assert:6}],204:[function(t,e,i){"use strict";var n=t("./util"),o=t("./actor"),r=function(t,e){var i=this;this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n.uniqueId();for(var r=this.workerPool.acquire(this.id),a=0;a<r.length;a++){var s=r[a],l=new o(s,e,i.id);l.name="Worker "+a,i.actors.push(l)}};r.prototype.broadcast=function(t,e,i){i=i||function(){},n.asyncAll(this.actors,function(i,n){i.send(t,e,n)},i)},r.prototype.send=function(t,e,i,n,o){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,i,o),n},r.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},e.exports=r},{"./actor":196,"./util":219}],205:[function(t,e,i){"use strict";function n(t){for(var e=0;e<t.length;e++)if(t[e]in l)return t[e];return t[0]}function o(t){t.preventDefault(),t.stopPropagation(),a.removeEventListener("click",o,!0)}var r=t("point-geometry"),a=t("./window");i.create=function(t,e,i){var n=a.document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n};var s,l=a.document.documentElement.style,u=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){u&&(s=l[u],l[u]="none")},i.enableDrag=function(){u&&(l[u]=s)};var c=n(["transform","WebkitTransform"]);i.setTransform=function(t,e){t.style[c]=e},i.suppressClick=function(){a.addEventListener("click",o,!0),a.setTimeout(function(){a.removeEventListener("click",o,!0)},0)},i.mousePos=function(t,e){var i=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new r(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)},i.touchPos=function(t,e){for(var i=t.getBoundingClientRect(),n=[],o="touchend"===e.type?e.changedTouches:e.touches,a=0;a<o.length;a++)n.push(new r(o[a].clientX-i.left-t.clientLeft,o[a].clientY-i.top-t.clientTop));return n},i.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)}},{"./window":200,"point-geometry":37}],206:[function(t,e,i){"use strict";function n(t,e,i){i[t]=i[t]||[],i[t].push(e)}function o(t,e,i){if(i&&i[t]){var n=i[t].indexOf(e);-1!==n&&i[t].splice(n,1)}}var r=t("./util"),a=function(){};a.prototype.on=function(t,e){return this._listeners=this._listeners||{},n(t,e,this._listeners),this},a.prototype.off=function(t,e){return o(t,e,this._listeners),o(t,e,this._oneTimeListeners),this},a.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},n(t,e,this._oneTimeListeners),this},a.prototype.fire=function(t,e){var i=this;if(this.listens(t)){e=r.extend({},e,{type:t,target:this});for(var n=this._listeners&&this._listeners[t]?this._listeners[t].slice():[],a=0;a<n.length;a++)n[a].call(i,e);for(var s=this._oneTimeListeners&&this._oneTimeListeners[t]?this._oneTimeListeners[t].slice():[],l=0;l<s.length;l++)s[l].call(i,e),o(t,s[l],i._oneTimeListeners);this._eventedParent&&this._eventedParent.fire(t,r.extend({},e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else r.endsWith(t,"error")&&console.error(e&&e.error||e||"Empty error event");return this},a.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},a.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this},e.exports=a},{"./util":219}],207:[function(t,e,i){"use strict";function n(t,e){return e.max-t.max}function o(t,e,i,n){this.p=new l(t,e),this.h=i,this.d=r(this.p,n),this.max=this.d+this.h*Math.SQRT2}function r(t,e){for(var i=!1,n=1/0,o=0;o<e.length;o++)for(var r=e[o],a=0,s=r.length,l=s-1;a<s;l=a++){var c=r[a],h=r[l];c.y>t.y!=h.y>t.y&&t.x<(h.x-c.x)*(t.y-c.y)/(h.y-c.y)+c.x&&(i=!i),n=Math.min(n,u(t,c,h))}return(i?1:-1)*Math.sqrt(n)}function a(t){for(var e=0,i=0,n=0,r=t[0],a=0,s=r.length,l=s-1;a<s;l=a++){var u=r[a],c=r[l],h=u.x*c.y-c.x*u.y;i+=(u.x+c.x)*h,n+=(u.y+c.y)*h,e+=3*h}return new o(i/e,n/e,0,t)}var s=t("tinyqueue"),l=t("point-geometry"),u=t("./intersection_tests").distToSegmentSquared;e.exports=function(t,e,i){e=e||1;for(var r,l,u,c,h=t[0],p=0;p<h.length;p++){var f=h[p];(!p||f.x<r)&&(r=f.x),(!p||f.y<l)&&(l=f.y),(!p||f.x>u)&&(u=f.x),(!p||f.y>c)&&(c=f.y)}var d=u-r,m=c-l,g=Math.min(d,m),y=g/2,v=new s(null,n);if(0===g)return[r,l];for(var _=r;_<u;_+=g)for(var x=l;x<c;x+=g)v.push(new o(_+y,x+y,y,t));for(var b=a(t),w=v.length;v.length;){var T=v.pop();(T.d>b.d||!b.d)&&(b=T,i&&console.log("found best %d after %d probes",Math.round(1e4*T.d)/1e4,w)),T.max-b.d<=e||(y=T.h/2,v.push(new o(T.p.x-y,T.p.y-y,y,t)),v.push(new o(T.p.x+y,T.p.y-y,y,t)),v.push(new o(T.p.x-y,T.p.y+y,y,t)),v.push(new o(T.p.x+y,T.p.y+y,y,t)),w+=4)}return i&&(console.log("num probes: "+w),console.log("best distance: "+b.d)),b.p}},{"./intersection_tests":210,"point-geometry":37,tinyqueue:41}],208:[function(t,e,i){"use strict";var n,o=t("./worker_pool");e.exports=function(){return n||(n=new o),n}},{"./worker_pool":222}],209:[function(t,e,i){"use strict";function n(t,e,i){if(1===t){var n=i.readMessage(o,{glyphs:{}});e.push(n)}}function o(t,e,i){if(1===t)e.name=i.readString();else if(2===t)e.range=i.readString();else if(3===t){var n=i.readMessage(r,{});e.glyphs[n.id]=n}}function r(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}e.exports=function(t,e){this.stacks=t.readFields(n,[],e)}},{}],210:[function(t,e,i){"use strict";function n(t,e,i){if(t.length>1){if(o(t,e))return!0;for(var n=0;n<e.length;n++)if(a(e[n],t,i))return!0}for(var r=0;r<t.length;r++)if(a(t[r],e,i))return!0;return!1}function o(t,e){if(0===t.length||0===e.length)return!1;for(var i=0;i<t.length-1;i++)for(var n=t[i],o=t[i+1],a=0;a<e.length-1;a++)if(r(n,o,e[a],e[a+1]))return!0;return!1}function r(t,e,i,n){return c(t,i,n)!==c(e,i,n)&&c(t,e,i)!==c(t,e,n)}function a(t,e,i){var n=i*i;if(1===e.length)return t.distSqr(e[0])<n;for(var o=1;o<e.length;o++)if(s(t,e[o-1],e[o])<n)return!0;return!1}function s(t,e,i){var n=e.distSqr(i);if(0===n)return t.distSqr(e);var o=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return o<0?t.distSqr(e):o>1?t.distSqr(i):t.distSqr(i.sub(e)._mult(o)._add(e))}function l(t,e){for(var i,n,o,r=!1,a=0;a<t.length;a++)for(var s=0,l=(i=t[a]).length-1;s<i.length;l=s++)n=i[s],o=i[l],n.y>e.y!=o.y>e.y&&e.x<(o.x-n.x)*(e.y-n.y)/(o.y-n.y)+n.x&&(r=!r);return r}function u(t,e){for(var i=!1,n=0,o=t.length-1;n<t.length;o=n++){var r=t[n],a=t[o];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(i=!i)}return i}var c=t("./util").isCounterClockwise;e.exports={multiPolygonIntersectsBufferedMultiPoint:function(t,e,i){for(var n=0;n<t.length;n++)for(var o=t[n],r=0;r<e.length;r++)for(var s=e[r],l=0;l<s.length;l++){var c=s[l];if(u(o,c))return!0;if(a(c,o,i))return!0}return!1},multiPolygonIntersectsMultiPolygon:function(t,e){if(1===t.length&&1===t[0].length)return l(e,t[0][0]);for(var i=0;i<e.length;i++)for(var n=e[i],r=0;r<n.length;r++)if(l(t,n[r]))return!0;for(var a=0;a<t.length;a++){for(var s=t[a],u=0;u<s.length;u++)if(l(e,s[u]))return!0;for(var c=0;c<e.length;c++)if(o(s,e[c]))return!0}return!1},multiPolygonIntersectsBufferedMultiLine:function(t,e,i){for(var o=0;o<e.length;o++)for(var r=e[o],a=0;a<t.length;a++){var s=t[a];if(s.length>=3)for(var l=0;l<r.length;l++)if(u(s,r[l]))return!0;if(n(s,r,i))return!0}return!1},polygonIntersectsPolygon:function(t,e){for(var i=0;i<t.length;i++)if(u(e,t[i]))return!0;for(var n=0;n<e.length;n++)if(u(t,e[n]))return!0;return!!o(t,e)},distToSegmentSquared:s}},{"./util":219}],211:[function(t,e,i){"use strict";var n={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};e.exports=n},{}],212:[function(t,e,i){"use strict";var n=function(t,e){this.max=t,this.onRemove=e,this.reset()};n.prototype.reset=function(){var t=this;for(var e in t.data)t.onRemove(t.data[e]);return this.data={},this.order=[],this},n.prototype.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var i=this.get(this.order[0]);i&&this.onRemove(i)}return this},n.prototype.has=function(t){return t in this.data},n.prototype.keys=function(){return this.order},n.prototype.get=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},n.prototype.getWithoutRemoving=function(t){return this.has(t)?this.data[t]:null},n.prototype.remove=function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this},n.prototype.setMaxSize=function(t){var e=this;for(this.max=t;this.order.length>this.max;){var i=e.get(e.order[0]);i&&e.onRemove(i)}return this},e.exports=n},{}],213:[function(t,e,i){"use strict";function n(t,e){var i=a(l.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"/"!==i.path&&(t.path=""+i.path+t.path),!l.REQUIRE_ACCESS_TOKEN)return s(t);if(!(e=e||l.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return t.params.push("access_token="+e),s(t)}function o(t){return 0===t.indexOf("mapbox:")}function r(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(l.ACCESS_TOKEN||""))}function a(t){var e=t.match(p);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function s(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var l=t("./config"),u=t("./browser"),c="See https://www.mapbox.com/api-documentation/#access-tokens";i.isMapboxURL=o,i.normalizeStyleURL=function(t,e){if(!o(t))return t;var i=a(t);return i.path="/styles/v1"+i.path,n(i,e)},i.normalizeGlyphsURL=function(t,e){if(!o(t))return t;var i=a(t);return i.path="/fonts/v1"+i.path,n(i,e)},i.normalizeSourceURL=function(t,e){if(!o(t))return t;var i=a(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),n(i,e)},i.normalizeSpriteURL=function(t,e,i,r){var l=a(t);return o(t)?(l.path="/styles/v1"+l.path+"/sprite"+e+i,n(l,r)):(l.path+=""+e+i,s(l))};var h=/(\.(png|jpg)\d*)(?=$)/;i.normalizeTileURL=function(t,e,i){if(!e||!o(e))return t;var n=a(t),l=u.devicePixelRatio>=2||512===i?"@2x":"",c=u.supportsWebp?".webp":"$1";return n.path=n.path.replace(h,""+l+c),r(n.params),s(n)};var p=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":198,"./config":202}],214:[function(t,e,i){"use strict";var n=t("./is_char_in_unicode_block");e.exports.allowsIdeographicBreaking=function(t){for(var e=0,n=t;e<n.length;e+=1){var o=n[e];if(!i.charAllowsIdeographicBreaking(o.charCodeAt(0)))return!1}return!0},e.exports.allowsVerticalWritingMode=function(t){for(var e=0,n=t;e<n.length;e+=1){var o=n[e];if(i.charHasUprightVerticalOrientation(o.charCodeAt(0)))return!0}return!1},e.exports.allowsLetterSpacing=function(t){for(var e=0,n=t;e<n.length;e+=1){var o=n[e];if(!i.charAllowsLetterSpacing(o.charCodeAt(0)))return!1}return!0},e.exports.charAllowsLetterSpacing=function(t){return!n.Arabic(t)&&(!n["Arabic Supplement"](t)&&(!n["Arabic Extended-A"](t)&&(!n["Arabic Presentation Forms-A"](t)&&!n["Arabic Presentation Forms-B"](t))))},e.exports.charAllowsIdeographicBreaking=function(t){return!(t<11904)&&(!!n["Bopomofo Extended"](t)||(!!n.Bopomofo(t)||(!!n["CJK Compatibility Forms"](t)||(!!n["CJK Compatibility Ideographs"](t)||(!!n["CJK Compatibility"](t)||(!!n["CJK Radicals Supplement"](t)||(!!n["CJK Strokes"](t)||(!!n["CJK Symbols and Punctuation"](t)||(!!n["CJK Unified Ideographs Extension A"](t)||(!!n["CJK Unified Ideographs"](t)||(!!n["Enclosed CJK Letters and Months"](t)||(!!n["Halfwidth and Fullwidth Forms"](t)||(!!n.Hiragana(t)||(!!n["Ideographic Description Characters"](t)||(!!n["Kangxi Radicals"](t)||(!!n["Katakana Phonetic Extensions"](t)||(!!n.Katakana(t)||(!!n["Vertical Forms"](t)||(!!n["Yi Radicals"](t)||!!n["Yi Syllables"](t))))))))))))))))))))},i.charHasUprightVerticalOrientation=function(t){return 746===t||747===t||!(t<4352)&&(!!n["Bopomofo Extended"](t)||(!!n.Bopomofo(t)||(!(!n["CJK Compatibility Forms"](t)||t>=65097&&t<=65103)||(!!n["CJK Compatibility Ideographs"](t)||(!!n["CJK Compatibility"](t)||(!!n["CJK Radicals Supplement"](t)||(!!n["CJK Strokes"](t)||(!(!n["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||(!!n["CJK Unified Ideographs Extension A"](t)||(!!n["CJK Unified Ideographs"](t)||(!!n["Enclosed CJK Letters and Months"](t)||(!!n["Hangul Compatibility Jamo"](t)||(!!n["Hangul Jamo Extended-A"](t)||(!!n["Hangul Jamo Extended-B"](t)||(!!n["Hangul Jamo"](t)||(!!n["Hangul Syllables"](t)||(!!n.Hiragana(t)||(!!n["Ideographic Description Characters"](t)||(!!n.Kanbun(t)||(!!n["Kangxi Radicals"](t)||(!!n["Katakana Phonetic Extensions"](t)||(!(!n.Katakana(t)||12540===t)||(!(!n["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||(!(!n["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(!!n["Unified Canadian Aboriginal Syllabics"](t)||(!!n["Unified Canadian Aboriginal Syllabics Extended"](t)||(!!n["Vertical Forms"](t)||(!!n["Yijing Hexagram Symbols"](t)||(!!n["Yi Syllables"](t)||!!n["Yi Radicals"](t))))))))))))))))))))))))))))))},i.charHasNeutralVerticalOrientation=function(t){return!(!n["Latin-1 Supplement"](t)||167!==t&&169!==t&&174!==t&&177!==t&&188!==t&&189!==t&&190!==t&&215!==t&&247!==t)||(!(!n["General Punctuation"](t)||8214!==t&&8224!==t&&8225!==t&&8240!==t&&8241!==t&&8251!==t&&8252!==t&&8258!==t&&8263!==t&&8264!==t&&8265!==t&&8273!==t)||(!!n["Letterlike Symbols"](t)||(!!n["Number Forms"](t)||(!(!n["Miscellaneous Technical"](t)||!(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215))||(!(!n["Control Pictures"](t)||9251===t)||(!!n["Optical Character Recognition"](t)||(!!n["Enclosed Alphanumerics"](t)||(!!n["Geometric Shapes"](t)||(!(!n["Miscellaneous Symbols"](t)||t>=9754&&t<=9759)||(!(!n["Miscellaneous Symbols and Arrows"](t)||!(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243))||(!!n["CJK Symbols and Punctuation"](t)||(!!n.Katakana(t)||(!!n["Private Use Area"](t)||(!!n["CJK Compatibility Forms"](t)||(!!n["Small Form Variants"](t)||(!!n["Halfwidth and Fullwidth Forms"](t)||(8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)))))))))))))))))},i.charHasRotatedVerticalOrientation=function(t){return!(i.charHasUprightVerticalOrientation(t)||i.charHasNeutralVerticalOrientation(t))}},{"./is_char_in_unicode_block":211}],215:[function(t,e,i){"use strict";var n=t("../geo/lng_lat");e.exports=function(t,e,i){if(t=new n(t.lng,t.lat),e){var o=new n(t.lng-360,t.lat),r=new n(t.lng+360,t.lat),a=i.locationPoint(t).distSqr(e);i.locationPoint(o).distSqr(e)<a?t=o:i.locationPoint(r).distSqr(e)<a&&(t=r)}for(;Math.abs(t.lng-i.center.lng)>180;){var s=i.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=i.width&&s.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}},{"../geo/lng_lat":73}],216:[function(t,e,i){"use strict";function n(t,e){return Math.ceil(t/e)*e}function o(t){return h[t].BYTES_PER_ELEMENT}function r(t){return t.toLowerCase()}function a(t,e){for(var i=[],n=[],a="var i = this.length;\nthis.resize(this.length + 1);\n",s=0,l=t;s<l.length;s+=1){var u=l[s],c=o(u.type);i.indexOf(c)<0&&(i.push(c),a+="var o"+c.toFixed(0)+" = i * "+(e/c).toFixed(0)+";\n");for(var h=0;h<u.components;h++){var p="v"+n.length,f="o"+c.toFixed(0)+" + "+(u.offset/c+h).toFixed(0);a+="this."+r(u.type)+"["+f+"] = "+p+";\n",n.push(p)}}return a+="return i;",new Function(n.toString(),a)}function s(t,e){var i="this._pos"+o(t.type).toFixed(0)+" + "+(t.offset/o(t.type)+e).toFixed(0);return"this._structArray."+r(t.type)+"["+i+"]"}function l(t,e){return new Function("return "+s(t,e)+";")}function u(t,e){return new Function("x",s(t,e)+" = x;")}var c=t("assert");e.exports=function(t){var e=JSON.stringify(t);if(d[e])return d[e];var i=void 0===t.alignment?1:t.alignment,r=0,s=0,m=["Uint8"],g=t.members.map(function(t){c(t.name.length),c(t.type in h),m.indexOf(t.type)<0&&m.push(t.type);var e=o(t.type),a=r=n(r,Math.max(i,e)),l=t.components||1;return s=Math.max(s,e),r+=e*l,{name:t.name,type:t.type,components:l,offset:a}}),y=n(r,Math.max(s,i)),v=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(p);v.prototype.alignment=i,v.prototype.size=y;for(var _=0,x=g;_<x.length;_+=1)for(var b=x[_],w=0;w<b.components;w++){var T=b.name+(1===b.components?"":w);if(T in v.prototype)throw new Error(T+" is a reserved name and cannot be used as a member name.");Object.defineProperty(v.prototype,T,{get:l(b,w),set:u(b,w)})}var E=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(f);return E.prototype.members=g,E.prototype.StructType=v,E.prototype.bytesPerElement=y,E.prototype.emplaceBack=a(g,y),E.prototype._usedTypes=m,d[e]=E,E};var h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},p=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},f=function(t){this.isTransferred=!1,void 0!==t?(this.arrayBuffer=t.arrayBuffer,this.length=t.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):(this.capacity=-1,this.resize(0))};f.serialize=function(){return{members:this.prototype.members,alignment:this.prototype.StructType.prototype.alignment,bytesPerElement:this.prototype.bytesPerElement}},f.prototype.serialize=function(t){return c(!this.isTransferred),this._trim(),t&&(this.isTransferred=!0,t.push(this.arrayBuffer)),{length:this.length,arrayBuffer:this.arrayBuffer}},f.prototype.get=function(t){return c(!this.isTransferred),new this.StructType(this,t)},f.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},f.prototype.clear=function(){this.length=0},f.prototype.resize=function(t){if(c(!this.isTransferred),this.length=t,t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},f.prototype._refreshViews=function(){for(var t=this,e=0,i=t._usedTypes;e<i.length;e+=1){var n=i[e];t[r(n)]=new h[n](t.arrayBuffer)}},f.prototype.toArray=function(t,e){var i=this;c(!this.isTransferred);for(var n=[],o=t;o<e;o++){var r=i.get(o);n.push(r)}return n};var d={}},{assert:6}],217:[function(t,e,i){"use strict";var n=t("./browser"),o=function(t,e){this.frequency=t,this.throttledFunction=e,this.lastInvocation=0};o.prototype.invoke=function(){var t=this;if(!this.pendingInvocation){var e=0===this.lastInvocation?0:this.lastInvocation+this.frequency-n.now();e<=0?(this.lastInvocation=n.now(),this.throttledFunction()):this.pendingInvocation=setTimeout(function(){t.pendingInvocation=void 0,t.lastInvocation=n.now(),t.throttledFunction()},e)}},o.prototype.stop=function(){this.pendingInvocation&&(clearTimeout(this.pendingInvocation),this.pendingInvocation=void 0)},e.exports=o},{"./browser":198}],218:[function(t,e,i){"use strict";e.exports=function(t,e){return e.replace(/{([^{}]+)}/g,function(e,i){return i in t?t[i]:""})}},{}],219:[function(t,e,i){"use strict";var n=t("@mapbox/unitbezier"),o=t("../geo/coordinate");t("point-geometry");i.easeCubicInOut=function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)},i.bezier=function(t,e,i,o){var r=new n(t,e,i,o);return function(t){return r.solve(t)}},i.ease=i.bezier(.25,.1,.25,1),i.clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},i.wrap=function(t,e,i){var n=i-e,o=((t-e)%n+n)%n+e;return o===e?i:o},i.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var n=t.length,o=new Array(t.length),r=null;t.forEach(function(t,a){e(t,function(t,e){t&&(r=t),o[a]=e,0==--n&&i(r,o)})})},i.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},i.keysDifference=function(t,e){var i=[];for(var n in t)n in e||i.push(n);return i},i.extend=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var n=0,o=e;n<o.length;n+=1){var r=o[n];for(var a in r)t[a]=r[a]}return t},i.pick=function(t,e){for(var i={},n=0;n<e.length;n++){var o=e[n];o in t&&(i[o]=t[o])}return i};var r=1;i.uniqueId=function(){return r++},i.bindAll=function(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})},i.getCoordinatesCenter=function(t){for(var e=1/0,i=1/0,n=-1/0,r=-1/0,a=0;a<t.length;a++)e=Math.min(e,t[a].column),i=Math.min(i,t[a].row),n=Math.max(n,t[a].column),r=Math.max(r,t[a].row);var s=n-e,l=r-i,u=Math.max(s,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new o((e+n)/2,(i+r)/2,0).zoomTo(c)},i.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},i.mapObject=function(t,e,i){var n=this,o={};for(var r in t)o[r]=e.call(i||n,t[r],r,t);return o},i.filterObject=function(t,e,i){var n=this,o={};for(var r in t)e.call(i||n,t[r],r,t)&&(o[r]=t[r]);return o},i.deepEqual=function(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!i.deepEqual(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var o in t)if(!i.deepEqual(t[o],e[o]))return!1;return!0}return t===e},i.clone=function(t){return Array.isArray(t)?t.map(i.clone):"object"==typeof t&&t?i.mapObject(t,i.clone):t},i.arraysIntersect=function(t,e){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1};var a={};i.warnOnce=function(t){a[t]||("undefined"!=typeof console&&console.warn(t),a[t]=!0)},i.isCounterClockwise=function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)},i.calculateSignedArea=function(t){for(var e=0,i=0,n=t.length,o=n-1,r=void 0,a=void 0;i<n;o=i++)r=t[i],e+=((a=t[o]).x-r.x)*(r.y+a.y);return e},i.isClosedPolygon=function(t){if(t.length<4)return!1;var e=t[0],n=t[t.length-1];return!(Math.abs(e.x-n.x)>0||Math.abs(e.y-n.y)>0)&&Math.abs(i.calculateSignedArea(t))>.01},i.sphericalToCartesian=function(t){var e=t[0],i=t[1],n=t[2];return i+=90,i*=Math.PI/180,n*=Math.PI/180,[e*Math.cos(i)*Math.sin(n),e*Math.sin(i)*Math.sin(n),e*Math.cos(n)]},i.parseCacheControl=function(t){var e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,i={};if(t.replace(e,function(t,e,n,o){var r=n||o;return i[e]=!r||r.toLowerCase(),""}),i["max-age"]){var n=parseInt(i["max-age"],10);isNaN(n)?delete i["max-age"]:i["max-age"]=n}return i}},{"../geo/coordinate":72,"@mapbox/unitbezier":4,"point-geometry":37}],220:[function(t,e,i){"use strict";var n=function(t,e,i,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=n,this.properties=t.properties,null!=t.id&&(this.id=t.id)},o={geometry:{}};o.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},o.geometry.set=function(t){this._geometry=t},n.prototype.toJSON=function(){var t=this,e={geometry:this.geometry};for(var i in t)"_geometry"!==i&&"_vectorTileFeature"!==i&&(e[i]=t[i]);return e},Object.defineProperties(n.prototype,o),e.exports=n},{}],221:[function(t,e,i){"use strict";var n=t("./script_detection");e.exports=function(t){for(var i="",o=0;o<t.length;o++){var r=t.charCodeAt(o+1)||null,a=t.charCodeAt(o-1)||null;(!r||!n.charHasRotatedVerticalOrientation(r)||e.exports.lookup[t[o+1]])&&(!a||!n.charHasRotatedVerticalOrientation(a)||e.exports.lookup[t[o-1]])&&e.exports.lookup[t[o]]?i+=e.exports.lookup[t[o]]:i+=t[o]}return i},e.exports.lookup={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"}},{"./script_detection":214}],222:[function(t,e,i){"use strict";var n=t("assert"),o=t("./web_worker"),r=function(){this.active={}};r.prototype.acquire=function(e){var i=this;if(!this.workers){var r=t("../").workerCount;for(n("number"==typeof r&&r<1/0),this.workers=[];this.workers.length<r;)i.workers.push(new o)}return this.active[e]=!0,this.workers.slice()},r.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},e.exports=r},{"../":76,"./web_worker":199,assert:6}]},{},[76])(76)}),jQuery.live_search={settings_template:{url:"/fast-search",delay:100,param:"q",livesearch_result_only:!1,process_result_line:function(t){return"<li></li>"},after_submit:function(){}},settings:{},previousValue:{},timer:{},global:{first_run:!0},init:function(t){if(jQuery.live_search.global.first_run){var e="<style>";e+=".live-search-list {display: none; position: absolute; top: 33px; left: 0; margin: 0; right: 0; background-color: #FFFFFF; border: 1px solid #000000; text-align: left; z-index: 3000;}",e+=".live-search-list ul { margin: 5px 0; padding: 0; list-style: none; }",e+=".live-search-list li { padding: 2px 10px; cursor: pointer; }",e+=".live-search-list li.highlighted, #fsltl li:hover { background-color: #E1DFFF; }",e+="</css>",jQuery("html > head").append(e)}jQuery(jQuery.live_search.settings[t].input).wrap('<div style="position: relative;"></div>').parent().append('<p id="'+jQuery.live_search.settings[t].live_box.replace("#","")+'" style="display: none;"></p>'),jQuery(jQuery.live_search.settings[t].live_box).attr({class:"live-search-list"}),jQuery(jQuery.live_search.settings[t].input).keyup(function(e){jQuery(jQuery.live_search.settings[t].input).val()!=jQuery.live_search.previousValue[t]&&13!=e.keyCode&&(jQuery.live_search.resetTimer(jQuery.live_search.timer[t]),jQuery.live_search.timer[t]=setTimeout(function(){jQuery.live_search.process(t)},jQuery.live_search.settings[t].delay),jQuery.live_search.previousValue[t]=jQuery(jQuery.live_search.settings[t].input).val())}),jQuery(jQuery.live_search.settings[t].input).keydown(function(e){13==e.keyCode&&(e.preventDefault(),jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").length&&jQuery(jQuery.live_search.settings[t].input).val()?jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").trigger("click"):(jQuery.live_search.settings[t].livesearch_result_only&&(jQuery(jQuery.live_search.settings[t].input).removeAttr("data-q"),jQuery(jQuery.live_search.settings[t].input).val("")),jQuery(jQuery.live_search.settings[t].form).submit())),27==e.keyCode&&jQuery(jQuery.live_search.settings[t].live_box).css({display:"none"}),38==e.keyCode&&(e.preventDefault(),jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").length&&(before=jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").prev(),before.length&&(jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").removeClass("highlighted"),before.addClass("highlighted")))),40==e.keyCode&&(e.preventDefault(),jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").length?(next=jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").next(),next.length&&(jQuery(jQuery.live_search.settings[t].live_box+" li.highlighted").removeClass("highlighted"),next.addClass("highlighted"))):jQuery(jQuery.live_search.settings[t].live_box+" li").first().addClass("highlighted"))}),jQuery(jQuery.live_search.settings[t].submit).click(function(e){e.preventDefault(),jQuery(jQuery.live_search.settings[t].live_box).css({display:"none"})}),jQuery.live_search.global.first_run&&(jQuery(jQuery.live_search.settings[t].form).submit(function(e){e.preventDefault(),jQuery.live_search.settings[t].after_submit()}),jQuery.live_search.global.first_run=!1),jQuery(jQuery.live_search.settings[t].form).submit(function(e){e.preventDefault(),jQuery(jQuery.live_search.settings[t].live_box).css({display:"none"})})},show_results:function(t,e){if(result_html='<ul style="margin: 5px 0; padding: 0; list-style: none;">',e.length){for(jQuery(jQuery.live_search.settings[t].live_box).css({display:"block"}),i=0;i<e.length;i++)result_html+=jQuery.live_search.settings[t].process_result_line(e[i]);result_html+="</ul>",jQuery(jQuery.live_search.settings[t].live_box).html(result_html),jQuery(jQuery.live_search.settings[t].live_box+" li").click(function(){var e=jQuery(this).attr("data-q"),i=jQuery(this).attr("data-q-descr");i?(jQuery(jQuery.live_search.settings[t].input).val(i),jQuery(jQuery.live_search.settings[t].input).attr({"data-q":e})):jQuery(jQuery.live_search.settings[t].input).val(e),jQuery(jQuery.live_search.settings[t].form).submit()})}else jQuery(jQuery.live_search.settings[t].live_box).css({display:"none"})},resetTimer:function(t){t&&clearTimeout(t)},process:function(t){var e=jQuery.live_search.settings[t].url.split("?"),i=[jQuery.live_search.settings[t].param,"=",jQuery(jQuery.live_search.settings[t].input).val()].join(""),n=e[0],o=e[1],r=i;o&&(r=[o.replace("&amp;","&"),i].join("&")),jQuery.get([n,"?",r].join(""),function(e){jQuery.live_search.show_results(t,e.data)})}},jQuery.fn.live_search=function(t){return this.each(function(){var e=jQuery(this).attr("id");jQuery.live_search.settings[jQuery(this).attr("id")]=jQuery.extend(!0,{},jQuery.live_search.settings_template,t||{}),jQuery.live_search.init(e)}),this},storage={current_page:1,items_per_page:10,first_request:!0,browser_nav_action:!1,form_active:!1,random_seed:!1},$(document).on("click",'[data-toggle="lightbox"]',function(t){t.preventDefault(),$(this).ekkoLightbox()}),window.addEventListener("popstate",function(){storage.browser_nav_action=!0,get_url()}),$(document).ready(function(){if($("#frontpage-map").length&&init_front_page(),$("#search-result").length&&init_search_page(),$("#comment-form").length){if("undefined"!=typeof Storage){var t=localStorage.getItem("comment-name");t&&$("#name").val(t);var e=localStorage.getItem("comment-email");e&&$("#email").val(e)}$("#comment-form").submit(function(){"undefined"!=typeof Storage&&(localStorage.setItem("comment-name",$("#name").val()),localStorage.setItem("comment-email",$("#email").val()))})}});